<!DOCTYPE html>
<html>

<head>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Page Create</title>
  <link rel="stylesheet" type="text/css" href="editpage.css">

  <link href="//vjs.zencdn.net/8.3.0/video-js.min.css" rel="stylesheet">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

  
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Maths fractions -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {
      inlineMath: [["$","$"],["\\(","\\)"]]
      }
      });
      </script>
    
    <script type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full">
      </script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"
    integrity="sha512-Eezs+g9Lq4TCCq0wae01s9PuNWzHYoCMkE97e2qdkYthpI0pzC3UGB03lgEHn2XM85hDOUF6qgqqszs+iXU4UA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>
  <div class>
    <div>
      <div id="sidebar"> </div>
      <!--- main --->
      <div class="main">
        <div id="topbar-div"></div>
        <div class="createPageDiv">
          <div class="mainContainer">
            <div class="header-btns">
              <button type="button" onclick="openParentLink()" class="logoBtn">Parent logo</button>
              <button type="button" onclick="openGotoModal()" class="gotoBtn">Go to Section</button>
            </div>
            <div class="cards">
              <div class="card" id="contentCard">
              </div>

              <!-- edit -->

              <div id="submitBtnDiv" style="display: none;">
                <button type="button" id="submitBtn" class="btn btn-primary" onclick="submitModal()">Submit</button>
              </div>

            </div>
            <div class="btnContainer">
              <div class="menuToggles">
                <button type="button" class="btn rounded-circle ">
                  +
                </button>

              </div>

              <div class="actionBtns">
                <button type="button" class="btn btn-primary" id onclick="showModal('pageTitle')">Page Title &
                  Color</button>
                <button type="button" class="btn btn-primary" id="headingBtn" onclick="showModal('heading')">
                  Header Band</button>
                <button type="button" class="btn btn-primary" id onclick="showModal('headingDesc')">Description</button>
                <!-- <button type="button" class="btn btn-primary" onclick="newText()" id="textBtn"><ion-icon
                    name="add-circle-outline"></ion-icon> Text</button> -->
                <button type="button" class="btn btn-primary" onclick="showModal('image')">Image & Carousel
                </button>
                <button type="button" class="btn btn-primary" onclick="showModal('video')">Video
                </button>
                <button type="button" class="btn btn-primary" onclick="showModal('animation')">Gif Animation
                </button>

                <button type="button" class="btn btn-primary" onclick="showModal('button','button')">Button with
                  Link</button>
                <button type="button" class="btn btn-primary" onclick="showModal('button','popup')">Button with
                  Popup</button>
                <button type="button" class="btn btn-primary" onclick="showModal('imageLink')">Image with Link</button>
                <button type="button" class="btn btn-primary" onclick="showModal('hyperLink')">Image[s] with Caption &
                  Link</button>
                <button type="button" class="btn btn-primary" onclick="showModal('quiz')">Add Quiz Question</button>
                <button type="button" class="btn btn-primary" onclick="showModal('updates')">Accordion</button>
                <button type="button" class="btn btn-primary" onclick="showModal('linkPopup')">Link with Popup</button>
                <button type="button" class="btn btn-primary" onclick="showModal('heading','donor')">Donor Header</button>
                <button type="button" class="btn btn-primary" onclick="addSpace()">Empty Space</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!--Parent Link Modal -->
    <div class="modal fade" id="parentLinkModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="">Create Logo Link</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3 row align-items-center">
              <label for="mainPageLink" class="col-sm-2 col-form-label">Parent Page Link</label>
              <div class="col-sm-10 ">
                <input type="text" class="form-control" name="mainPageLink" id="mainPageLink"
                  onkeyup="urlValidate(this)" />
              </div>
            </div>
            <div class="mb-3 row align-items-center">
              <div class="col-12">
                <fieldset class="row mb-2 mt-2">
                  <legend class="col-form-label col-2 pt-0">Choose Logo</legend>
                  <div class="col-10">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="logoSelect" value="newimage" id="newimage"
                        onchange="logoSelectChange(this)" checked>
                      <label class="form-check-label" for="newimage">
                        New Logo
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="logoSelect" value="existingimage"
                        id="existingimage" onchange="logoSelectChange(this)">
                      <label class="form-check-label" for="existingimage">
                        Existing Logo
                      </label>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
            <div class="mb-3 row align-items-center" id="logoChooseDiv">
              <label for="headerLogo" class="col-2 col-form-label"></label>
              <div class="col-10">
                <label class="file-choose-label" for="headerLogo">Choose image</label>
                <input type="file" class="form-control" name="headerLogo" id="headerLogo" accept="image/png, image/jpeg"
                  onchange="logoChange(this)" hidden />

              </div>
            </div>
            <div class="mb-3 row align-items-center" id="logoListDiv" style="display: none;">
              <div class="col-2">

              </div>
              <div class="col-10" id="logoDiv"></div>
            </div>
            <div class="mb-3 row col-12" id="selectDivLogo" style="display: none;">
              <div class="col-2">Selected Logo</div>
              <div id="pageLogoDiv" class="col-10">
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="addParentLink()">Ok</button>
          </div>
        </div>
      </div>
    </div>

    <!--goto Modal -->
    <div class="modal fade" id="gotoModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="">Add Goto</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row mb-3">
                <label for="inputEmail3" class="col-sm-2 col-form-label">Goto Update </label>
                <div class="col-sm-10">
                  <select class="form-select" id="updatesList">
                    <option value="null">Choose...</option>
                    <option value="1">One</option>
                    <option value="2">Two</option>
                    <option value="3">Three</option>
                  </select>
                </div>
              </div>
              <div class="row mb-3">
                <label for="updateName" class="col-sm-2 col-form-label">Update display name</label>
                <div class="col-sm-10">
                  <input type="password" class="form-control" id="updateName">
                </div>
              </div>

              <div class="row mb-3">
                <label for="updateColour" class="col-sm-2 col-form-label">Update button colour</label>
                <div class="col-sm-10">
                  <input type="color" class="form-control form-control-color" value="#42d0ff" id="updateColour">
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="addGoto()">Ok</button>
          </div>
        </div>
      </div>
    </div>


    <!-- Popup Button Modal -->

    <div class="modal fade" id="popupBtnModalEdit">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
          </div>
        </div>
      </div>
    </div>

        <!-- Video Popup Modal -->
        <div class="modal fade" id="videoPopupModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="btn-close" onclick="closeVideoModal('videoPopupModal')" ></button>
              </div>
              <div class="modal-body">
              </div>
            </div>
          </div>
        </div>

    <!-- Modal -->
    <div class="modal fade" id="createModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="pageTitle">Create Page</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="pageContent">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" id="createBtn" onclick="addElement()">Ok</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="EditPageTitle">Edit Page</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="editPageContent">
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="updateElement()">Ok</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="submitModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Submit Page</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="row mb-3">
                <label for="inputEmail3" class="col-sm-2 col-form-label">Category</label>
                <div class="col-sm-10">
                  <select id="inputState" class="form-select">
                    <option value="null" selected>Choose...</option>
                    <option value="1">Euroka</option>
                    <option value="2">AidIndia</option>
                    <option value="3">Ahaguru</option>
                  </select>
                </div>
              </div>


              <!--  -->
              <div class="mb-3 row align-items-center">
                <label for="url" class="col-sm-2 col-form-label">URL</label>
                <div class="col-sm-10">
                  <p class="mb-1 urlTextClass">https://eureka.com/<span id="category"></span>/<span
                      id="urlName"></span>.html</p>
                  <input type="text" class="form-control" id="urlInput">
                </div>
              </div>
              <fieldset class="row mb-3">
                <legend class="col-form-label col-sm-2 pt-0">Status</legend>
                <div class="col-sm-10" id="acionId">
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1" value="Draft">
                    <label class="form-check-label" for="gridRadios1">
                      Draft
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="Publish"
                      checked>
                    <label class="form-check-label" for="gridRadios2">
                      Publish
                    </label>
                  </div>
                </div>
              </fieldset>
              <div class="row mb-3 align-items-center" id="goToSelectDiv" style="display:none">
                <label for="goToSelect" class="col-sm-2 col-form-label">Go to update</label>
                <div class="col-sm-10">
                  <select id="goToSelect" class="form-select" onchange="goToFn()">
                  </select>
                </div>
              </div>
              <div class="mb-3 row align-items-center" id="updateNameDiv" style="display:none">
                <label for="updateName" class="col-sm-2 col-form-label">Update display name</label>
                <div class="col-sm-10 ">
                  <input type="text" class="form-control" id="updateName" />
                </div>
              </div>
              <div class="mb-3 row align-items-center" id="updateColorDiv" style="display:none">
                <label for="updateBgColor" class="col-sm-2 col-form-label">Update button color</label>
                <div class="col-sm-10 ">
                  <input type="color" class="form-control form-control-color" id="updateBgColor" value="#53bcf5" />
                </div>
              </div>

              <div class="mb-3 row align-items-center">
                <label for="mainPageLink" class="col-sm-2 col-form-label">Parent Link</label>
                <div class="col-sm-10 ">
                  <input type="text" class="form-control" name="mainPageLink" id="mainPageLink"
                    onkeyup="urlValidate(this)" />
                </div>
              </div>
              <div class="mb-3 row align-items-center">
                <div class="col-12">
                  <fieldset class="row mb-2 mt-2">
                    <legend class="col-form-label col-4 pt-0">Choose Logo</legend>
                    <div class="col-8">
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="logoSelect" value="newimage" id="newimage"
                          onchange="logoSelectChange(this)" checked>
                        <label class="form-check-label" for="newimage">
                          New Image
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="logoSelect" value="existingimage"
                          id="existingimage" onchange="logoSelectChange(this)">
                        <label class="form-check-label" for="existingimage">
                          Existing Image
                        </label>
                      </div>
                    </div>
                  </fieldset>
                </div>

              </div>
              <div class="mb-3 row align-items-center" id="logoChooseDiv">
                <label for="headerLogo" class="col-2 col-form-label"></label>
                <div class="col-10">
                  <input type="file" class="form-control" name="headerLogo" id="headerLogo"
                    accept="image/png, image/jpeg" onchange="logoChange(this)" />
                </div>
              </div>
              <div class="mb-3 row align-items-center" id="logoListDiv" style="display: none;">
                <div class="col-2">

                </div>
                <div class="col-10" id="logoDiv"></div>
              </div>
              <div class="mb-3 row col-12" id="selectDivLogo" style="display: none;">
                <div class="col-2">Selected Logo</div>
                <div id="pageLogoDiv" class="col-10">
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" onclick="submitFn()">Submit</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Link Popup Modal -->
    <div class="modal fade" id="linkPopupModal" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-primary" onclick="linkPopupUpdate()">Update</button>
          </div>
        </div>
      </div>
    </div>

    <!-- <script src="https://code.jquery.com/jquery-1.10.2.js"></script> -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/ckeditor/4.15.1/ckeditor.js"></script>

    <script>
      CKEDITOR.replace('editor');
    </script>

    <script>

      function changeToRichtext(id_list) {

        var basic = [
          {
            name: 'standard',
            items: ['Bold', 'Italic', 'NumberedList', 'BulletedList']
          },

          { name: 'paragraph', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock'] },

          { name: 'styles', items: ['Font', 'FontSize', 'TextColor'] },
          { name: 'insert', items: ['Table','Mathjax', 'Sourcedialog','Link','Unlink'] },
        ];
        id_list.forEach(id => {
          // CKEDITOR.plugins.addExternal('custom-list', '/assets/js/plugin/custom-list/', 'plugin.js');
          CKEDITOR.plugins.addExternal('font', '/assets/js/plugin/font/', 'plugin.js');
          CKEDITOR.plugins.addExternal('colorbutton', '/assets/js/plugin/colorbutton/', 'plugin.js');
          CKEDITOR.plugins.addExternal('floatpanel', '/assets/js/plugin/floatpanel/', 'plugin.js');
          CKEDITOR.plugins.addExternal('panelbutton', '/assets/js/plugin/panelbutton/', 'plugin.js');
          CKEDITOR.plugins.addExternal('colordialog', '/assets/js/plugin/colordialog/', 'plugin.js');
          CKEDITOR.plugins.addExternal('liststyle', '/assets/js/plugin/liststyle/', 'plugin.js');
          CKEDITOR.plugins.addExternal('justify', '/assets/js/plugin/justify/', 'plugin.js');
          CKEDITOR.config.extraPlugins = 'font,colorbutton,panelbutton,floatpanel,colordialog,liststyle,justify,mathjax,sourcedialog,link';
          CKEDITOR.config.mathJaxLib = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_HTML-full';
          CKEDITOR.config.colorButton_enableMore = true;

          CKEDITOR.config.enterMode = CKEDITOR.ENTER_BR;
          CKEDITOR.replace(id, {
            toolbar: basic,
            height: "15vh",
            allowedContent: true
          });

        });
      }


      var sort = "../../assets/img/sort.png"
      var pen = "../../assets/img/pen.png"
      var close = "../../assets/img/close.png"

      var headingDivId = 0;
      var dragImageIcon = "../../assets/img/sort.png"
      var editImageIcon = "../../assets/img/pen.png"
      var deleteImageIcon = "../../assets/img/close.png"

      changeToRichtext([`updateName`])


      //Parent link change
      let parentLinkImageFile = '';

      closeVideoModal = (modalElem)=>{
        $(`#${modalElem}`).modal("hide");
        $(`#${modalElem} iframe`).attr("src","");
      }

      const openParentLink = () => {
        $('#parentLinkModal').modal('show');
        $(".logo-error").remove();
        $("#selectDivLogo").css("display", "none");
        pageLogoImage = "";

        let existingLogos = ['../../assets/img/img1.jpg', '../../assets/img/img2.jpg', '../../assets/img/img3.jpg', '../../assets/img/img4.jpg'];
        let logoElem = '';

        existingLogos.forEach((logo, i) => {
          logoElem += ` <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="imageList" value="newimage${i}"id="newimage${i}" onchange="logoChangeFromList(${i})">
          <label class="form-check-label" for="newimage">
            <img src="${logo}"/>
          </label>
        </div>`
        })

        let imageRadioElem = `<fieldset class="row mb-2 mt-2">
                              <div class="radio-seletion">
                                ${logoElem}
                                <div>
                          </fieldset>`

        $("#logoDiv").html(imageRadioElem)

        logoChangeFromList = (index) => {
          $("#pageLogoDiv").html(`<img src="${existingLogos[index]}"/>`);
          $("#selectDivLogo").css("display", "flex")
          parentLinkImageFile = existingLogos[index];
        }
      }

      const logoChange = (elem) => {
        $("#pageLogoDiv").html(`<img src="${URL.createObjectURL(elem.files[0])}"/>`)
        $("#selectDivLogo").css("display", "flex")
        parentLinkImageFile = elem.files[0];
      }

      const urlValidate = (elem) => {
        let urlValue = $(elem).val();
        var regexp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
        let urlValidation = regexp.test(urlValue)
        if (urlValidation) {
          $(".url-error").remove()
        } else {
          if ($(".url-error").length === 0) {
            $("#mainPageLink").after(`<p class="error url-error">Please enter the valid URL.</p>`);
          }
        }
      }


      const addParentLink = () => {
        $(".logo-error").remove();
        let parentLinkValue = $("#mainPageLink").val();
        if (parentLinkValue === "") {
          $("#mainPageLink").after('<p class="error logo-error">Enter the parent link.</p>')
        }

        if (parentLinkImageFile === "") {
          $("#headerLogo").after('<p class="error logo-error">Upload the parent link logo.</p>')
          $("#logoDiv").after('<p class="error logo-error">Upload the parent link logo.</p>')
        }

        if (parentLinkValue !== "" && parentLinkImageFile !== "") {
          $('#parentLinkModal').modal('hide');
        }
      }

      //Goto modal
      let updateDataObj = {};
      const openGotoModal = () => {
        $('#gotoModal').modal('show');
        $(".goto-error").remove();
      }

      const addGoto = () => {
        $(".goto-error").remove();
        let updateSelect = $("#updatesList").val();
        let updateName = CKEDITOR.instances['updateName'].getData();
        let updateColour = $("#updateColour").val();

        if (updateSelect === "null") {
          $("#updatesList").after('<p class="error goto-error mt-0">Select the update.</p')
        }

        if (updateName === "") {
          $("#cke_updateName").after('<p class="error goto-error mt-0">Enter the update name.</p')
        }

        if (updateSelect !== "null" && updateName !== "") {
          $('#gotoModal').modal('hide');
        }

        updateDataObj['updateSelect'] = updateSelect;
        updateDataObj['updateName'] = updateName;
        updateDataObj['updateColour'] = updateColour;

      }


      // Submit Modal Text

      let inputLinkText = $("#urlName")

      $('#urlInput').keyup(function () {
        let text = $.trim($('#urlInput').val())
        let trimText = text.split(" ").join("-")
        inputLinkText.text(trimText)
      });

      let inputCatName = $("#category")

      $("#inputState").change(function () {
        inputCatName.text($('#inputState option').filter(':selected').text())
      });


      var parentDiv = document.getElementById('contentCard')
      let submitBtnDiv = document.getElementById("submitBtnDiv")
      if (parentDiv.innerText == "") {
        parentDiv.innerHTML = '<h3 id="emptyPage" style="opacity:0.8">Add contents to create page..!</h3>'
      }

      let menuToggles = document.querySelector(".menuToggles");
      menuToggles.onclick = function () {
        menuToggles.classList.toggle("active");
      };

      var inputId = 0
      var headingDescId = 0
      var subHeadingId = 0
      var quizId = 0
      var imageId = 0
      var animationId = 0;
      var spaceId = 0;
      var buttonId = 0;
      var imgLinkId = 0;
      var hyperLinkId = 0;
      var stampCardId = 0;
      var updatesId = 0;
      let linkPopupId=0;


      var delImagesEdit;

      let pageBgImage="";

      var showImages;
      var showEditImages;
      //var showAnimations;
      // var showVideos;
      var showEditVideos;
      var files;
      var addInputs;
      var removeInputs;
      var imgOnchangeFn;
      var imgEditOnchangeFn;
      var addEditInputs;
      var updatesBtnsFn;
      var removeEditInputs;
      var delEditImages;
      var delEditVideos;

      var descriptionId;
      const delVideos = (index) => {
        files.pop()
      }
      const delImages = (index) => {
        files.splice(index, 1)
        showImages()
      }

      var delAnimations;
      var delEditAnimations;

      let data = []
      let dataCount = 0;

      let headingArray = {}

      var imageContainerId = 0;
      let imagesContainerArrar = {};

      var videoContainerId = 0;
      let videoContainerArrary = {};

      let emptySpaceCount = 0

      let quizContainerArray = {}
      let animationContainerArray = {}
      let btnContainerArray = {}
      let imgLinkContainerArray = {}
      let descriptionArray = {}
      let buttonsArray = {}
      let emptyPageArray = {}
      let quizArray = {}
      let titleArray = {}
      let hyperLinkArray = {}
      let stampCardLinkArray = {}
      let updatesArray = {}

      let popupImage;
      let popupPdf;
      let pageLogoImage;

      let popupImageTwo;
      let popupPdfTwo;
      let pageLogoImageTwo;

      let thumbnailImage = '';
      
      let linkPopupImage='';
      let linkPopupText="";
      let popupLinkElem;
      let linkRange;
      let selectedElem;
      let linkChildElem=[];
      let textureImageIndex=0;

      //Temp Array

      let tempArray = {}

      var tempId = "";
      var videoTempId = "";

      let cardbgColor = ""

      // pagetitle color needs to be changed
      let pageBgColor = "#fcfcfc";


      const dragArea = document.querySelector('.card')

      new Sortable(dragArea, {
        filter: '.titleDiv',
        handle: ".dragImg",
        Animation: 350,
      })

      function matchYoutubeUrl(url) {
        var p = /^(?:https?:\/\/)?(?:m\.|www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/;
        if(url.match(p)){
            return url.match(p)[1];
        }
        return false;
    }

    $(document).ready(function() {
      $("body").tooltip({ selector: '[data-bs-toggle=tooltip]' });
  });

      // Page onload function

      let fetchData = fetch('./newData.json')
        .then((response) => response.json())
        .then((json) => { return json.data });

      let fetchGotoData = fetch('./Data.json')
        .then((response) => response.json())
        .then((json) => { return json.goto });

      const fetchElem = (pageData, updatesElemId) => {
        var parentContentCards
        if (updatesElemId) {
          parentContentCards = document.getElementById(`${updatesElemId}`)
        } else {
          parentContentCards = document.getElementById("contentCard")
        }

        var numb = updatesElemId?.match(/\d/g);
        numb = numb?.join("");

        var idCount = numb

        pageData.map((data, i) => {

          if (data.type === "1") {
            parentContentCards.style.backgroundColor = data.bgColor
            cardbgColor = data.bgColor
            let textureType= data['textureType'] ===  undefined ? 'color':data['textureType'];
            let textureColor = "";

            if(textureType === "existing" || textureType === "new" ){
              pageBgImage = data['bgImage'] === undefined || "" ? "":data['bgImage']
            }

            if(textureType === "existing"){
              textureImageIndex = data['imageIndex']
            }

            if(textureType === "color"){
              textureColor = data['textureColor'] === undefined ? "#ffffff":data['textureColor'];
            }

            var dropImg = document.createElement("img")
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var emptyDiv = document.createElement("div")
            emptyDiv.style = "width:20px"

            var clickTag = document.createElement("a")
            clickTag.href = "#"

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'title')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)

            var ckTextValue = data.title

            let titleDiv = document.createElement("div")
            titleDiv.className = "titleDiv"
            titleDiv.id = "title"
            let heading = document.createElement("p")
            heading.id = "pageHeadingId"
            heading.innerHTML = ckTextValue

            titleDiv.appendChild(emptyDiv)
            titleDiv.appendChild(heading)
            titleDiv.appendChild(clickTag)
            titleDiv.appendChild(deleteTag)

            clickTag.setAttribute("onclick", `editModal("editTitle","pageHeadingId")`)

            document.getElementById("emptyPage")?.remove();

            if(textureType === "existing"){
              $(".createPageDiv").css('background-image',`url(${pageBgImage})`);
            titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
            tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
          }else if(textureType === "color"){
            $(".createPageDiv").css('background-image','');
            $(".createPageDiv").css('background-color',`${textureColor}`);
            titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
            tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
          }else if(textureType === "new"){
            if(pageBgImage !== ""){
              $(".createPageDiv").css('background-image',`url(${URL.createObjectURL(pageBgImage)})`);
            }
            titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage }
            tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage }
          }
            parentContentCards.insertBefore(titleDiv, parentContentCards.firstChild);
            //
            submitBtnDiv.style.display = "block"

            console.log(tempArray['title'],"title")

          }
          else if (data.type === "2") {
            let donorCheck = data.donor;
            var div = document.createElement('div')
            div.className = `heading dragDiv ${donorCheck?"donor-class":""}`
            // div.draggable = true
            div.id = "headingId" + headingDivId
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var clickTag = document.createElement("a")
            clickTag.href = "#"
            clickTag.setAttribute("onclick", `editModal("editHeading",this.previousElementSibling.id,this.parentElement.id)`)

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'heading')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)
            var ckTextValue = data.heading

            let bgColor = data.bgColor
            

            let paraDiv = document.createElement("div")
            paraDiv.className = "headingDiv"

            let paraTag = document.createElement("p")
            paraTag.className = "mb-0"
            paraTag.id = "heading" + headingDivId
            paraTag.innerHTML = ckTextValue

            paraDiv.appendChild(paraTag)

            div.appendChild(dropImg)
            div.appendChild(paraDiv)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)

            // 
            document.getElementById("emptyPage")?.remove();

            if(donorCheck){
              $("#contentCard #title").after(div)
            }else{
              parentContentCards.appendChild(div)
            }
           

            if (updatesElemId) {
              headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor, updates: `updates${idCount}` }
              tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor, updates: `updates${idCount}` }
            } else {
              if(donorCheck){
                headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,donor:true }
                tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,donor:true }
              }else{
                headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
                tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
              }

            }

            let headingDiv = document.getElementById(`headingId${headingDivId}`)
            headingDiv.style.backgroundColor = `${bgColor}`
            //
            submitBtnDiv.style.display = "block"
            headingDivId += 1

          }
          else if (data.type === "3") {
            var div = document.createElement('div')
            div.className = "headingDesc dragDiv"
            div.id = `descriptionDiv${headingDescId}`
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var clickTag = document.createElement("a")
            clickTag.href = "#"
            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'description')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)

            let elemId = "descriptionDiv" + headingDescId

            clickTag.setAttribute("onclick", `editModal("editDescription",this.previousElementSibling.id,this.parentElement.id)`)

            var ckTextValue = data.text
            var elem = document.createElement("p")
            elem.className="description"
            elem.id = "Description" + headingDescId
            elem.innerHTML = ckTextValue
            div.appendChild(dropImg)
            div.appendChild(elem)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)

            let elemBgColor = data.bgColor

            document.getElementById("emptyPage")?.remove()
            parentContentCards.appendChild(div)
            var sol_math = document.getElementById(`#Description${headingDescId}`);
            MathJax.Hub.Queue(["Typeset", MathJax.Hub, sol_math]);
            if (updatesElemId) {
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor, updates: `updates${idCount}` }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor, updates: `updates${idCount}` }
            } else {
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor }
            }

            let parentElem = document.getElementById(elemId)
            parentElem.style.backgroundColor = elemBgColor
            submitBtnDiv.style.display = "block"
            headingDescId = headingDescId + 1
          }
          else if (data.type === "4") {
            let imagesView = data.imagesView == undefined ? "normal" : data.imagesView;
            let arrowBgColor = data.arrowBgColor == undefined ? "#828282" : data.arrowBgColor;

            let ParentId;
            var div = document.createElement('div')
            div.className = "imageContainer dragDiv"
            //
            div.id = `imgContainerDiv${imageContainerId}`
            div.draggable = true
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var clickTag = document.createElement("a")
            clickTag.href = "#"
            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var imgArry = data.images

            if (updatesElemId) {
              imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = { images: imgArry, updates: `updates${idCount}` }
              tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: imgArry, "imagesView": imagesView, arrowBgColor: arrowBgColor, updates: `updates${idCount}` }
            } else {
              imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = imgArry
              tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: imgArry, "imagesView": imagesView, arrowBgColor: arrowBgColor }
            }

            var imgContainer = document.createElement("div")
            imgContainer.className = "imagesDiv"
            imgContainer.id = "imgContainer" + imageContainerId
            imgContainer.draggable = true

            var carouselContainer = document.createElement("div")
            carouselContainer.className = "container main-margin-top"

            clickTag.setAttribute("onclick", `editModal("editImages",this.previousElementSibling.id,this.parentElement.id)`)

            let images = '';

            imgArry.forEach((e, i) => {
              images += `
                        <img src=${e} alt="img">
                    </div>`
            })

            let imageSlideCount = '';
            let carouselImage = '';

            imgArry.forEach((e, i) => {
              imageSlideCount += `<button type="button" data-bs-target="#carouselwithIndicators${imageContainerId}" data-bs-slide-to="${i}" style="background-color:${arrowBgColor}" aria-current="true" class="${i == 0 ? "active" : ""}" aria-label="Slide ${i}">

                                </button>`
            })

            let carouselUrl = '';

            imgArry.forEach((e, i) => {
              if (typeof e === "string") {
                carouselUrl = e
              } else {
                carouselUrl = URL.createObjectURL(e)
              }
              carouselImage += `<div class="${i == 0 ? "carousel-item active" : "carousel-item"}">
              <img src=${carouselUrl} class="d-block w-100" alt="${e.name}" >
            </div>`
            })

            let carouselView = `
            <div id="carouselwithIndicators${imageContainerId}" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">
              <div class="carousel-indicators">
                ${imageSlideCount}
              </div>
              <div class=" carousel-inner">
                ${carouselImage}
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#carouselwithIndicators${imageContainerId}" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
      
              <button class="carousel-control-next" type="button" data-bs-target="#carouselwithIndicators${imageContainerId}" data-bs-slide="next">
                <span class="carousel-control-next-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
          </div>`

            imgContainer.innerHTML = images;
            carouselContainer.innerHTML = carouselView;

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'image')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close


            deleteTag.append(deleteImg)
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()

            div.appendChild(dropImg)
            if (imagesView === "carousel") {
              div.appendChild(carouselContainer)
            }
            else {
              div.appendChild(imgContainer)
            }
            div.appendChild(clickTag)
            div.appendChild(deleteTag)
            parentContentCards.appendChild(div)
            submitBtnDiv.style.display = "block"
            imageContainerId += 1
          }
          else if (data.type === "5") {

            var div = document.createElement('div')
            div.className = "videoContainer dragDiv"
            div.id = "DivvideoContainer" + videoContainerId
            div.draggable = true
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort


            var clickTag = document.createElement("a")
            clickTag.href = "#"
            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var videoArry = data.video
            var videoSrc = data.video
            let videoType =  data.videoType ===  undefined ? 'upload':data.videoType;
            let link="";

            if(videoType === "link"){
              link=data.link;
              thumbnailImage = data.image;
            }

            if (updatesElemId) {
              if(videoType === "upload"){
                videoContainerArrary[`DivvideoContainer${videoContainerId}`] = { video: videoArry, updates: `updates${idCount}` }
                tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: videoArry, videoType, updates: `updates${idCount}` }
              }else{
                tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", videoType, link, image:thumbnailImage, updates: `updates${idCount}` }
              }

            } else {
              if(videoType === "upload"){
                videoContainerArrary[`DivvideoContainer${videoContainerId}`] = videoArry
                tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5",videoType, video: videoArry }
              }else{
                tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5",link, videoType,image:thumbnailImage}
              }

            }

            let videoPopupElem="";

            if(videoType === "link"){
                  videoPopupElem=  `<div class="video-thumbnail" onclick="videoPopupOpen(this)" id="video_DivvideoContainer${videoContainerId}">
                                          <img src="${thumbnailImage[0]}" alt="" />
                                          <span><i class="fa-regular fa-circle-play"></i></span>
                                      </div>`
            }

            var videoContainer = document.createElement("div")
            videoContainer.className = "videosDiv"
            videoContainer.id = "videoContainer" + videoContainerId
            videoContainer.draggable = true
            clickTag.setAttribute("onclick", "editModal('editVideo',this.previousElementSibling.id,this.parentElement.id)")

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'video')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)
            var existingElement = document.getElementById(videoTempId)

            let videos = '';

            videos = `<video class="" controls  preload="auto" alt="video">
                    <source src=${videoSrc} />
                </video>`
            if(videoType === "link"){
              videoContainer.innerHTML= videoPopupElem
            }else{
              videoContainer.innerHTML = videos
            }
              
            let inputElem = document.querySelector(".videoModalContainer")

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            div.appendChild(dropImg)
            div.appendChild(videoContainer)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)
            parentContentCards.appendChild(div)
            //
            submitBtnDiv.style.display = "block"
            videoContainerId += 1

            videoPopupOpen= (elem)=>{
              let videoData = elem.id.split("_")[1];
              console.log(videoData,"data")
              let videoLinkData = tempArray[`${videoData}`].link
              console.log(videoLinkData,"data")
              let videoelem = `<iframe height="345" src="${videoLinkData}?rel=0&amp;autoplay=1" allow="autoplay">
                              </iframe>`
              $("#videoPopupModal .modal-body").html(videoelem)
              $("#videoPopupModal").modal('show')
            }
          }
          /* else if(data.type==="6"){
             var div = document.createElement('div')
             div.className = "animationParentContainer dragDiv"
             div.id = "animationsDiv" + animationId
             div.draggable = true
             var dropAnimation = document.createElement("img")
             dropAnimation.height = 20
             dropAnimation.width = 20
             dropAnimation.src = sort
   
             var animationArry = data.animations;  
 
 
             var animationContainer = document.createElement("div")
             animationContainer.className = "animationsDiv"
             animationContainer.id = `animations${animationId}`
             animationContainer.draggable = true
 
   
             let animations = '';
             animationArry.forEach((e, i) => {
               animations += `
                       <img src=${URL.createObjectURL(e)} alt="img">
                   </div>`
             })
             animationContainer.innerHTML = animations

              if(updatesElemId){ 
                 
                 animationContainerArray[`animationsDiv${animationId}`] = {animations:animationArry,updates:`updates${idCount}`}
     
                 tempArray[`animationsDiv${animationId}`] = { type: "6", animations: animationArry,updates:`updates${idCount}` }  
             }else{
              animationContainerArray[`animationsDiv${animationId}`] = animationArry
 
             tempArray[`animationsDiv${animationId}`] = { type: "6", animations: animationArry }
             }
 

   
   
             var clickTag = document.createElement("a")
             clickTag.href = "#"
   
             clickTag.setAttribute("onclick", "editModal('editAnimation',this.previousElementSibling.id,this.parentElement.id)")
   
             var editImg = document.createElement('img')
             editImg.width = 20
             editImg.height = 20
             editImg.src = pen
   
             clickTag.appendChild(editImg)
   
   
             var deleteTag = document.createElement("a")
             deleteTag.href = "#"
             deleteTag.setAttribute("onclick", "deleteItem(this,'animation')")
   
             var deleteImg = document.createElement("img")
             deleteImg.width = 20
             deleteImg.height = 20
             deleteImg.src = close
   
             deleteTag.append(deleteImg)
   
   
             div.appendChild(dropAnimation)
             div.appendChild(animationContainer)
             div.appendChild(clickTag)
             div.appendChild(deleteTag)
 
             $('#createModal').modal('hide');
             document.getElementById("emptyPage")?.remove()
             parentContentCards.appendChild(div)
             submitBtnDiv.style.display = "block"
             animationId += 1
           }
           */
          else if (data.type === "7") {
            var quizDiv = document.createElement('div')
            quizDiv.className = "quizContainer dragDiv"
            quizDiv.id = "quizDiv" + quizId
            quizDiv.draggable = true
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var formElem = document.getElementsByClassName("formClass");
            var quiz = data.quiz
            var quizData = quiz;

            quizContainerArray[`quiz${quizId}`] = quiz;

            const { question, answer, ...rest } = quiz;

            var optionsList = []
            for (var key in rest) {
              var value = rest[key];
              if (value !== "") {
                optionsList.push(value)
              }
            }
            const { option0, option1, option2, option3 } = quiz;

            var options = ""
            for (let i = 0; i < optionsList.length; i++) {
              options += `<label class="options">${optionsList[i]}
                  <input type="radio" name="radio" value=${optionsList[i]}/>
                  <span class="checkmark"></span>
              </label>`
            }

            const div = document.createElement("div")


            const quizHtml = `<div class="container my-1">
                    <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                        <div class="py-2 h5"><b>Q. ${question}</b></div>
                        <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                           ${options}
                        </div>
                    </div>
                </div>`


            const submitBtn = `<button type="button" class="btn btn-primary" onclick="answerSubmit()">Submit</button>`


            div.style = "text-align:start"
            div.style = "width:90%"
            div.id = `quiz${quizId}`
            div.className = "quizClass"
            div.innerHTML = quizHtml

            var clickTag = document.createElement("a")
            clickTag.href = "#"

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)


            clickTag.setAttribute("onclick", "editModal('editQuiz',this.previousElementSibling.id,this.parentElement.id)")

            // quizContainerArray[`${quizArray}`]=quiz[0]
            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'quiz')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)

            quizDiv.appendChild(dropImg)
            quizDiv.appendChild(div)
            quizDiv.appendChild(clickTag)
            quizDiv.appendChild(deleteTag)

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            parentContentCards.appendChild(quizDiv)
            if (updatesElemId) {
              quizContainerArray[`quizDiv${quizId}`] = { quiz: quiz, updates: `updates${idCount}` }
              tempArray[`quizDiv${quizId}`] = { type: "7", quiz: quiz, updates: `updates${idCount}` }
            } else {
              quizContainerArray[`quizDiv${quizId}`] = { quiz: quiz }
              tempArray[`quizDiv${quizId}`] = { type: "7", quiz: quiz }
            }

            submitBtnDiv.style.display = "block"
            quizId += 1;

          }
          else if (data.type === "8") {
            let btnCount = data['btnCount'] === undefined ? "one" : data['btnCount'];

            let buttonOneData ="";
            let btnName = "";
            let btnLink ="";
            let btnType = "";
            let btnLocation ="";
            let btnPosition = "";
            let popupType = "";
            let btnColor = "";
            let links = "";
            let popupText="";
            let popupTextColor="";
         
            if(btnCount !=="menu"){
              buttonOneData = data['buttons'] === undefined ? data : data['buttons'][0];
              btnName = buttonOneData.name;
              btnLink = buttonOneData.link && buttonOneData.link;
              btnType = buttonOneData.btnType === undefined ? "link" : buttonOneData.btnType;
              btnLocation = buttonOneData.btnLocation === undefined ? "header" : buttonOneData.btnLocation;
              btnPosition = buttonOneData.btnPosition === undefined ? "center" : buttonOneData.btnPosition;
              popupType = buttonOneData.popupType === undefined ? "image" : buttonOneData.popupType;
              btnColor = buttonOneData.bgColor;
              links = buttonOneData.links;
              popupText = buttonOneData['text']===undefined ? "": buttonOneData['text'];
              popupTextColor = buttonOneData['textBgColor']===undefined ? "#b3b3b3": buttonOneData['textBgColor'];

              if (popupType == "image") {
                popupImage = buttonOneData['image'];
              } else if (popupType === "pdf") {
                popupPdf = buttonOneData['pdf'];
              }
            }

             //Button two
          let buttonTwoData = "";
          let btnTwoName = "";
          let btnColorTwo = '#b3b3b3';
          let btnTwoLink = "";
          let btnTypeTwo = "";
          let btnPositionTwo = "";
          let btnLocationTwo = '';
          let popupTypeTwo = '';
          let linksTwo;
          let popupTextTwo='';
          let popupTextColorTwo='#b3b3b3';
             
          if (btnCount === "two") {
            buttonTwoData = data['buttons'][1];
            btnTwoName = buttonTwoData['name'] === undefined ? '' : buttonTwoData['name'];
            btnColorTwo = buttonTwoData['bgColor'] === undefined ? '#b3b3b3' : buttonTwoData['bgColor'];
            btnTwoLink = buttonTwoData['link'] === undefined ? '' : buttonTwoData['link'];
            btnTypeTwo = buttonTwoData['btnType'] === undefined ? 'link' : buttonTwoData['btnType'];
            btnPositionTwo = buttonTwoData['btnPosition'] === undefined ? 'center' : buttonTwoData['btnPosition'];

            if (btnTypeTwo === "popup") {
              btnLocationTwo = buttonTwoData['btnLocation'] === undefined ? 'body' : buttonTwoData['btnLocation'];
              popupTypeTwo = buttonTwoData['popupType'] === undefined ? 'link' : buttonTwoData['popupType'];
              if (popupTypeTwo === 'link') {
                linksTwo = buttonTwoData['links'];
              } else if (popupTypeTwo === 'image') {
                popupImageTwo = buttonTwoData['image'];
              }else if (popupTypeTwo === 'pdf') {
                popupPdfTwo = buttonTwoData['pdf'];
              }else if(popupTypeTwo === "text"){
                popupTextTwo= buttonTwoData['text'] === undefined ? "" : buttonTwoData['text'];
                popupTextColorTwo = buttonTwoData['textBgColor'] === undefined ? '#b3b3b3':buttonTwoData['textBgColor'];
              }
            }
          }

          let menuButtonData;
          let menuBtnData=[];
          let menuBgColor = "";
          let menuPosition = "";
          let linkFontColor = "";
          let menusList = [];
          if(btnCount === "menu"){
            menuBtnData = data['buttons'] === undefined ? data : data['buttons'];
            menuButtonData= data['buttons'] === undefined ? data : data['buttons'];;
            menuPosition = menuButtonData[0]['position'];
            menuBgColor = data['bgColor'];
            linkFontColor = data['fontColor'];
            menusList = data['menusList'];
          }

            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var clickTag = document.createElement("a")
            clickTag.href = "#"

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)
            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'button')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)

            let btnDiv = document.createElement("div")
            btnDiv.className = `btnDiv dragDiv ${btnCount == 'menu'?' menu-button':''}`
            btnDiv.id = `btnLinkDiv${buttonId}`

            let linkDiv = document.createElement("div")
            linkDiv.className = "linkDiv"
            linkDiv.id = "btnLink" + buttonId;
            if (btnCount === "one") {
              linkDiv.style.textAlign = `${btnPosition}`;
            } else if(btnCount === "two") {
              linkDiv.style.display = "grid";
              linkDiv.style.gridTemplateColumns = "repeat(2, 1fr)";
              linkDiv.style.gap = "10px";
            }else if(btnCount === 'menu'){
              linkDiv.style.display = "flex";
              linkDiv.style.gap = "5px";
              linkDiv.style.justifyContent = "space-between"
              linkDiv.style.backgroundColor = `${menuBgColor}`
            }


            clickTag.setAttribute("onclick", `editModal("editButton",this.previousElementSibling.id,this.parentElement.id)`)

            let btnTag = '';

            if (btnCount === "two") {
            if (btnType === "link") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="${btnLink}" id="linkTag${buttonId}_0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>
                      </div>`;
            } else if (btnType === "popup") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="#" id="linkTag${buttonId}_0" class="linkBtn link_btnLinkDiv${buttonId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColor}">${btnName}</a>
                      </div>`
            }

            if (btnTypeTwo === "link") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="${btnTwoLink}" id="linkTag${buttonId}_1" target="_blank" class="linkBtn" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                    </div>`;
            } else if (btnTypeTwo === "popup") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="#" id="linkTag${buttonId}_1" class="linkBtn link_btnLinkDiv${buttonId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                      </div>`
            }
          } else if(btnCount === "one") {
            if (btnType === "link") {
              btnTag = `<a href="${btnLink}" id="linkTag${buttonId}0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>`;
            } else if (btnType === "popup") {
              btnTag = `<a href="#" id="linkTag${buttonId}1" class="linkBtn link_btnLinkDiv${buttonId}" onclick="openPopupModal(this)" style="background-color:${btnColor}">${btnName}</a>`;
            }
          }else if(btnCount==="menu"){
            menuBtnData.forEach((btn,i)=>{
              if(btn.type === "link"){
                btnTag += `<a href="${btn['links'][0].link}" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn['links'][0].btnName}" class="linkBtn" target="_blank" style="color:${linkFontColor}">${btn['links'][0].btnName}</a>`;
              }else{
                let linkElem ="";
                btn['links'].forEach((l)=>{
                  linkElem += `<li><a class="dropdown-item" target="_blank" href="${l.link}">${l.btnName}</a></li>`
                  })

                btnTag += `<div class="dropdown">
                   <a class="btn dropdown-toggle" href="#" role="button" id="dropdownMenuLink${i}" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn.label}" data-bs-toggle="dropdown" aria-expanded="false" style="color:${linkFontColor}">
                      ${btn.label}
                   </a>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink${i}">
                      ${linkElem}
                    </ul>
                  </div>`
              }

            });
          }

          let buttonOneInfo;
          let buttonTwoInfo;
          let menuBtnInfo;

          if(btnCount === "menu"){
            menuBtnInfo = menuBtnData;
          }else {
            if (btnType === "link") {
              buttonOneInfo = { name: btnName, btnType, link: btnLink, btnPosition, bgColor: btnColor }
            } else {
              if (popupType === "link") {
                buttonOneInfo = { name: btnName, btnType, popupType, links, bgColor: btnColor, btnLocation, btnPosition };
              } else if (popupType === "image") {
                buttonOneInfo = { name: btnName, btnType, popupType, image: popupImage, bgColor: btnColor, btnLocation, btnPosition };
              } else if(popupType === "pdf"){
                buttonOneInfo = { name: btnName, btnType, popupType, pdf: popupPdf, bgColor: btnColor, btnLocation, btnPosition };
              }else if(popupType === "text"){
                buttonOneInfo = { name: btnName, btnType, popupType, text: popupText,textBgColor:popupTextColor, bgColor: btnColor, btnLocation, btnPosition };
              }
            }
          
          if (btnCount === "two") {
            if (btnTypeTwo === "link") {
              buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, link: btnTwoLink, btnPosition: btnPositionTwo, bgColor: btnColorTwo }
            } else {
              if (popupTypeTwo === "link") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, links: linksTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if (popupTypeTwo === "image") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, image: popupImageTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if(popupTypeTwo === "pdf") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, pdf: popupPdfTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              }else if(popupTypeTwo === "text"){
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, text: popupTextTwo,textBgColor:popupTextColorTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              }
            }
          }
        }
          let buttons = [];

          if(btnCount === "one"){
            buttons.push(buttonOneInfo);
          }else if (btnCount === "two") {
            buttons.push(buttonOneInfo);
            buttons.push(buttonTwoInfo);
          }else{
            buttons=[...menuBtnInfo.map(obj=>obj)];
          }


            linkDiv.innerHTML = btnTag;

            $('#createModal').modal('hide');
            btnDiv.appendChild(dropImg)
            btnDiv.appendChild(linkDiv)
            btnDiv.appendChild(clickTag)
            btnDiv.appendChild(deleteTag)
            parentContentCards.appendChild(btnDiv)

            if(btnCount ==="menu"){
              let titleCheck = $("#contentCard #title").length;
              if(titleCheck === 0){
                $("#contentCard").prepend(btnDiv);
              }else{
                $("#contentCard #title").after(btnDiv)
              }
              tempArray[`btnLinkDiv${buttonId}`] = { type: "8",menusList, btnCount,fontColor:linkFontColor,bgColor:menuBgColor, buttons }
            }else{
              if (updatesElemId) {
                btnContainerArray[`btnLinkDiv${buttonId}`] = { btnCount, buttons, updates: `updates${idCount}` }
                tempArray[`btnLinkDiv${buttonId}`] = { type: "8", btnCount, buttons, updates: `updates${idCount}` }
              } else {
                btnContainerArray[`btnLinkDiv${buttonId}`] = { btnCount, buttons }
                tempArray[`btnLinkDiv${buttonId}`] = { type: "8", btnCount, buttons }
              }
            }

            submitBtnDiv.style.display = "block"

            let modalContent = '';
            let linkElem = "";

            openPopupModal = (elem) => {
              modalContent = '';
              let btnAttr = elem.classList[1].split("_")[1];
              let popupData = tempArray[`${btnAttr}`]['buttons'][0]===undefined?tempArray[`${btnAttr}`]:tempArray[`${btnAttr}`]['buttons'][0];
              let modalType = popupData['popupType'];

              if (modalType === "image") {
                let imageUrl = '';
                if (typeof popupData.image[0] === "string") {
                  imageUrl = popupData.image[0];
                } else {
                  imageUrl = URL.createObjectURL(popupData.image[0])
                }
                modalContent = `<img src="${imageUrl}" class="popupImage" />`
              } else if (modalType === "pdf") {
                 let pdfUrl = '';
                if (typeof popupData.pdf[0] === "string") {
                  pdfUrl = popupData.pdf[0];
                } else {
                  pdfUrl = URL.createObjectURL(popupData.pdf[0])
                }
                modalContent = `<object data='${pdfUrl}' type='application/pdf' width='100%' height='700px'>`
              } else if (modalType === "link") {
                popupData.links.map((l) => {
                  modalContent += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
                })
              }else if(modalType === "text"){
              modalContent =`<div class="p-3" style="background-color:${popupData.textBgColor}">${popupData.text}</div>`
            }

              $("#popupBtnModalEdit .modal-body").html(modalContent);
              $('#popupBtnModalEdit').modal('show');
            }

             //Button Two
          let modalContentTwo = '';
          let linkElemTwo = "";

          openPopupTwoModal = (elem) => {
            modalContentTwo = '';
            let elemIndex = elem.id.split("_")[1];
            let btnAttr = elem.classList[1].split("_")[1];
            let popupTwoData = tempArray[`${btnAttr}`]['buttons'][elemIndex];
            let modalTypeTwo = popupTwoData['popupType'];

            console.log(popupTwoData,"popup")

            if (modalTypeTwo === "image") {
               let imageUrlTwo = '';
                if (typeof popupTwoData.image[0] === "string") {
                  imageUrlTwo = popupTwoData.image[0];
                } else {
                  imageUrlTwo = URL.createObjectURL(popupTwoData.image[0])
                }
              modalContentTwo = `<img src="${imageUrlTwo}" class="popupImage" />`
            } else if (modalTypeTwo === "pdf") {
                let pdfUrlTwo = '';
                if (typeof popupTwoData.pdf[0] === "string") {
                  pdfUrlTwo = popupTwoData.pdf[0];
                } else {
                  pdfUrlTwo = URL.createObjectURL(popupTwoData.pdf[0])
                }
              modalContentTwo = `<object data='${pdfUrlTwo}' type='application/pdf' width='100%' height='700px'>`
            } else if (modalTypeTwo === "link") {
              popupTwoData.links.map((l) => {
                modalContentTwo += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
              })
            }else if(modalTypeTwo === "text"){
              modalContentTwo =`<div class="p-3" style="background-color:${popupTwoData.textBgColor}">${popupTwoData.text}</div>`
            }

            $("#popupBtnModalEdit .modal-body").html(modalContentTwo);
            $('#popupBtnModalEdit').modal('show');
          }

            buttonId += 1;

          }
          else if (data.type === "9") {
            let imgId = `imgLink${imgLinkId}`
            var div = document.createElement('div')
            div.className = "imgLink dragDiv"
            div.id = imgId
            div.draggable = true

            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = sort

            var clickTag = document.createElement("a")
            clickTag.href = "#"

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = pen

            clickTag.appendChild(editImg)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'link')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = close

            deleteTag.append(deleteImg)


            const { link, image } = data
            if (updatesElemId) {
              imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: link, image: image, updates: `updates${idCount}` }
              tempArray[`imgLink${imgLinkId}`] = { type: "9", link: link, image: image, updates: `updates${idCount}` }
            } else {
              imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: link, image: image }
              tempArray[`imgLink${imgLinkId}`] = { type: "9", link: link, image: image }
            }

            // add image Url

            let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${image[0]}" alt=""/></a>`

            let imgDiv = document.createElement("div")
            imgDiv.className = "linkImgClass"
            imgDiv.id = "img" + imgId

            imgDiv.innerHTML = imgLinkDiv

            div.appendChild(dropImg)
            div.appendChild(imgDiv)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            parentContentCards.appendChild(div)
            submitBtnDiv.style.display = "block"
            buttonId += 1;
            imgLinkId += 1;
            clickTag.setAttribute("onclick", `editModal("editImgLink",this.previousElementSibling.id,this.parentElement.id)`)
          }

          else if (data.type === "10") {
            if (updatesElemId) {
              addUpdateSpace(parentContentCards, `updates${idCount}`)
            } else {
              addSpace()
            }

          }
          else if (data.type === "11") {
            let hyperLinkView = data.hyperLinkType == undefined ? "normal" : data.hyperLinkType;
            let hyperLinks = []
            hyperLinks = data.hyperlink
            let hyperDivId = `hyperLink${hyperLinkId}`

            var div = document.createElement('div')
            div.className = "hyperLinksContainer"
            div.id = hyperDivId
            div.draggable = true

            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 30
            dropImg.src = dragImageIcon

            var clickTag = document.createElement("a")
            clickTag.href = "#"

            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = editImageIcon

            clickTag.appendChild(editImg)

            clickTag.setAttribute("onclick", `editModal("editHyperLink",this.previousElementSibling.id,this.parentElement.id)`)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'hyperLink')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = deleteImageIcon

            deleteTag.append(deleteImg)

            let hyperLinkContainer = document.createElement("div")
            hyperLinkContainer.className = `hyperLinksDiv ${hyperLinkView === "stampcard" ? "stampcard" : ""}`
            hyperLinkContainer.id = `linksDiv${hyperLinkId}`

            let hyperLinkTag = "";
            hyperLinks.forEach((e, i) => {

              // add image Url

              hyperLinkTag +=
                `<div class="hyperLink ${hyperLinkView === "stampcard" ? "stampcard" : ""}">
                    <div class="linkDiv ${hyperLinkView === "stampcard" ? "stampcard" : ""}">
                        <a href="${e.link}" target="_blank">
                            <img src="${e.image[0]}" alt="">
                        </a>
                    </div>
                    <div class="captionDiv">
                        ${e.caption}
                    </div>
                </div>`
            })

            hyperLinkContainer.innerHTML = hyperLinkTag
            div.appendChild(dropImg)
            div.appendChild(hyperLinkContainer)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)

            let updatesContent;
            let updatesContentId;
            let parentDivId;
            if (pageTitle !== "") {
              //  updatesContentId= pageTitle.split("_")[0]
              //  updatesContent=document.getElementById(updatesContentId)
              //   parentDivId= updatesContentId.split("").pop()
            }

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            if (updatesElemId) {
              parentContentCards.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = { hyperLinkCards: hyperLinks, updates: `updates${idCount}` }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards: hyperLinks, updates: `updates${idCount}`, "hyperLinkType": hyperLinkView }
            } else {
              parentContentCards.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = { hyperLinkCards: hyperLinks }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards: hyperLinks, "hyperLinkType": hyperLinkView }
            }

            hyperLinkId += 1;

          }
          else if (data.type === "12") {

            const { heading, bgcolor, show, updates } = data
            // let updateDivId=modalBody.children[0].id.split("_")[0]

            var div = document.createElement('div')
            div.className = "updatesDivContainer"
            div.id = `updatesDivContainer${updatesId}`
            var dropImg = document.createElement("img")
            dropImg.className = "dragImg"
            dropImg.height = 20
            dropImg.width = 20
            dropImg.src = dragImageIcon

            var clickTag = document.createElement("a")
            clickTag.href = "#"


            var editImg = document.createElement('img')
            editImg.width = 20
            editImg.height = 20
            editImg.src = editImageIcon

            clickTag.appendChild(editImg)

            var deleteTag = document.createElement("a")
            deleteTag.href = "#"
            deleteTag.setAttribute("onclick", "deleteItem(this,'updates')")

            var deleteImg = document.createElement("img")
            deleteImg.width = 20
            deleteImg.height = 20
            deleteImg.src = deleteImageIcon

            deleteTag.append(deleteImg)

            clickTag.setAttribute("onclick", `editModal("editUpdates",this.previousElementSibling.id,this.parentElement.id)`)

            let updaesContainer = document.createElement("div")
            updaesContainer.className = "updatesDivBox"
            updaesContainer.id = `updatesDiv${updatesId}`


            let updatesTag = `<div class="headingDiv" style="background-color:${bgcolor}" id="updatesHeadingDiv${updatesId}">${heading}</div>
              <div class="updatesItems" id="updatesItems${updatesId}"></div>
              <div class="addButton">
                <div class="updatesBtns">
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('heading',this)">Header Band</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('description',this)">Description</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('image',this)">Image & Carousel</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('video',this)">Video</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('animation',this)">Gif Animation</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('quiz',this)">Add Quiz Question</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('link',this)">Image with Link</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this,'button')">Button with Link</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this,'popup')">Button with Popup</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('hyperLink',this)">Image[s] with Caption & Link</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('linkPopup',this)">Link with Popup</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="addSpace('updates',this)">Space</button>
                </div>
                <div>
                  <button type="button" onclick="updatesBtnsFn(this)" id="updatesDiv${updatesId}_btn" class="updatesAddBtn rounded-circle">+</button>
                </div>
              </div>`



            updaesContainer.innerHTML = updatesTag
            div.appendChild(dropImg)
            div.appendChild(updaesContainer)
            div.appendChild(clickTag)
            div.appendChild(deleteTag)

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            updatesArray[`updatesDivContainer${updatesId}`] = { heading: heading, show: show, bgColor: bgcolor, updates: updates }
            tempArray[`updatesDivContainer${updatesId}`] = { type: "12", heading: heading, show: show, bgColor: bgcolor, updates: updates }

            parentContentCards.appendChild(div)

            fetchElem(updates, `updatesItems${updatesId}`)
            updatesId += 1;



            const updatesElemClassSort = document.querySelectorAll('.updatesDivContainer')

            for (var i = 0; i < updatesElemClassSort?.length; i++) {
              let ParentId = updatesElemClassSort[i].id
              let idCount = ParentId.split("").pop()
              var numb = ParentId.match(/\d/g);
              numb = numb.join("");
              let dragAreaUpdates = document.getElementById(`updatesItems${Number(numb)}`)
              if (dragAreaUpdates) {
                new Sortable(dragAreaUpdates, {
                  filter: '.titleDiv',
                  handle: ".dragImg",
                  Animation: 350
                })
              }
            }


            updatesBtnsFn = (event) => {
              let btnDiv = event.id.split("_")[0]
              $(`#${btnDiv} .updatesBtns`).toggleClass("active");
            }

          }
          else if(data.type === "13"){
            linkPopupId=data.linkCount;
            tempArray['linkPopup']=data;
            
          }
      
        })
      }

      

      let gotoData;

      window.onload = async () => {
        let pageData = await fetchData
        gotoData = await fetchGotoData
        fetchElem(pageData)
      }


      console.log(tempArray,"array")

      function addUpdateSpace(element, updates) {
        let updatesDivId = element.id
        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let parentDiv = document.getElementById(`${updatesDivId}`)
        let spaceDiv = document.createElement('div')
        spaceDiv.className = "spaceDiv dragDiv"
        spaceDiv.id = `space${emptySpaceCount}`
        spaceDiv.style = "height:20px"
        spaceDiv.draggable = true

        var dropImg = document.createElement("img")
        dropImg.className = "dragImg"
        dropImg.height = 20
        dropImg.width = 20
        dropImg.src = sort

        var clickTag = document.createElement("a")
        clickTag.href = "#"

        var editImg = document.createElement('img')
        editImg.width = 20
        editImg.height = 20
        editImg.src = pen

        clickTag.appendChild(editImg)

        var deleteTag = document.createElement("a")
        deleteTag.href = "#"
        //
        deleteTag.setAttribute("onclick", "deleteItem(this,'space')")

        var deleteImg = document.createElement("img")
        deleteImg.width = 20
        deleteImg.height = 20
        deleteImg.src = close

        deleteTag.append(deleteImg)
        spaceDiv.appendChild(dropImg)
        spaceDiv.appendChild(deleteTag)
        parentDiv.appendChild(spaceDiv)

        emptyPageArray[`space${emptySpaceCount}`] = { "type": "10", updates: `${updates}` }
        tempArray[`space${emptySpaceCount}`] = { "type": "10", updates: `${updates}` }

        emptySpaceCount += 1;

      }

      function addSpace(element, updates) {
        let updatesSpace = updates?.className?.split(" ")[1].split("_")[0]
        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let parentDiv = document.getElementById("contentCard")
        let spaceDiv = document.createElement('div')
        spaceDiv.className = "spaceDiv dragDiv"
        spaceDiv.id = `space${emptySpaceCount}`
        spaceDiv.style = "height:20px"
        spaceDiv.draggable = true

        var dropImg = document.createElement("img")
        dropImg.className = "dragImg"
        dropImg.height = 20
        dropImg.width = 20
        dropImg.src = sort

        var clickTag = document.createElement("a")
        clickTag.href = "#"

        var editImg = document.createElement('img')
        editImg.width = 20
        editImg.height = 20
        editImg.src = pen

        clickTag.appendChild(editImg)

        var deleteTag = document.createElement("a")
        deleteTag.href = "#"
        //
        deleteTag.setAttribute("onclick", "deleteItem(this,'space')")

        var deleteImg = document.createElement("img")
        deleteImg.width = 20
        deleteImg.height = 20
        deleteImg.src = close

        deleteTag.append(deleteImg)
        spaceDiv.appendChild(dropImg)
        spaceDiv.appendChild(deleteTag)
        parentDiv.appendChild(spaceDiv)
        if (updatesSpace) {
          let updatesDiv = document.getElementById(updatesSpace)
          let updatesCount = updatesSpace.split("").pop()
          updatesDiv.appendChild(spaceDiv)
          emptyPageArray[`space${emptySpaceCount}`] = { "type": "10", updates: `updates${updatesCount}` }
          tempArray[`space${emptySpaceCount}`] = { "type": "10", updates: `updates${updatesCount}` }
        } else {
          parentDiv.appendChild(spaceDiv)
          emptyPageArray[`space${emptySpaceCount}`] = { "type": "10" }
          tempArray[`space${emptySpaceCount}`] = { "type": "10" }
        }
        emptySpaceCount += 1;

      }


      function showModal(element, btnPopup) {
        $("#createBtn").prop('disabled', false);
        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        document.getElementById("pageContent").innerHTML = ""
        if (element === "heading") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText =btnPopup==="donor"?"Add Donor Header":"Add Header Band";

          modalTitle.className = ""

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('input')
          input.id = "headingId" + headingDivId
          input.className = "form-control headingClass"
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color ${btnPopup==="donor"?"donor-color":""}"" id="colorPickerId" value="${pageBgColor}">
          </div>`
          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"

          mainDiv.innerHTML = colorPick
          let donorExisting = document.createElement('div')
          donorExisting.innerHTML=`<div class="existing-donor">The donor header is already existing in this page.</div>`
          let donorCheck = $("#contentCard .donor-class").length;
          if(donorCheck !== 0){
            if(btnPopup === "donor"){
              modalBody.appendChild(donorExisting);
              $("#createBtn").prop('disabled', true);
            }else{
              modalBody.appendChild(input)
              modalBody.appendChild(mainDiv)
              changeToRichtext([`headingId${headingDivId}`])
              $("#createBtn").prop('disabled', false);
            }
          }else{
            modalBody.appendChild(input)
            modalBody.appendChild(mainDiv)
            changeToRichtext([`headingId${headingDivId}`])
            $("#createBtn").prop('disabled', false);
          }
        }
        else if (element === "headingDesc") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Description"
          modalTitle.className = ""

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('textarea')
          input.id = "headingDescId" + headingDescId
          input.className = "form-control headingDescClass"


          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descColorPicker" value="${pageBgColor}">
          </div>`

          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"
          mainDiv.innerHTML = colorPick

          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)

          //CKEDITOR.replace(`headingDescId`+headingDescId,{ toolbar : 'Full', toolbarLocation : 'bottom' });

          changeToRichtext([`headingDescId${headingDescId}`])

        }
        else if (element === "image") {
          $('#createModal').modal('show');
          $("#imgErrorMsg").remove();
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image and Carousel"
          modalTitle.className = ""

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgCard"
          //
          cardDiv.id = `imgContainerDiv${imageContainerId}`
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <fieldset class="row mb-3">
                    <legend class="col-form-label col-sm-4 pt-0">Images View</legend>
                    <div class="col-sm-8">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageView" value="normal" id="normal" onchange="imageTypeFn(this)" checked>
                        <label class="form-check-label" for="normal">
                          Normal
                        </label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageView" value="carousel" onchange="imageTypeFn(this)" id="carousel">
                        <label class="form-check-label" for="carousel">
                          Carousel
                        </label>
                      </div>
                    </div>
                  </fieldset>
                  <form action="" method="post" class="dragover">
                      <input name="file" type="file" class="file" id="imgInput" accept="image/png, image/jpeg" onchange="imageonChange(this)" hidden />
                      <label for="imgInput">Choose Image</label>
                      <span id="imageChosen">No image chosen</span>
                  </form>
                  <div class="imgContainer">
                  </div>
                  <div id="bgColorDiv" class="row gap-2" style="display:none">
                    <div class="col-12">
                      <div class="row align-items-center">
                        <label for="arrowBgColor" class="form-label col-6">Arrow Background Color</label>
                        <div class="col-4">
                          <input type="color" class="form-control form-control-color" id="arrowBgColor" value="#828282">
                        </div>
                      </div>
                    </div>
                  </div>`

          modalBody.appendChild(cardDiv)

          imageTypeFn = (elem) => {
            let typeVal = $(elem).val();
            if (typeVal === "carousel") {
              $("#bgColorDiv").css("display", "flex");
            } else if (typeVal === "normal") {
              $("#bgColorDiv").css("display", "none");
            }
          }

          files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.imgContainer')
          container.id = "imgContainer" + imageContainerId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          imageonChange = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) {
                files.push(file[i])
              }
            }

            imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = files
            tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: files }

            $("#imgErrorMsg").remove();
            form.reset();
            showImages()
            $("#imageChosen").css("display", "none")
          }

          showImages = () => {
            let images = '';
            files.forEach((e, i) => {
              images += `<div class="image box" draggable="true"">
                        <img src=${URL.createObjectURL(e)} alt="img" >
                       <span onclick="delImages(${i})"> &times;</span>
                    </div>`
            })
            container.innerHTML = images

          }

          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          imageId += 1


        }
        else if (element === "quiz") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Quiz Question"
          modalTitle.className = ""
          var modalBody = document.getElementById('pageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClass"
          formDiv.id = "quizDiv" + quizId
          var options = ""
          for (let i = 0; i < 4; i++) {
            options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option${i}" placeholder="option ${i + 1}" required name="option${i}" />
                </div>`
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" />
          </div>`

          var quizDivContainer =
            `<div class="row g-3">
               <div class="col-12">
                <textarea name="quizQstn" id="question"${quizId} />
               </div>
               ${options}
               ${answerDiv}
              </div>`


          var divOne = document.createElement("div")
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          // formDiv.innerHTML = quizDivContainer

          modalBody.appendChild(formDiv)
          // CKEDITOR.replace(`question${quizId}`,{ toolbar : 'Full', toolbarLocation : 'bottom' });



        }
        else if (element === 'video') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Video"
          modalTitle.className = ""
          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          cardDiv.id = "videoContainer" + videoContainerId

          thumbnailImage="";

          cardDiv.innerHTML = `<div class="video-option mb-3">
                          <fieldset>
                          <legend class="col-form-label pt-0">Video Type:</legend>
                          <div class="video-option-div">
                            <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="videoType" id="videoUpload" value="upload" onchange="videoTypeChange(this)" checked>
                              <label class="form-check-label" for="videoUpload">
                                Upload
                              </label>
                            </div>
                            <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="videoType" id="videoLink" value="link" onchange="videoTypeChange(this)" >
                              <label class="form-check-label" for="videoLink">
                                Link
                              </label>
                            </div>
                          </div>
                      </fieldset>
                      </div>
                  <form action="" method="post" class="dragover" id="videoUploadDiv">
                      <input name="file" type="file" class="file" id="videoInputField" onchange="videoOnChange(this)" accept="video/mp4" hidden />
                      <label class="file-choose-label" for="videoInputField">Choose Video</label>
                      <span id="videoChosen">No video chosen</span>
                  </form>
                  <div class="video-link-container" id="videoLinkDiv" style="display:none">
                    <div class="input-div">
                      <label>Video Link:</label>
                      <div class="video-input">
                        <input class="form-control" type="text" id="videoLinkInput" onkeyup="inputVerify(this)" />
                        <p class="sub-text">(Ex:https://www.youtube.com/embed/video_id)</p>
                      </div>
                    </div>
                    <div class="video-thumbnail-container">
                      <p>Thumbnail:</p>
                      <div class="thumbnail-input">
                        <label class="file-choose-label" for="videoThumbnail">Choose Image</label>
                        <input type="file" id="videoThumbnail" onchange="videoThumbChange(this)" accept="image/png, image/jpeg" hidden />
                      </div>
                      <div id="thumbnailImageDiv"></div>
                    </div>
                  </div>
              <div class="videoModalContainer"></div>`

          modalBody.appendChild(cardDiv)

          $(".video-link-error").remove();

          inputVerify = (e)=>{
            let videoLink= $(e).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)

            $(".video-link-error").remove();
            if(linkUrlValidate === false){
              $(e).after('<p class="error video-link-error">Please enter the valid URL.</p>')
            }else{
              $(".video-link-error").remove();
            }
          }

          videoTypeChange = (elem)=>{
            let videoTypeOption = $(elem).val();
            if(videoTypeOption === "upload"){
              $("#videoUploadDiv").css("display","flex");
              $("#videoLinkDiv").css("display","none");
            }else{
              $("#videoUploadDiv").css("display","none");
              $("#videoLinkDiv").css("display","flex");
              $(".videoModalContainer").html("");
            }
          }

          videoThumbChange = (elem)=>{
            $(".thumbnail-error").remove();
            let sizeInMb = elem.files[0].size / (1024 * 1024);
            if(sizeInMb < 5){
              thumbnailImage = elem.files[0];
              $("#thumbnailImageDiv").html(`<img src="${URL.createObjectURL(thumbnailImage)}" />`);
            }else{
              $(elem).after('<p class="error thumbnail-error">Image should be less than 5MB.</p>');
            }
          }


          const maxAllowedSize = 10 * 1024 * 1024;

          let files = "",
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainer')
          //
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          videoOnChange = (elem) => {
            $(".video-error").remove();
            files = elem.files[0];

            if (files.size < maxAllowedSize) {
              videoContainerArrary[`DivvideoContainer${videoContainerId}`] = files
              tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: files }
              form.reset();
              showVideos();
              $("#videoChosen").css("display", "none")
            } else {
              container.insertAdjacentHTML('afterend', '<p style="color:red" class="video-error">Maximum video size is 10MB</p>');
            }
          }

          const showVideos = () => {
            let videos = `<div class="video" id="videoId" draggable="true">
                      <video src=${URL.createObjectURL(files)} alt="video" />
                      <span onclick="delVideos()">&times;</span>
                  </div>`
            container.innerHTML = videos

          }


          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          videoTempId = videoContainerId;

        }
        else if (element === "animation") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Gif Animation"
          modalTitle.className = ""
          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = "animationsDiv" + animationId
          cardDiv.innerHTML = `<div class="top">
                </div>
                <form action="" method="post" class="dragover">
                    <input name="file" type="file" class="file" id="animationInput" multiple accept="image/gif" onchange="animationonChange(this)" hidden />
                    <label class="file-choose-label" for="animationInput">Choose GIF</label>
                    <span id="animationChosen">No GIF chosen</span>
                </form>
                <div class="animationContainer">
                </div>`

          modalBody.appendChild(cardDiv)

          let files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationContainer')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          animationonChange = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) files.push(file[i])
            }
            animationContainerArray[`animationsDiv${animationId}`] = files;
            tempArray[`animationsDiv${animationId}`] = { type: "6", animations: files }
            form.reset();
            showAnimations();
            $("#animationChosen").css("display", "none")
          }

          const showAnimations = () => {
            let animations = '';
            files.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                      <img src=${URL.createObjectURL(e)} alt="animation">
                      <span onclick="delAnimations(${i})">&times;</span>
                  </div>`
            })
            container.innerHTML = animations

          }

          delAnimations = (index) => {
            files.splice(index, 1)
            showAnimations()
          }

          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })


        }
        else if (element === "pageTitle") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          let titleCheck = $("#contentCard #title")
          modalTitle.innerText = "Add Page Title & Color"
          var modalBody = document.getElementById('pageContent')
          var pageTitle = ` <div class="col-md-12">
            <input type="text" class="form-control" id="pageTitleField">
          </div>
          <div class="col-12">
            <div class="row">
              <label for="colorPickerId" class="form-label col-6">Background Color</label>
              <input type="color" class="form-control form-control-color col-6" id="colorPickerId" value="#fcfcfc">
            </div>
          </div>
          <div class="col-12 mt-3">
            <div class="row">
              <label class="col-4">
               Choose Texture:
              </label>
              <div class="col-8">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOption" id="existingTexture" onchange="textureChange(this)" value="existing" checked>
                  <label class="form-check-label" for="existingTexture">Existing Texture</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOption" id="newTexture" onchange="textureChange(this)" value="new" >
                  <label class="form-check-label" for="newTexture">New Texture</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOption" id="textureColor" onchange="textureChange(this)" value="color">
                  <label class="form-check-label" for="textureColor">Bg Color</label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 textures-options" id="existingTextureList" style="display:flex">
          </div>
          <div class="col-12 textures-options gap-3" id="textureUpload" style="display:none">
            <div>
              <input class="form-control" type="file" id="mainBgImage" accept="image/png, image/jpeg" onchange="bgImageonChange(this)" hidden />
              <label class="file-choose-label" for="mainBgImage">Choose Image</label>
            </div>
            <div id="mainImgContainer" style="display:none"></div>
          </div>
          <div class="col-12 textures-options" id="textureColorDiv" style="display:none">
            <div class="row">
              <div class="col-4"></div>
            <input type="color" class="form-control form-control-color col-8" id="textureBgColor" value="#ffffff">
            </div>
          </div>
          `
          let existingElem = `<div style="height:100px" class="d-flex align-items-center justify-content-center">
                              <p>Page Title is already existing in this page.</p>
                          </div>`
        
          let textureImages=['../../assets/img/texture1.jpg','../../assets/img/texture2.jpg','../../assets/img/texture3.jpg'];

          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          if(titleCheck.length === 0){
            parentDiv.innerHTML = pageTitle;
          }else{
            parentDiv.innerHTML = existingElem;
            $("#createBtn").prop('disabled', true);
          }
          
          modalBody.appendChild(parentDiv)

          textureImages.forEach((image,i)=>{
            $("#existingTextureList").append(`<div class="form-check form-check-inline existing-list-img">
                    <input class="form-check-input" type="radio" name="textureImgOption" id="existingImg${i}" onchange="textureImgChoose(${i})" ${i==0?"checked":""}>
                    <label for="existingImg${i}">
                      <img src="${image}" />
                    </label>
                  </div>`)
          })

          pageBgImage = textureImages[0];

          textureImgChoose = (index)=>{
            pageBgImage = textureImages[index];
            textureImageIndex=index;
          }

          bgImageonChange = (elem)=>{
            $(".texture-img-error").remove();
            let fileSizeInMB = elem.files[0].size / (1024 * 1024);
            if(fileSizeInMB > 20){
              $("#mainImgContainer").parent().after("<p class='error texture-img-error'>Please upload an image less than 20MB.</p>")
            }else{
              pageBgImage = elem.files[0];
              $("#mainImgContainer").html(`<img src="${URL.createObjectURL(elem.files[0])}" /><span onclick="deltextureImg()"><i class="fa-solid fa-xmark"></i></span>`)
              $("#mainImgContainer").css("display","block");
            }
          }

          deltextureImg = () =>{
            $("#mainImgContainer").html("");
            pageBgImage="";
            $("#mainImgContainer").css("display","none");
          }

          textureChange=(elem)=>{
            $(".textures-options").css("display","none")
            let textOption = $(elem).val();
            if(textOption==="existing"){
              $(`#existingTextureList`).css("display","flex");
            }else if(textOption === "new"){
              $(`#textureUpload`).css("display","flex");
            }else if(textOption === "color"){
              $(`#textureColorDiv`).css("display","block");
            }
            
          }

          var colorPickerField = document.getElementById("colorPickerId")
          let colorInputField = document.getElementById("colorId")

          changeToRichtext([`pageTitleField`])

        }
        else if (element === 'button') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle");
          modalTitle.innerText = btnPopup === "button" ? "Add Button with Link" : "Add Button with popup [Text, Image, PDF, Link]";
          modalTitle.className = "";
          var modalBody = document.getElementById('pageContent');
          popupPdf = "";
          popupImage = "";

          popupPdfTwo = "";
          popupImageTwo = "";

          let buttonInput = `<div class="row gap-2 pb-3">
            <div class="col-12">
              <fieldset class="row">
                <legend class="col-form-label col-4 pt-0">Buttons:</legend>
                <div class="col-8">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonCount" id="one" value="one" onchange="buttonCountChange(this)" checked>
                    <label class="form-check-label" for="one">
                      Single
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonCount" id="two" value="two" onchange="buttonCountChange(this)" >
                    <label class="form-check-label" for="two">
                      Double
                    </label>
                  </div>
                  <div class="form-check form-check-inline" id="menuBtnOption">
                    <input class="form-check-input" type="radio" name="buttonCount" id="menu" value="menu" onchange="buttonCountChange(this)" >
                    <label class="form-check-label" for="menu">
                      Menu
                    </label>
                  </div>
                </div>
            </fieldset>
          </div>
                  <div class="gap-3 flex-column" id="firstBtnDiv" style="display:flex">
                        <div class="col-12">
                          <fieldset class="row">
                            <legend class="col-form-label col-4 pt-0">Button Type:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="buttonType" id="link" value="link" onchange="buttonTypeChange(this)" checked>
                                <label class="form-check-label" for="link">
                                  Link
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="buttonType" id="popup" value="popup" onchange="buttonTypeChange(this)" >
                                <label class="form-check-label" for="popup">
                                  Popup
                                </label>
                              </div>
                            </div>
                        </fieldset>
                      </div>
              
                    <div class="col-12">
                      <input type="text" class="form-control" id="btnName" placeholder="Name">
                    </div>
                    <div class="col-12" id="linkDiv" style="display:block">
                      <input type="text" class="form-control" id="btnLinkId" placeholder="Link">
                    </div>
                    <div class="col-12">
                      <div class="row align-items-center">
                      <label for="colorPickerId" class="form-label col-6">Choose background Color</label>
                      <div class="col-4">
                        <input type="color" class="form-control form-control-color" id="btnColorPicker" value="#b3b3b3">
                      </div>
                    </div>
                    </div>
                    <div class="col-12">
                      <fieldset class="row mb-2 mt-2">
                        <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
                        <div class="col-sm-10">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="left" value="left">
                            <label class="form-check-label" for="left">
                              Left
                            </label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="center" value="center" checked>
                            <label class="form-check-label" for="center">
                              Center
                            </label>
                          </div>

                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="right" value="right">
                            <label class="form-check-label" for="right">
                              Right
                            </label>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                  </div>
                  <div id="popupDiv" style="display:none">
                  <fieldset class="row mb-2 mt-2">
                    <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
                    <div class="col-sm-10">
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="btnLocation" id="header" value="header" checked>
                        <label class="form-check-label" for="header">
                          Header
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="btnLocation" id="body" value="body">
                        <label class="form-check-label" for="body">
                          Body
                        </label>
                      </div>
                    </div>
                  </fieldset>

         
                  <fieldset class="row mb-2 mt-2">
                    <legend class="col-form-label col-sm-2 pt-0">Content:</legend>
                    <div class="col-sm-10">

                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="textBtn" value="text">
                        <label class="form-check-label" for="textBtn">
                          Text
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="imageBtn" value="image">
                        <label class="form-check-label" for="imageBtn">
                          Image
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="pdfBtn" value="pdf">
                        <label class="form-check-label" for="pdfBtn">
                          PDF
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="linkBtn" value="link" checked>
                        <label class="form-check-label" for="linkBtn">
                          List of links
                        </label>
                      </div>
                    </div>
                  </fieldset>
                  <div class="uploadContainer">
                    <div class="uploadDiv" id="pdfUpload" style="display:none">
                      <input type="file" id="pdfFile" accept ="application/pdf" hidden/>
                      <label for="pdfFile">Choose PDF</label>
                      <span id="pdfChosen">No file chosen</span>
                    </div>
                    <div class="uploadDiv" id="imageUpload" style="display:none">
                      <input type="file" id="imageFile" accept="image/png, image/jpeg" hidden/>
                      <label for="imageFile">Choose Image</label>
                      <div id="previewDiv"></div>
                    </div>
                    <div class="uploadDiv" id="textUpload" style="display:none">
                      <input type="text" id="popupText"/>
                      <div class="popup-text-color">
                        <span for="popupTextColor" class="form-label">Background Color</span>
                        <input type="color" class="form-control form-control-color" id="popupTextColor" value="#fcfcfc">
                      </div>
                    </div>
                    <div class="uploadDiv" id="linkUpload">
                      <div id="linkForm">
                        <form class="input-div">
                          <div class="links">
                            <input type='text' class="form-control" name='name' placeholder="Name">
                            <input type="text" class="form-control" name="link" placeholder="Link">
                          </div>
                          <div class="btn-div">
                            <button type="button" id="addInputFieldButton" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
                          </div>
                        </form> 
                      </div>
                    </div>
                  </div>
                </div>
        </div>  
</div>`


          let buttonInputTwo = `<div class="gap-3 flex-column border-top pt-3" id="secondBtnDiv" style="display:none">
  <div class="col-12">
    <fieldset class="row">
      <legend class="col-form-label col-4 pt-0">Button Type:</legend>
      <div class="col-8">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="buttonTypeTwo" id="linkTwo" value="link" onchange="buttonTypeChangeTwo(this)" checked>
          <label class="form-check-label" for="linkTwo">
            Link
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="buttonTypeTwo" id="popupTwo" value="popup" onchange="buttonTypeChangeTwo(this)" >
          <label class="form-check-label" for="popupTwo">
            Popup
          </label>
        </div>
      </div>
  </fieldset>
</div>

<div class="col-12">
  <input type="text" class="form-control" id="btnNameTwo" placeholder="Name">
</div>
<div class="col-12" id="linkDivTwo" style="display:block">
  <input type="text" class="form-control" id="btnLinkIdTwo" placeholder="Link">
</div>
<div class="col-12">
    <div class="row align-items-center">
      <label for="btnColorPickerTwo" class="form-label col-6">Choose background Color</label>
      <div class="col-4">
        <input type="color" class="form-control form-control-color" id="btnColorPickerTwo" value="#b3b3b3">
      </div>
    </div>
</div>
<div class="col-12">
  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="leftTwo" value="left">
        <label class="form-check-label" for="leftTwo">
          Left
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="centerTwo" value="center" checked>
        <label class="form-check-label" for="centerTwo">
          Center
        </label>
      </div>

      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="rightTwo" value="right">
        <label class="form-check-label" for="rightTwo">
          Right
        </label>
      </div>
    </div>
  </fieldset>
</div>
<div id="popupDivTwo" style="display:none">
  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnLocationTwo" id="headerTwo" value="header" onchange="btnLocationChangeTwo()" checked>
        <label class="form-check-label" for="headerTwo">
          Header
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnLocationTwo" id="bodyTwo" value="body" onchange="btnLocationChangeTwo()">
        <label class="form-check-label" for="bodyTwo">
          Body
        </label>
      </div>
    </div>
  </fieldset>

  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Content</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="textBtnTwo" value="text">
        <label class="form-check-label" for="textBtnTwo">
          Text
        </label>
      </div>

      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="imageBtnTwo" value="image">
        <label class="form-check-label" for="imageBtnTwo">
          Image
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="pdfBtnTwo" value="pdf">
        <label class="form-check-label" for="pdfBtnTwo">
          PDF
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="linkBtnTwo" value="link" checked>
        <label class="form-check-label" for="linkBtnTwo">
          List of links
        </label>
      </div>
    </div>
  </fieldset>
  <div class="uploadContainer">
    <div class="uploadDivTwo" id="pdfUploadTwo" style="display:none">
      <input type="file" id="pdfFileTwo" accept ="application/pdf" hidden/>
      <label for="pdfFileTwo">Choose PDF</label>
      <span id="pdfChosenTwo">No file chosen</span>
    </div>
    <div class="uploadDivTwo" id="imageUploadTwo" style="display:none">
      <input type="file" id="imageFileTwo" accept="image/png, image/jpeg" hidden/>
      <label for="imageFileTwo">Choose Image</label>
      <div id="previewDivTwo"></div>
    </div>
    <div class="uploadDivTwo" id="textUploadTwo" style="display:none">
      <input type="text" id="popupTextTwo"/>
      <div class="popup-text-color">
        <span for="popupTextColorTwo" class="form-label">Background Color</span>
        <input type="color" class="form-control form-control-color" id="popupTextColorTwo" value="#fcfcfc">
      </div>
    </div>
    <div class="uploadDivTwo" id="linkUploadTwo">
      <div id="linkFormTwo">
        <form class="input-div">
          <div class="links">
            <input type='text' class="form-control" name='name' placeholder="Name">
            <input type="text" class="form-control" name="link" placeholder="Link">
          </div>
          <div class="btn-div">
            <button type="button" id="addInputFieldButtonTwo" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
          </div>
        </form> 
      </div>
    </div>
  </div>
  </div>
</div>  
</div>`

let menuBtnsElem = `<div class="menu-btns-conatiner" id="menuBtnsDiv" style="display:none">
                <div class="col-12 mb-2">
                  <div class="row align-items-center">
                    <label for="colorPickerId" class="form-label col-6">Background Color:</label>
                    <div class="col-4">
                      <input type="color" class="form-control form-control-color" id="menuBgColor" value="#b3b3b3">
                    </div>
                  </div>
                </div>
                <div class="col-12 mb-2">
                  <div class="row align-items-center">
                    <label for="colorPickerId" class="form-label col-6">Font Color:</label>
                    <div class="col-4">
                      <input type="color" class="form-control form-control-color" id="linkFontColor" value="#ffffff">
                    </div>
                  </div>
                </div>

                  <div class="col-12">
                      <fieldset class="row mb-2 mt-2">
                        <legend class="col-form-label col-4 pt-0">Manu List:</legend>
                        <div class="col-8">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheck" id="leftBtnCheck" onchange="buttonListChange(this,'left')" value="left" checked>
                            <label class="form-check-label" for="leftBtnCheck">Menu One</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheck" id="centerBtnCheck" onchange="buttonListChange(this,'center')" value="center">
                            <label class="form-check-label" for="centerBtnCheck">Menu Two</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheck" id="rightBtnCheck" onchange="buttonListChange(this,'right')" value="right">
                            <label class="form-check-label" for="rightBtnCheck">Menu Three</label>
                          </div>
                        </div>
                      </fieldset>
                </div>

                <div class="col-12">
                      <fieldset class="row mb-2 mt-2">
                        <legend class="col-form-label col-4 pt-0">Manu Position in Page:</legend>
                        <div class="col-8">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="menuBtnPosition" onchange="menuPositionChange(this)" id="leftMenu" value="left" checked>
                            <label class="form-check-label" for="leftMenu">
                              Left
                            </label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="menuBtnPosition" onchange="menuPositionChange(this)" id="centerMenu" value="center">
                            <label class="form-check-label" for="centerMenu">
                              Center
                            </label>
                          </div>

                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="menuBtnPosition" onchange="menuPositionChange(this)" id="rightMenu" value="right">
                            <label class="form-check-label" for="rightMenu">
                              Right
                            </label>
                          </div>
                        </div>
                      </fieldset>
                </div>

              <div class="links-container" id="leftMenuList">
                <fieldset class="row mb-2 mt-2">
                  <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                  <div class="col-8">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="leftMenuType" onchange="MenuTypeChange(this,'left')" id="LeftMenuLink" value="link" checked>
                      <label class="form-check-label" for="LeftMenuLink">
                        Main Menu
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="leftMenuType" onchange="MenuTypeChange(this,'left')" id="leftMenuDropDown" value="dropDown">
                      <label class="form-check-label" for="leftMenuDropDown">
                      Sub Menu
                      </label>
                    </div>
                  </div>
                </fieldset>
                <div class="link-menu menu-value-fields">
                  <form class="row gap-3" class="menuBtnForm">
                    <div class="col-12">
                        <input type="text" class="form-control" name="btnName" placeholder="Name">
                    </div>
                    <div class="col-12">
                      <input type="text" class="form-control" name="link" placeholder="Link">
                    </div>
                  </form>
                </div>
                <div class="drop-down-menu menu-value-fields" style="display:none">
                  <div class="menu-btns">
                      <div class="drop-down-label">
                          <input type="text" class="form-control" id="leftDropDownName" name="btnName" placeholder="Name">
                      </div>
                    <div class="add-more-btn">
                      <button type="button" id="leftAddMoreMenuBtn" onclick="addMoreBtn('left')">
                        <i class="fa-solid fa-plus"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div> 
              <div class="links-container" id="centerMenuList" style="display:none">
                <fieldset class="row mb-2 mt-2">
                  <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                  <div class="col-8">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="centerMenuType" onchange="MenuTypeChange(this,'center')" id="centerMenuLink" value="link" checked>
                      <label class="form-check-label" for="centerMenuLink">
                        Main Menu
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="centerMenuType" onchange="MenuTypeChange(this,'center')" id="centerMenuDropDown" value="dropDown">
                      <label class="form-check-label" for="centerMenuDropDown">
                        Sub Menu
                      </label>
                    </div>
                  </div>
                </fieldset>
                <div class="link-menu menu-value-fields">
                  <form class="row gap-3" class="menuBtnForm">
                    <div class="col-12">
                        <input type="text" class="form-control" name="btnName" placeholder="Name">
                    </div>
                    <div class="col-12">
                      <input type="text" class="form-control" name="link" placeholder="Link">
                    </div>
                  </form>
                </div>
                <div class="drop-down-menu menu-value-fields" style="display:none">
                  <div class="menu-btns">
                    <div class="drop-down-label">
                          <input type="text" class="form-control" id="centerDropDownName" name="btnName" placeholder="Name">
                    </div>
                    <div class="add-more-btn">
                      <button type="button" id="centerAddMoreMenuBtn" onclick="addMoreBtn('center')">
                        <i class="fa-solid fa-plus"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div> 
              <div class="links-container" id="rightMenuList" style="display:none">
                <fieldset class="row mb-2 mt-2">
                  <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                  <div class="col-8">
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="rightMenuType" onchange="MenuTypeChange(this,'right')" id="rigtMenuLink" value="link" checked>
                      <label class="form-check-label" for="rigtMenuLink">
                        Main Menu
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="rightMenuType" onchange="MenuTypeChange(this,'right')" id="rightMenuDropDown" value="dropDown">
                      <label class="form-check-label" for="rightMenuDropDown">
                        Sub Menu
                      </label>
                    </div>
                  </div>
                </fieldset>
              <div class="link-menu menu-value-fields">
                  <form class="row gap-3" class="menuBtnForm">
                    <div class="col-12">
                        <input type="text" class="form-control" name="btnName" placeholder="Name">
                    </div>
                    <div class="col-12">
                      <input type="text" class="form-control" name="link" placeholder="Link">
                    </div>
                  </form>
                </div>
                <div class="drop-down-menu menu-value-fields" style="display:none">
                  <div class="menu-btns">
                      <div class="drop-down-label">
                          <input type="text" class="form-control" id="rightDropDownName" name="btnName" placeholder="Name">
                      </div>
                      <div class="add-more-btn">
                        <button type="button" id="rightAddMoreMenuBtn" onclick="addMoreBtn('right')">
                          <i class="fa-solid fa-plus"></i>
                        </button>
                      </div>
                  </div>
                </div> 
              </div>
              </div>`


          let buttonDiv = document.createElement("div")
          buttonDiv.id = "btnLink"
          buttonDiv.className = "row g-3"

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = `btnLinkDiv${buttonId}`
          mainDiv.innerHTML = buttonInput;
          mainDiv.innerHTML += buttonInputTwo;
          mainDiv.innerHTML += menuBtnsElem;
          modalBody.appendChild(mainDiv);

          buttonListChange = (elem,pos) =>{
            if ($(`#${elem.id}`).is(":checked") == false){
              $(`#${pos}Menu`).parent().css("pointer-events", "none");
              $(`#${pos}Menu`).parent().css("opacity", "0.4");
            }else{
              $(`#${pos}Menu`).parent().css("pointer-events", "auto");
              $(`#${pos}Menu`).parent().css("opacity", "1");
            }   
          }

          let menuBtnCheck = $("#contentCard .menu-button").length;
          if(menuBtnCheck == 0){
            $("#menuBtnOption").css("pointer-events", "auto");
            $("#menuBtnOption").css("opacity", "1");
          }else{
            $("#menuBtnOption").css("pointer-events", "none");
            $("#menuBtnOption").css("opacity", "0.4");
          }

          let menuBtnCount = 1;

          addMoreBtn = (elem)=>{
            let menuAddElem=`<div class="menu-btns mt-3">
              <form class="row gap-3" class="menuBtnForm" id="menuBtn${menuBtnCount}">
               <div class="col-12">
                    <input type="text" class="form-control" name="btnName" placeholder="Name">
                  </div>
                  <div class="col-12">
                    <input type="text" class="form-control" name="link" placeholder="Link">
                  </div>
                </form>
                  <div class="delete-menu-btn">
                    <button type="button" onclick="deleteMenuBtn(this,'${elem}')">
                      <i class="fa-solid fa-minus"></i>
                    </button>
                  </div>
                   </div>`

            
              let formsLength = $(`#${elem}MenuList .drop-down-menu .menu-btns`).length;
              if(formsLength <= 10){
                $(`#${elem}MenuList .drop-down-menu`).append(menuAddElem);
              }else{
                $(`#${elem}AddMoreMenuBtn`).css("pointer-events", "none");
                $(`#${elem}AddMoreMenuBtn`).css("opacity", "0.4");
              }  
            menuBtnCount+=1;
        
          }
          
          deleteMenuBtn = (elem,position)=>{
            $(elem).closest('.menu-btns').remove();
            $(`#${position}AddMoreMenuBtn`).css("pointer-events", "auto");
            $(`#${position}AddMoreMenuBtn`).css("opacity", "1");
          }

          changeToRichtext([`popupText`])
          changeToRichtext([`popupTextTwo`])

          $(`input[name=buttonType][value=${btnPopup}]`).prop("checked", true);
          if (btnPopup === "button") {
            $("#popupDiv").css("display", "none");
            $("#linkDiv").css("display", "block");
          } else if (btnPopup === "popup") {
            $("#linkDiv").css("display", "none");
            $("#popupDiv").css("display", "block");
          }

          var linkBtnOption = document.getElementById('linkBtn');
          var imageBtnOption = document.getElementById('imageBtn');
          var pdfBtnOption = document.getElementById('pdfBtn');
          var textBtnOption = document.getElementById('textBtn');

          //Button Two
          var linkBtnOptionTwo = document.getElementById('linkBtnTwo');
          var imageBtnOptionTwo = document.getElementById('imageBtnTwo');
          var pdfBtnOptionTwo = document.getElementById('pdfBtnTwo');
          var textBtnOptionTwo = document.getElementById('textBtnTwo');

          linkBtnOption.onclick = popupChangeFn;
          imageBtnOption.onclick = popupChangeFn;
          pdfBtnOption.onclick = popupChangeFn;
          textBtnOption.onclick = popupChangeFn;

          //Button Two
          linkBtnOptionTwo.onclick = popupChangeFnTwo;
          imageBtnOptionTwo.onclick = popupChangeFnTwo;
          pdfBtnOptionTwo.onclick = popupChangeFnTwo;
          textBtnOptionTwo.onclick = popupChangeFnTwo;

          var linkDiv = $("#linkUpload")
          var imageDiv = $("#imageUpload")
          var pdfDiv = $("#pdfUpload")
          var textDiv = $("#textUpload")
          var uploadDiv = $(".uploadDiv")


          //Button Two
          var linkDivTwo = $("#linkUploadTwo")
          var imageDivTwo = $("#imageUploadTwo")
          var pdfDivTwo = $("#pdfUploadTwo")
          var textDivTwo = $("#textUploadTwo")
          var uploadDivTwo = $(".uploadDivTwo")

          //Button count
          buttonCountChange = (elem) => {
            let btnCountOption = $(elem).val();
            if (btnCountOption === "one") {
              if (btnPopup === "popup") {
                $("#linkDiv").css("display", "none");
                $("#popupDiv").css("display", "block");
              }
              $("#secondBtnDiv").css("display", "none");
              $("#firstBtnDiv").css("display", "flex");
              $("#menuBtnsDiv").css("display", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocation][value=header]`).parent().css("opacity", "1");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("opacity", "1");
            } else if(btnCountOption === "two") {
              $("#secondBtnDiv").css("display", "flex");
              $("#firstBtnDiv").css("display", "flex");
              $("#menuBtnsDiv").css("display", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocation][value=body]`).prop("checked", true);
              $(`input[name=btnLocationTwo][value=body]`).prop("checked", true);
            }else if(btnCountOption === "menu"){
              $("#firstBtnDiv").css("display", "none");
              $("#secondBtnDiv").css("display", "none");
              $("#menuBtnsDiv").css("display", "block");
              $("#popupDiv").css("display", "none");
            }
          }

          menuPositionChange=(elem)=>{
            let menuPosition = $(elem).val();
            $(".links-container").css("display","none");
            if(menuPosition === "left"){
              $("#leftMenuList").css("display","block");
            }else if(menuPosition === "center"){
              $("#centerMenuList").css("display","block");
            }else if(menuPosition === "right"){
             $("#rightMenuList").css("display","block");
            }
          }

          MenuTypeChange = (elem,position)=>{
            let menuType = $(elem).val();
            $(`#${position}MenuList .menu-value-fields`).css("display","none");
            if(menuType === "link"){
              $(`#${position}MenuList .link-menu`).css("display","block");
            }else if(menuType === "dropDown"){
              $(`#${position}MenuList .drop-down-menu`).css("display","block");
            }
          }

          function popupChangeFn() {
            let popupType = $('input[name="popupType"]:checked').val()
            $(".popup-error").remove();
            uploadDiv.css("display", "none")
            if (popupType === "link") {
              linkDiv.css("display", "block")
            } else if (popupType === "image") {
              imageDiv.css("display", "flex")
            } else if (popupType === "pdf") {
              pdfDiv.css("display", "block")
            } else if (popupType === "text") {
              textDiv.css("display", "block");
            }
          }

          //Button Two
          function popupChangeFnTwo() {
            let popupTypeTwo = $('input[name="popupTypeTwo"]:checked').val()
            $(".popup-error").remove();
            uploadDivTwo.css("display", "none")
            if (popupTypeTwo === "link") {
              linkDivTwo.css("display", "block")
            } else if (popupTypeTwo === "image") {
              imageDivTwo.css("display", "flex")
            } else if (popupTypeTwo === "pdf") {
              pdfDivTwo.css("display", "block")
            } else if (popupTypeTwo === "text") {
              textDivTwo.css("display", "block")
            }
          }

          buttonTypeChange = (elem) => {
            let buttonOption = $(elem).val();
            if (buttonOption === "link") {
              $("#popupDiv").css("display", "none");
              $("#linkDiv").css("display", "block");
            } else if (buttonOption === "popup") {
              $("#linkDiv").css("display", "none");
              $("#popupDiv").css("display", "block");
            }
          }


          //Button Two
          buttonTypeChangeTwo = (elem) => {
            let buttonOptionTwo = $(elem).val();
            if (buttonOptionTwo === "link") {
              $("#popupDivTwo").css("display", "none");
              $("#linkDivTwo").css("display", "block");
            } else if (buttonOptionTwo === "popup") {
              $("#linkDivTwo").css("display", "none");
              $("#popupDivTwo").css("display", "block");
            }
          }


          const pdfBtn = document.getElementById('pdfFile');
          const pdfChosen = document.getElementById('pdfChosen');
          pdfBtn.addEventListener('change', function () {
            pdfChosen.textContent = this.files[0].name;
            popupPdf = this.files[0];
          })

          //Button Two
          const pdfBtnTwo = document.getElementById('pdfFileTwo');
          const pdfChosenTwo = document.getElementById('pdfChosenTwo');
          pdfBtnTwo.addEventListener('change', function () {
            pdfChosenTwo.textContent = this.files[0].name;
            popupPdfTwo = this.files[0];
          })

          const imageBtn = document.getElementById('imageFile');
          const imageChosen = document.getElementById('imageChosen');
          imageBtn.addEventListener('change', function () {
            $("#imageUpload #previewDiv").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImg" />`);
            popupImage = this.files[0];
          })

          //Button Two
          const imageBtnTwo = document.getElementById('imageFileTwo');
          const imageChosenTwo = document.getElementById('imageChosenTwo');
          imageBtnTwo.addEventListener('change', function () {
            $("#imageUploadTwo #previewDivTwo").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImgTwo" />`);
            popupImageTwo = this.files[0];
          })

          let inputCount = 1;

          //Button Two
          let inputCountTwo = 1;

          $("#addInputFieldButton").click(function () {
            var input = $(`<form class="input-div"> 
                          <div class="links">
                            <input type='text' class="form-control" name='name' placeholder="Name">
                            <input type='text' class="form-control" name='link' placeholder="Link">
                          </div>
                          <div class="btn-div">
                            <button type="button" class="delete-btn" onClick="deleteInput(this)"><i class="fa-solid fa-xmark"></i></button>
                          </div>
                        </form>`);
            $("#linkForm").append(input);
            inputCount += 1;
          });

          deleteInput = (elem) => {
            $(elem).closest('form').remove();
          }

          //Button Two
          $("#addInputFieldButtonTwo").click(function () {
            var input = $(`<form class="input-div"> 
                            <div class="links">
                              <input type='text' class="form-control" name='name' placeholder="Name">
                              <input type='text' class="form-control" name='link' placeholder="Link">
                            </div>
                            <div class="btn-div">
                              <button type="button" class="delete-btn" onClick="deleteInputTwo(this)"><i class="fa-solid fa-xmark"></i></button>
                            </div>
                          </form>`);
            $("#linkFormTwo").append(input);
            inputCountTwo += 1;
          });

          //Button Two 
          deleteInputTwo = (elem) => {
            $(elem).closest('form').remove();
          }

        }
        else if (element === "imageLink") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image with Link"
          modalTitle.className = ""
          var modalBody = document.getElementById('pageContent')

          let linkInput = `<input class="form-control linkInput" type="text" id="imgLinkField" onkeyup="validateValue(this)" placeholder="Enter link">`


          let imgLinkContainer = `<div class="container col-md-12 mt-3">
          <div class="mb-3">
                <input class="form-control" type="file" id="formFile" accept="image/png, image/jpeg" hidden />
                <label class="file-choose-label" for="formFile">Choose Image</label>
                <span id="imageLinkChosen">No image chosen</span> 
            </div>
            <img id="linkImage" src="" class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `imgLink${imgLinkId}`

          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          validateValue = (elem) => {
            let linkInputElem = $(elem).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = ValidateUrlExp.test(linkInputElem)
            if (linkUrlValidate === false) {
              if ($(".link-error").length === 0) {
                $(elem).after('<p class="error link-error mt-0">Please enter the valid URL..!</p>')
              }
            } else {
              $(".link-error").remove()
            }
          }

          let imgInputId = document.getElementById("formFile")
          let imgDiv = document.getElementById("linkImage")


          let files;

          imgInputId.addEventListener("change", () => {
            files = event.target.files[0];
            $("#imageLinkChosen").text(files.name);
            imgDiv.src = URL.createObjectURL(files);
            imgLinkContainerArray[`imgLink${imgLinkId}`] = { image: files }
            tempArray[`imgLink${imgLinkId}`] = { type: "9", image: files }
          })

        }
        else if (element === "hyperLink") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image(s) with Caption & Link"
          modalTitle.className = ""
          var modalBody = $("#pageContent")

          var formContent =
            `<form class="hyperLinkForm" id="hyperLink_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">

                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file"  id="hyperImgInput0_id" onchange="imgOnchangeFn(event)" accept="image/png, image/jpeg" hidden />
                    <label class="file-choose-label" for="hyperImgInput0_id">Choose Image</label>
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput0">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInput0" name="caption" />
                <input class="inputItem form-control mt-2" type="text" name="link" placeholder="link" />
              </div>
              <div class="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addInputs()">+</button>
              </div> 
            </div>
          </form>`

          let typeOption = `<fieldset class="row mt-2">
            <legend class="col-form-label col-4 pt-0">Visible Type:</legend>
            <div class="col-8">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkType" id="hyperNormal" value="normal" checked>
                <label class="form-check-label" for="hyperNormal">
                  Normal
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkType" id="stampCard" value="stampcard">
                <label class="form-check-label" for="stampCard">
                  Stamp Card
                </label>
              </div>
            </div>
          </fieldset>`

          let mainContainer = document.createElement("div")
          mainContainer.className = 'hyperLinkModalDiv'
          mainContainer.id = `modal_hyperLink${hyperLinkId}`
          mainContainer.innerHTML = typeOption;
          mainContainer.innerHTML += formContent;

          modalBody.append(mainContainer)

          var i = 0;
          var length;

          addInputs = () => {

            i++;

            let addContent = `<form  class="hyperLinkForm"id="hyperLink_form${i}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${i}">
              <div class="formDiv">

                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" id="hyperImgInput${i}_id" onchange="imgOnchangeFn(event)" accept="image/png, image/jpeg" hidden />
                    <label class="file-choose-label" for="hyperImgInput${i}_id">Choose Image</label>
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput${i}">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" name="caption" id="captionInput${i}" />
                <input class="inputItem form-control mt-2" type="text" name="link" placeholder="link" />
              </div>
              <div>
                <button type="button" class="btn btn-danger" name="remove" id="${i}" onClick="removeInputs(this)">X</button>
              </div> 
            </div> </form>`

            $(".hyperLinkModalDiv").append(addContent)

            changeToRichtext([`captionInput${i}`])

          }

          removeInputs = (e) => {

            var button_id = e.id
            $('#hyperLink_form' + button_id).remove();
          }

          changeToRichtext([`captionInput0`])

          imgOnchangeFn = (event) => {
            let linkid = event.target.id
            let linkDivId = linkid.split("_")[0]
            let imgDiv = document.getElementById(linkDivId)

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }
        }
        else if (element === "updates") {
          $('#createModal').modal('show');
          $("#pageTitle").html("Add Accordion")
          var modalBody = $("#pageContent")

          let updatesElem = `
            <input type="text" class="form-control" placeholder="Enter title" id="updatesHeading" />
            <div class="bgDiv">
              <input type="color" id="bgColor" class="updatesBgColor form-control form-control-color" value="#f2f2f2" />
              <label for="bgColor" class="form-check-label">Background Color</label>
            </div>
            
            <div class="mb-3 form-check">
              <label for="show" class="form-check-label">Show</label>
              <input type="checkbox" class="form-check-input" id="show" name="show" value="show" />
            </div>
          `
          let mainContainer = document.createElement("div")
          mainContainer.className = 'updatesDiv'
          mainContainer.id = `updatesDivContainer${updatesId}_modal`
          mainContainer.innerHTML = updatesElem

          modalBody.append(mainContainer)
          changeToRichtext([`updatesHeading`])
        }
        else if(element === "linkPopup"){
          $('#createModal').modal('show');
          linkPopupImage="";
          linkPopupText="";
          linkChildElem=[];
          linkPopupText=getSelectedText();
          if(linkPopupText !== ""){
            linkRange = window.getSelection().getRangeAt(0);
            let childElems=linkRange['commonAncestorContainer']['childNodes']
            for(let i= 0; i<childElems.length;i++){
              linkChildElem.push(childElems[i].nodeName);
            }
            selectedElem =window.getSelection()['focusNode']['parentNode'];
            popupLinkElem= selectedElem.closest('.description');
          }
         
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Link Popup"
          modalTitle.className = ""
          var modalBody = document.getElementById('pageContent');
          let linkDiv = `<div class="linkPopupDiv">
                          <p class="link-text-error" style="display:none">Select the correct text.</p>
                            <div class="imgUploadDiv">
                              
                              <div>
                                <input type="file" name="" id="linkPopupImage" value="" onchange="linkImageOnchange(this)" accept="image/png, image/jpeg" hidden />
                                <label class="file-choose-label" for="linkPopupImage" class="col-2">Choose Image</label>
                              </div>
                              <div id="linkImgDiv"></div>
                            </div>
                            <div>
                              <input type="text" id="linkPopupDesc" name="" value="" />
                            </div>
                        </div>`

            let noSelectElem = `<div class="linkPopupDiv" id="no-select">
                            Text is not selected.
                        </div>`
            if(linkPopupText === ""){
              $("#pageContent").html(noSelectElem);
            }else{
              $("#pageContent").html(linkDiv);
              changeToRichtext([`linkPopupDesc`])
            }
          

          linkImageOnchange = (elem)=>{
            linkPopupImage = elem.files[0];
            $("#linkImgDiv").html(`<img src="${URL.createObjectURL(elem.files[0])}" alt=""><span class="img-del-btn" onclick="linkImageDel()">x</span>`)
          }

          linkImageDel = ()=>{
            linkPopupImage = "";
            $("#linkImgDiv").html("");
          }
          
        }
        const errorsModal = document.querySelectorAll('.error');

        errorsModal.forEach(error => {
          error.remove();
        });
      }


      function showUpdatesModal(element, updatesDivBox, btnPopup) {

        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let updatesDivClass = updatesDivBox.className.split(" ")[1].split("_")[0]

        let updatesIdCount = updatesDivClass.split("").pop()

        document.getElementById("pageContent").innerHTML = ""
        if (element === "heading") {

          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Header Band"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('input')
          input.id = "headingId" + headingDivId
          input.className = "form-control headingClass"
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="colorPickerId" value="${pageBgColor}">
          </div>`
          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"

          mainDiv.innerHTML = colorPick
          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)
          changeToRichtext([`headingId${headingDivId}`])
        }
        else if (element === "description") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Description"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('textarea')
          input.id = "headingDescId" + headingDescId
          input.className = "form-control headingDescClass"


          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descColorPicker" value="${pageBgColor}">
          </div>`

          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"
          mainDiv.innerHTML = colorPick

          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)

          changeToRichtext([`headingDescId${headingDescId}`])

        }
        else if (element === "image") {
          $('#createModal').modal('show');
          $("#imgErrorMsg").remove();
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image and Carousel"
          modalTitle.className = `${updatesDivClass}_modal`


          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgCard"
          //
          cardDiv.id = `imgContainerDiv${imageContainerId}`
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <fieldset class="row mb-3">
                    <legend class="col-form-label col-sm-4 pt-0">Images View</legend>
                    <div class="col-sm-8">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageView" value="normal" id="normal" checked>
                        <label class="form-check-label" for="normal">
                          Normal
                        </label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageView" value="carousel" id="carousel">
                        <label class="form-check-label" for="carousel">
                          Carousel
                        </label>
                      </div>
                    </div>
                  </fieldset>
                  <form action="" method="post" class="dragover">
                      <input name="file" type="file" class="file" id="imgInput" multiple accept="image/png, image/jpeg" onchange="imageonChange(this)" hidden />
                      <label for="imgInput">Choose Image</label>
                      <span id="imageChosen">No image chosen</span>
                  </form>
                  <div class="imgContainer">
                  </div>

                  <div id="bgColorDiv" class="row gap-2" style="display:none">
                    <div class="col-12">
                      <div class="row align-items-center">
                        <label for="arrowBgColor" class="form-label col-6">Arrow Background Color</label>
                        <div class="col-4">
                          <input type="color" class="form-control form-control-color" id="arrowBgColor" value="#828282">
                        </div>
                      </div>
                    </div>
                  </div>`

          modalBody.appendChild(cardDiv)

          imageTypeFn = (elem) => {
            let typeVal = $(elem).val();
            if (typeVal === "carousel") {
              $("#bgColorDiv").css("display", "flex");
            } else if (typeVal === "normal") {
              $("#bgColorDiv").css("display", "none");
            }
          }

          files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.imgContainer')
          container.id = "imgContainer" + imageContainerId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          imageonChange = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) {
                files.push(file[i])
              }

            }

            imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = { images: files, updates: `updates${updatesIdCount}` }

            tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: files, updates: `updates${updatesIdCount}` }

            $("#imgErrorMsg").remove();

            form.reset();
            showImages();
            $("#imageChosen").css("display", "none")

          }

          showImages = () => {

            let images = '';
            files.forEach((e, i) => {
              images += `<div class="image box" draggable="true"">
                        <img src=${URL.createObjectURL(e)} alt="img" >
                       <span onclick="delImages(${i})"> &times;</span>
                    </div>`
            })
            container.innerHTML = images

          }

        }
        else if (element === "quiz") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Quiz Question"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClass"
          formDiv.id = "quizDiv" + quizId
          var options = ""
          for (let i = 0; i < 4; i++) {
            options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option${i}" placeholder="option ${i + 1}" required name="option${i}" />
                </div>`
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" />
          </div>`

          var quizDivContainer =
            `<div class="row g-3">
               <div class="col-12">
                <textarea name="quizQstn" id="question"${quizId} />
               </div>
               ${options}
               ${answerDiv}
              </div>`


          var divOne = document.createElement("div")
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          // formDiv.innerHTML = quizDivContainer

          modalBody.appendChild(formDiv)
          // CKEDITOR.replace(`question${quizId}`,{ toolbar : 'Full', toolbarLocation : 'bottom' });



        }
        else if (element === 'video') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Video"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          cardDiv.id = "videoContainer" + videoContainerId

          thumbnailImage="";
          cardDiv.innerHTML = `<div class="video-option mb-3">
                            <fieldset>
                            <legend class="col-form-label pt-0">Video Type:</legend>
                            <div class="video-option-div">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="videoType" id="videoUpload" value="upload" onchange="videoTypeChange(this)" checked>
                                <label class="form-check-label" for="videoUpload">
                                  Upload
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="videoType" id="videoLink" value="link" onchange="videoTypeChange(this)" >
                                <label class="form-check-label" for="videoLink">
                                  Link
                                </label>
                              </div>
                            </div>
                        </fieldset>
                        </div>
                <form action="" method="post" class="dragover" id="videoUploadDiv">
                  <input name="file" type="file" class="file" id="videoInputField" onchange="videoOnChange(this)" accept="video/mp4" hidden />
                  <label class="file-choose-label" for="videoInputField">Choose Video</label>
                  <span id="videoChosen">No video chosen</span>
                </form>
                <div class="video-link-container" id="videoLinkDiv" style="display:none">
                      <div class="input-div">
                        <label>Video Link:</label>
                        <div class="video-input">
                          <input class="form-control" type="text" id="videoLinkInput" onkeyup="inputVerify(this)" />
                          <p class="sub-text">(Ex:https://www.youtube.com/embed/video_id)</p>
                        </div>
                      </div>
                      <div class="video-thumbnail-container">
                        <p>Thumbnail:</p>
                        <div class="thumbnail-input">
                          <label class="file-choose-label" for="videoThumbnail">Choose Image</label>
                          <input type="file" id="videoThumbnail" onchange="videoThumbChange(this)" accept="image/png, image/jpeg" hidden />
                        </div>
                        <div id="thumbnailImageDiv"></div>
                      </div>
                    </div>
                <div class="videoModalContainer"></div>`


          modalBody.appendChild(cardDiv)
          $(".video-link-error").remove();

          inputVerify = (e)=>{
            let videoLink= $(e).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)

            $(".video-link-error").remove();
            if(linkUrlValidate === false){
              $(e).after('<p class="error video-link-error">Please enter the valid URL.</p>')
            }else{
              $(".video-link-error").remove();
            }
          }

          videoTypeChange = (elem)=>{
            let videoTypeOption = $(elem).val();
            if(videoTypeOption === "upload"){
              $("#videoUploadDiv").css("display","flex");
              $("#videoLinkDiv").css("display","none");
            }else{
              $("#videoUploadDiv").css("display","none");
              $("#videoLinkDiv").css("display","flex");
              $(".videoModalContainer").html("");
            }
          }

          videoThumbChange = (elem)=>{
            $(".thumbnail-error").remove();
            let sizeInMb = elem.files[0].size / (1024 * 1024);
            if(sizeInMb < 5){
              thumbnailImage = elem.files[0];
              $("#thumbnailImageDiv").html(`<img src="${URL.createObjectURL(thumbnailImage)}" />`);
            }else{
              $(elem).after('<p class="error thumbnail-error">Image should be less than 5MB.</p>');
            }
          }


          const maxAllowedSize = 10 * 1024 * 1024;

          let files = "",
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainer')
          //
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          videoOnChange = (elem) => {
            $(".video-error").remove();
            files = elem.files[0];

            if (files.size < maxAllowedSize) {

              videoContainerArrary[`DivvideoContainer${videoContainerId}`] = { files, updates: `updates${updatesIdCount}` }
              tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: files, updates: `updates${updatesIdCount}` }
              form.reset();
              showVideos();
              $("#videoChosen").css("display", "none")
            } else {
              container.insertAdjacentHTML('afterend', '<p style="color:red" class="video-error">Maximum video size is 10MB</p>');
            }
          }

          const showVideos = () => {
            let videos = `<div class="video" id="videoId" draggable="true">
                      <video src=${URL.createObjectURL(files)} alt="video" />
                      <span onclick="delVideos()">&times;</span>
                  </div>`
            container.innerHTML = videos

          }


          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          videoTempId = videoContainerId;

        }
        else if (element === "animation") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Gif Animation"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = "animationsDiv" + animationId
          cardDiv.innerHTML = `<div class="top">
                </div>
                <form action="" method="post" class="dragover">
                    <input name="file" type="file" class="file" id="animationInput" multiple accept="image/gif" onchange="animationonChange(this)" hidden />
                    <label class="file-choose-label" for="animationInput">Choose GIF</label>
                    <span id="animationChosen">No GIF chosen</span>
                </form>
                <div class="animationContainer">
                </div>`

          modalBody.appendChild(cardDiv)

          let files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationContainer')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          animationonChange = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) files.push(file[i])
            }
            animationContainerArray[`animationsDiv${animationId}`] = { files, updates: `updates${updatesIdCount}` }

            // animation data

            tempArray[`animationsDiv${animationId}`] = { type: "6", animations: files, updates: `updates${updatesIdCount}` }

            form.reset();
            showAnimations();
            $("#animationChosen").css("display", "none")
          }

          const showAnimations = () => {
            let animations = '';
            files.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                      <img src=${URL.createObjectURL(e)} alt="animation">
                      <span onclick="delAnimations(${i})">&times;</span>
                  </div>`
            })
            container.innerHTML = animations

          }

          delAnimations = (index) => {
            files.splice(index, 1)
            showAnimations()
          }

        }
        else if (element === "pageTitle") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")

          modalTitle.innerText = "Add Page Title & Color"
          var modalBody = document.getElementById('pageContent')
          var pageTitle = ` <div class="col-md-12">
              <input type="text" class="form-control" id="pageTitleField">
            </div>
            <div class="col-md-6">
              <label for="colorId" class="form-label">Color</label>
              <input type="text" class="form-control" id="colorId" value="#fcfcfc">
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose Color</label>
              <input type="color" class="form-control form-control-color" id="colorPickerId" value="#fcfcfc">
            </div>`

          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          parentDiv.innerHTML = pageTitle
          modalBody.appendChild(parentDiv)

          var colorPickerField = document.getElementById("colorPickerId")
          let colorInputField = document.getElementById("colorId")

          colorPickerField.addEventListener("change", (event) => {
            colorInputField.value = colorPickerField.value
          });

          changeToRichtext([`pageTitleField`])


        }
        else if (element === 'button') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle");
          modalTitle.innerText = btnPopup === "button" ? "Button with Link" : "Button with popup [Text, Image, PDF, Link]";
          modalTitle.className = `${updatesDivClass}_modal`
          var modalBody = document.getElementById('pageContent');
          popupPdf = "";
          popupImage = "";

          popupPdfTwo = "";
          popupImageTwo = "";

          let buttonInput = `<div class="row gap-2 pb-3">
            <div class="col-12">
              <fieldset class="row">
                <legend class="col-form-label col-4 pt-0">Buttons:</legend>
                <div class="col-8">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonCount" id="one" value="one" onchange="buttonCountChange(this)" checked>
                    <label class="form-check-label" for="one">
                      Single
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonCount" id="two" value="two" onchange="buttonCountChange(this)" >
                    <label class="form-check-label" for="two">
                      Double
                    </label>
                  </div>
                </div>
            </fieldset>
          </div>
                  <div class="gap-3 flex-column" id="firstBtnDiv" style="display:flex">
                        <div class="col-12">
                          <fieldset class="row">
                            <legend class="col-form-label col-4 pt-0">Button Type:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="buttonType" id="link" value="link" onchange="buttonTypeChange(this)" checked>
                                <label class="form-check-label" for="link">
                                  Link
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="buttonType" id="popup" value="popup" onchange="buttonTypeChange(this)" >
                                <label class="form-check-label" for="popup">
                                  Popup
                                </label>
                              </div>
                            </div>
                        </fieldset>
                      </div>
              
                    <div class="col-12">
                      <input type="text" class="form-control" id="btnName" placeholder="Name">
                    </div>
                    <div class="col-12" id="linkDiv" style="display:block">
                      <input type="text" class="form-control" id="btnLinkId" placeholder="Link">
                    </div>
                    <div class="col-12">
                      <div class="row align-items-center">
                      <label for="colorPickerId" class="form-label col-6">Choose background Color</label>
                      <div class="col-4">
                        <input type="color" class="form-control form-control-color" id="btnColorPicker" value="#b3b3b3">
                      </div>
                    </div>
                    </div>
                    <div class="col-12">
                      <fieldset class="row mb-2 mt-2">
                        <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
                        <div class="col-sm-10">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="left" value="left">
                            <label class="form-check-label" for="left">
                              Left
                            </label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="center" value="center" checked>
                            <label class="form-check-label" for="center">
                              Center
                            </label>
                          </div>

                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="btnPosition" id="right" value="right">
                            <label class="form-check-label" for="right">
                              Right
                            </label>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                  </div>
                  <div id="popupDiv" style="display:none">
                  <fieldset class="row mb-2 mt-2">
                    <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
                    <div class="col-sm-10">
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="btnLocation" id="header" value="header" checked>
                        <label class="form-check-label" for="header">
                          Header
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="btnLocation" id="body" value="body">
                        <label class="form-check-label" for="body">
                          Body
                        </label>
                      </div>
                    </div>
                  </fieldset>

         
                  <fieldset class="row mb-2 mt-2">
                    <legend class="col-form-label col-sm-2 pt-0">Content:</legend>
                    <div class="col-sm-10">
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="textBtn" value="text">
                        <label class="form-check-label" for="textBtn">
                          Text
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="imageBtn" value="image">
                        <label class="form-check-label" for="imageBtn">
                          Image
                        </label>
                      </div>
                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="pdfBtn" value="pdf">
                        <label class="form-check-label" for="pdfBtn">
                          PDF
                        </label>
                      </div>

                      <div class="form-check form-check-inline">
                        <input class="form-check-input" type="radio" name="popupType" id="linkBtn" value="link" checked>
                        <label class="form-check-label" for="linkBtn">
                          List of links
                        </label>
                      </div>
                    </div>
                  </fieldset>
                  <div class="uploadContainer">
                    <div class="uploadDiv" id="pdfUpload" style="display:none">
                      <input type="file" id="pdfFile" accept ="application/pdf" hidden/>
                      <label for="pdfFile">Choose PDF</label>
                      <span id="pdfChosen">No file chosen</span>
                    </div>
                    <div class="uploadDiv" id="imageUpload" style="display:none">
                      <input type="file" id="imageFile" accept="image/png, image/jpeg" hidden/>
                      <label for="imageFile">Choose Image</label>
                      <div id="previewDiv"></div>
                    </div>
                    <div class="uploadDiv" id="linkUpload">
                      <div id="linkForm">
                        <form class="input-div">
                          <div class="links">
                            <input type='text' class="form-control" name='name' placeholder="Name">
                            <input type="text" class="form-control" name="link" placeholder="Link">
                          </div>
                          <div class="btn-div">
                            <button type="button" id="addInputFieldButton" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
                          </div>
                        </form> 
                      </div>
                    </div>
                  </div>
                </div>
        </div>  
        
</div>`

          let buttonInputTwo = `<div class="gap-4 flex-column border-top pt-3" id="secondBtnDiv" style="display:none">
  <div class="col-12">
    <fieldset class="row">
      <legend class="col-form-label col-4 pt-0">Button Type:</legend>
      <div class="col-8">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="buttonTypeTwo" id="linkTwo" value="link" onchange="buttonTypeChangeTwo(this)" checked>
          <label class="form-check-label" for="linkTwo">
            Link
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="buttonTypeTwo" id="popupTwo" value="popup" onchange="buttonTypeChangeTwo(this)" >
          <label class="form-check-label" for="popupTwo">
            Popup
          </label>
        </div>
      </div>
  </fieldset>
</div>

<div class="col-12">
  <input type="text" class="form-control" id="btnNameTwo" placeholder="Name">
</div>
<div class="col-12" id="linkDivTwo" style="display:block">
  <input type="text" class="form-control" id="btnLinkIdTwo" placeholder="Link">
</div>
<div class="col-12">
    <div class="row align-items-center">
      <label for="btnColorPickerTwo" class="form-label col-6">Choose background Color</label>
      <div class="col-4">
        <input type="color" class="form-control form-control-color" id="btnColorPickerTwo" value="#b3b3b3">
      </div>
    </div>
</div>
<div class="col-12">
  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="leftTwo" value="left">
        <label class="form-check-label" for="leftTwo">
          Left
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="centerTwo" value="center" checked>
        <label class="form-check-label" for="centerTwo">
          Center
        </label>
      </div>

      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnPositionTwo" id="rightTwo" value="right">
        <label class="form-check-label" for="rightTwo">
          Right
        </label>
      </div>
    </div>
  </fieldset>
</div>
<div id="popupDivTwo" style="display:none">
  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnLocationTwo" id="headerTwo" value="header" onchange="btnLocationChangeTwo()" checked>
        <label class="form-check-label" for="headerTwo">
          Header
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="btnLocationTwo" id="bodyTwo" value="body" onchange="btnLocationChangeTwo()">
        <label class="form-check-label" for="bodyTwo">
          Body
        </label>
      </div>
    </div>
  </fieldset>

  <fieldset class="row mb-2 mt-2">
    <legend class="col-form-label col-sm-2 pt-0">Content</legend>
    <div class="col-sm-10">
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="textBtnTwo" value="text">
        <label class="form-check-label" for="textBtnTwo">
          Text
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="imageBtnTwo" value="image">
        <label class="form-check-label" for="imageBtnTwo">
          Image
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="pdfBtnTwo" value="pdf">
        <label class="form-check-label" for="pdfBtnTwo">
          PDF
        </label>
      </div>
      <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="popupTypeTwo" id="linkBtnTwo" value="link" checked>
        <label class="form-check-label" for="linkBtnTwo">
          List of links
        </label>
      </div>
    </div>
  </fieldset>
  <div class="uploadContainer">
    <div class="uploadDivTwo" id="pdfUploadTwo" style="display:none">
      <input type="file" id="pdfFileTwo" accept ="application/pdf" hidden/>
      <label for="pdfFileTwo">Choose PDF</label>
      <span id="pdfChosenTwo">No file chosen</span>
    </div>
    <div class="uploadDivTwo" id="imageUploadTwo" style="display:none">
      <input type="file" id="imageFileTwo" accept="image/png, image/jpeg" hidden/>
      <label for="imageFileTwo">Choose Image</label>
      <div id="previewDivTwo"></div>
    </div>
    <div class="uploadDivTwo" id="textUploadTwo" style="display:none">
      <input type="text" id="popupTextTwo"/>
      <div class="popup-text-color">
        <span for="popupTextColorTwo" class="form-label">Background Color</span>
        <input type="color" class="form-control form-control-color" id="popupTextColorTwo" value="#fcfcfc">
      </div>
    </div>
    <div class="uploadDivTwo" id="linkUploadTwo">
      <div id="linkFormTwo">
        <form class="input-div">
          <div class="links">
            <input type='text' class="form-control" name='name' placeholder="Name">
            <input type="text" class="form-control" name="link" placeholder="Link">
          </div>
          <div class="btn-div">
            <button type="button" id="addInputFieldButtonTwo" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
          </div>
        </form> 
      </div>
    </div>
  </div>
  </div>
</div>  
</div>`

let menuBtnsElem = `<div class="menu-btns-conatiner" id="menuBtnsDiv" style="display:none">
  <div class="menu-btns">
    <form class="row gap-3" class="menuBtnForm" id="menuBtn0">
     <div class="col-12">
          <input type="text" class="form-control" name="btnName" placeholder="Name">
        </div>
        <div class="col-12">
          <input type="text" class="form-control" name="link" placeholder="Link">
        </div>
        <div class="col-12">
          <div class="row align-items-center">
          <label for="colorPickerId" class="form-label col-6">Background Color</label>
          <div class="col-4">
            <input type="color" class="form-control form-control-color" name="bgColor" value="#b3b3b3">
          </div>
        </div>
        </div>
        <div class="col-12">
          <fieldset class="row mb-2 mt-2">
            <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
            <div class="col-sm-10">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="menuBtnPosition" id="menuLeft0" value="left">
                <label class="form-check-label" for="menuLeft0">
                  Left
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="menuBtnPosition" id="menuCenter0" value="center" checked>
                <label class="form-check-label" for="menuCenter0">
                  Center
                </label>
              </div>

              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="menuBtnPosition" id="menuRight0" value="right">
                <label class="form-check-label" for="menuRight0">
                  Right
                </label>
              </div>
            </div>
          </fieldset>
        </div>
      </form>
        <div class="add-more-btn">
          <button type="button" onclick="addMoreBtn()">
            <i class="fa-solid fa-plus"></i>
          </button>
        </div>
         </div>
      </div>
        `


          let buttonDiv = document.createElement("div")
          buttonDiv.id = "btnLink"
          buttonDiv.className = "row g-3"

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = `btnLinkDiv${buttonId}`
          mainDiv.innerHTML = buttonInput;
          mainDiv.innerHTML += buttonInputTwo;
          mainDiv.innerHTML += menuBtnsElem;
          modalBody.appendChild(mainDiv)

          let menuBtnCount = 1;

          addMoreBtn = ()=>{
            let menuAddElem=`<div class="menu-btns mt-3">
              <form class="row gap-3" class="menuBtnForm" id="menuBtn${menuBtnCount}">
               <div class="col-12">
                    <input type="text" class="form-control" name="btnName" placeholder="Name">
                  </div>
                  <div class="col-12">
                    <input type="text" class="form-control" name="link" placeholder="Link">
                  </div>
                  <div class="col-12">
                    <div class="row align-items-center">
                    <label for="bgColor" class="form-label col-6">Background Color</label>
                    <div class="col-4">
                      <input type="color" class="form-control form-control-color" name="bgColor" value="#b3b3b3">
                    </div>
                  </div>
                  </div>
                  <div class="col-12">
                    <fieldset class="row mb-2 mt-2">
                      <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
                      <div class="col-sm-10">
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="menuBtnPosition" id="left${menuBtnCount}" value="left">
                          <label class="form-check-label" for="left${menuBtnCount}">
                            Left
                          </label>
                        </div>
                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="menuBtnPosition" id="center${menuBtnCount}" value="center" checked>
                          <label class="form-check-label" for="center${menuBtnCount}">
                            Center
                          </label>
                        </div>

                        <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="menuBtnPosition" id="right${menuBtnCount}" value="right">
                          <label class="form-check-label" for="right${menuBtnCount}">
                            Right
                          </label>
                        </div>
                      </div>
                    </fieldset>
                  </div>
                </form>
                  <div class="delete-menu-btn">
                    <button type="button" onclick="deleteMenuBtn(this)">
                      <i class="fa-solid fa-minus"></i>
                    </button>
                  </div>
                   </div>`

            let formsLength = $("#menuBtnsDiv .menu-btns").length;
            if(formsLength < 3){
              $("#menuBtnsDiv").append(menuAddElem);
            }
            menuBtnCount+=1;
        
          }

          deleteMenuBtn = (elem)=>{
            $(elem).closest('.menu-btns').remove();
          }


          changeToRichtext([`popupText`])
          changeToRichtext([`popupTextTwo`])

          $(`input[name=buttonType][value=${btnPopup}]`).prop("checked", true);
          if (btnPopup === "button") {
            $("#popupDiv").css("display", "none");
            $("#linkDiv").css("display", "block");
          } else if (btnPopup === "popup") {
            $("#linkDiv").css("display", "none");
            $("#popupDiv").css("display", "block");
          }

          var linkBtnOption = document.getElementById('linkBtn');
          var imageBtnOption = document.getElementById('imageBtn');
          var pdfBtnOption = document.getElementById('pdfBtn');
          var textBtnOption = document.getElementById('textBtn');

          //Button Two
          var linkBtnOptionTwo = document.getElementById('linkBtnTwo');
          var imageBtnOptionTwo = document.getElementById('imageBtnTwo');
          var pdfBtnOptionTwo = document.getElementById('pdfBtnTwo');
          var textBtnOptionTwo = document.getElementById('textBtnTwo');

          linkBtnOption.onclick = popupChangeFn;
          imageBtnOption.onclick = popupChangeFn;
          pdfBtnOption.onclick = popupChangeFn;
          textBtnOption.onclick = popupChangeFn;

          //Button Two
          linkBtnOptionTwo.onclick = popupChangeFnTwo;
          imageBtnOptionTwo.onclick = popupChangeFnTwo;
          pdfBtnOptionTwo.onclick = popupChangeFnTwo;
          textBtnOptionTwo.onclick = popupChangeFnTwo;


          var linkDiv = $("#linkUpload")
          var imageDiv = $("#imageUpload")
          var pdfDiv = $("#pdfUpload")
          var textDiv = $("#textUpload")
          var uploadDiv = $(".uploadDiv")


          //Button Two
          var linkDivTwo = $("#linkUploadTwo")
          var imageDivTwo = $("#imageUploadTwo")
          var pdfDivTwo = $("#pdfUploadTwo")
          var textDivTwo = $("#textUploadTwo")
          var uploadDivTwo = $(".uploadDivTwo")

          //Button count
          buttonCountChange = (elem) => {
            let btnCountOption = $(elem).val();
            if (btnCountOption === "one") {
              if (btnPopup === "popup") {
                $("#linkDiv").css("display", "none");
                $("#popupDiv").css("display", "block");
              }
              $("#secondBtnDiv").css("display", "none");
              $("#firstBtnDiv").css("display", "flex");
              $("#menuBtnsDiv").css("display", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocation][value=header]`).parent().css("opacity", "1");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("opacity", "1");
            } else if(btnCountOption === "two") {
              $("#secondBtnDiv").css("display", "flex");
              $("#firstBtnDiv").css("display", "flex");
              $("#menuBtnsDiv").css("display", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocation][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocationTwo][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocation][value=body]`).prop("checked", true);
              $(`input[name=btnLocationTwo][value=body]`).prop("checked", true);
            }else if(btnCountOption === "menu"){
              $("#firstBtnDiv").css("display", "none");
              $("#secondBtnDiv").css("display", "none");
              $("#menuBtnsDiv").css("display", "block");
              $("#popupDiv").css("display", "none");
            }
          }

          function popupChangeFn() {
            let popupType = $('input[name="popupType"]:checked').val()
            $(".popup-error").remove();
            uploadDiv.css("display", "none")
            if (popupType === "link") {
              linkDiv.css("display", "block")
            } else if (popupType === "image") {
              imageDiv.css("display", "flex")
            } else if (popupType === "pdf") {
              pdfDiv.css("display", "block")
            } else if (popupType === "text") {
              textDiv.css("display", "block");
            }
          }

          //Button Two
          function popupChangeFnTwo() {
            let popupTypeTwo = $('input[name="popupTypeTwo"]:checked').val()
            $(".popup-error").remove();
            uploadDivTwo.css("display", "none")
            if (popupTypeTwo === "link") {
              linkDivTwo.css("display", "block")
            } else if (popupTypeTwo === "image") {
              imageDivTwo.css("display", "flex")
            } else if (popupTypeTwo === "pdf") {
              pdfDivTwo.css("display", "block")
            } else if (popupTypeTwo === "text") {
              textDivTwo.css("display", "block")
            }
          }

          buttonTypeChange = (elem) => {
            let buttonOption = $(elem).val();
            if (buttonOption === "link") {
              $("#popupDiv").css("display", "none");
              $("#linkDiv").css("display", "block");
            } else if (buttonOption === "popup") {
              $("#linkDiv").css("display", "none");
              $("#popupDiv").css("display", "block");
            }
          }

          //Button Two
          buttonTypeChangeTwo = (elem) => {
            let buttonOptionTwo = $(elem).val();
            if (buttonOptionTwo === "link") {
              $("#popupDivTwo").css("display", "none");
              $("#linkDivTwo").css("display", "block");
            } else if (buttonOptionTwo === "popup") {
              $("#linkDivTwo").css("display", "none");
              $("#popupDivTwo").css("display", "block");
            }
          }

          const pdfBtn = document.getElementById('pdfFile');
          const pdfChosen = document.getElementById('pdfChosen');
          pdfBtn.addEventListener('change', function () {
            pdfChosen.textContent = this.files[0].name;
            popupPdf = this.files[0];
          })

          //Button Two
          const pdfBtnTwo = document.getElementById('pdfFileTwo');
          const pdfChosenTwo = document.getElementById('pdfChosenTwo');
          pdfBtnTwo.addEventListener('change', function () {
            pdfChosenTwo.textContent = this.files[0].name;
            popupPdfTwo = this.files[0];
          })

          const imageBtn = document.getElementById('imageFile');
          const imageChosen = document.getElementById('imageChosen');
          imageBtn.addEventListener('change', function () {
            $("#imageUpload #previewDiv").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImg" />`);
            popupImage = this.files[0];
          })

          //Button Two
          const imageBtnTwo = document.getElementById('imageFileTwo');
          const imageChosenTwo = document.getElementById('imageChosenTwo');
          imageBtnTwo.addEventListener('change', function () {
            $("#imageUploadTwo #previewDivTwo").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImgTwo" />`);
            popupImageTwo = this.files[0];
          })

          let inputCount = 1;

          //Button Two
          let inputCountTwo = 1;

          $("#addInputFieldButton").click(function () {
            var input = $(`<form class="input-div"> 
                          <div class="links">
                            <input type='text' class="form-control" name='name' placeholder="Name">
                            <input type='text' class="form-control" name='link' placeholder="Link">
                          </div>
                          <div class="btn-div">
                            <button type="button" class="delete-btn" onClick="deleteInput(this)"><i class="fa-solid fa-xmark"></i></button>
                          </div>
                        </form>`);
            $("#linkForm").append(input);
            inputCount += 1;
          });

          deleteInput = (elem) => {
            $(elem).closest('form').remove();
          }

          //Button Two
          $("#addInputFieldButtonTwo").click(function () {
            var input = $(`<form class="input-div"> 
                          <div class="links">
                            <input type='text' class="form-control" name='name' placeholder="Name">
                            <input type='text' class="form-control" name='link' placeholder="Link">
                          </div>
                          <div class="btn-div">
                            <button type="button" class="delete-btn" onClick="deleteInputTwo(this)"><i class="fa-solid fa-xmark"></i></button>
                          </div>
                        </form>`);
            $("#linkFormTwo").append(input);
            inputCountTwo += 1;
          });

          //Button Two 
          deleteInputTwo = (elem) => {
            $(elem).closest('form').remove();
          }
        }
        else if (element === "link") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image with Link"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')

          let linkInput = `<input class="form-control linkInput" type="text" id="imgLinkField" onkeyup="validateValue(this)" placeholder="Enter link">`

          let imgLinkContainer = `<div class="container col-md-12 mt-3">
          <div class="mb-3">
            <input class="form-control" type="file" id="formFileUpdates" accept="image/png, image/jpeg" hidden />
            <label class="file-choose-label" for="formFileUpdates">Choose Image</label>
            <span id="imageLinkChosen">No image chosen</span>
            </div>
            <img id="linkImage" src="" class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `imgLink${imgLinkId}`

          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          validateValue = (elem) => {
            let linkInputElem = $(elem).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = ValidateUrlExp.test(linkInputElem)
            if (linkUrlValidate === false) {
              if ($(".link-error").length === 0) {
                $(elem).after('<p class="error link-error mt-0">Please enter the valid URL..!</p>')
              }
            } else {
              $(".link-error").remove()
            }
          }

          let imgInputId = document.getElementById("formFileUpdates")
          let imgDiv = document.getElementById("linkImage")

          let linkInputElem = document.getElementById("imgLinkField")

          let files;

          imgInputId.addEventListener("change", () => {

            files = event.target.files[0];
            $("#imageLinkChosen").text(files.name)
            imgDiv.src = URL.createObjectURL(files);
            imgLinkContainerArray[`imgLink${imgLinkId}`] = { image: files, updates: `updates${updatesIdCount}` }
            tempArray[`imgLink${imgLinkId}`] = { type: "9", image: files, updates: `updates${updatesIdCount}` }

          })

          linkInputElem.addEventListener("change", () => {
            imgLinkContainerArray[`imgLink${imgLinkId}`] = { image: files, updates: `updates${updatesIdCount}` }
            tempArray[`imgLink${imgLinkId}`] = { type: "9", image: files, updates: `updates${updatesIdCount}` }
          })

        }
        else if (element === "hyperLink") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Image(s) with Caption & Link"
          modalTitle.className = `${updatesDivClass}_modal`

          var modalBody = $("#pageContent")

          var formContent =
            `<form class="hyperLinkForm" id="hyperLink_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">

                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/png, image/jpeg" id="hyperImgInput0_id" onchange="imgOnchangeFn(event)" hidden />
                    <label class="file-choose-label" for="hyperImgInput0_id">Choose Image</label>
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput0">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInput0" name="caption" />
                <input class="inputItem form-control" type="text" name="link" />
              </div>
              <div classs="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addInputs()">+</button>
              </div> 
            </div>

          </form>`

          let typeOption = `<fieldset class="row mt-2">
            <legend class="col-form-label col-4 pt-0">Visible Type:</legend>
            <div class="col-8">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkType" id="hyperNormal" value="normal" checked>
                <label class="form-check-label" for="hyperNormal">
                  Normal
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkType" id="stampCard" value="stampcard">
                <label class="form-check-label" for="stampCard">
                  Stamp Card
                </label>
              </div>
            </div>
          </fieldset>`


          let mainContainer = document.createElement("div")
          mainContainer.className = 'hyperLinkModalDiv'
          mainContainer.id = `modal_hyperLink${hyperLinkId}`
          mainContainer.innerHTML = typeOption
          mainContainer.innerHTML += formContent

          modalBody.append(mainContainer)

          var i = 0;
          var length;

          addInputs = () => {

            i++;

            let addContent = `<form class="hyperLinkForm" id="hyperLink_form${i}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${i}">
              <div class="formDiv">

                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" id="hyperImgInput${i}_id" onchange="imgOnchangeFn(event)" accept="image/png, image/jpeg" hidden />
                    <label class="file-choose-label" for="hyperImgInput${i}_id">Choose Image</label>
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput${i}">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" name="caption" id="captionInput${i}" />
                <input class="inputItem form-control" type="text" name="link" />
              </div>
              <div>
                <button type="button" class="btn btn-danger" name="remove" id="${i}" onClick="removeInputs(this)">X</button>
              </div> 
            </div> </form>`

            $(".hyperLinkModalDiv").append(addContent)

            changeToRichtext([`captionInput${i}`])

          }

          removeInputs = (e) => {

            var button_id = e.id
            $('#hyperLink_form' + button_id).remove();
          }

          changeToRichtext([`captionInput0`])

          imgOnchangeFn = (event) => {
            let linkid = event.target.id
            let linkDivId = linkid.split("_")[0]
            let imgDiv = document.getElementById(linkDivId)

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }
        }
        
        else if(element === "linkPopup"){
          $('#createModal').modal('show');
          linkPopupImage="";
          linkPopupText="";
          linkChildElem=[];
          linkPopupText=getSelectedText();
          if(linkPopupText !== ""){
            linkRange = window.getSelection().getRangeAt(0);
            let childElems=linkRange['commonAncestorContainer']['childNodes']
            for(let i= 0; i<childElems.length;i++){
              linkChildElem.push(childElems[i].nodeName);
            }
            selectedElem =window.getSelection()['focusNode']['parentNode'];
            popupLinkElem= selectedElem.closest('.description');
          }
         
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Link Popup"
          modalTitle.className = `${updatesDivClass}_modal`
          var modalBody = document.getElementById('pageContent');
          let linkDiv = `<div class="linkPopupDiv">
                          <p class="link-text-error" style="display:none">Select the correct text.</p>
                            <div class="imgUploadDiv">
                              
                              <div>
                                <input type="file" name="" id="linkPopupImage" value="" onchange="linkImageOnchange(this)" accept="image/png, image/jpeg" hidden />
                                <label class="file-choose-label" for="linkPopupImage" class="col-2">Choose Image</label>
                              </div>
                              <div id="linkImgDiv"></div>
                            </div>
                            <div>
                              <input type="text" id="linkPopupDesc" name="" value="" />
                            </div>
                        </div>`

            let noSelectElem = `<div class="linkPopupDiv" id="no-select">
                            Text is not selected.
                        </div>`
            if(linkPopupText === ""){
              $("#pageContent").html(noSelectElem);
            }else{
              $("#pageContent").html(linkDiv);
              changeToRichtext([`linkPopupDesc`])
            }

          linkImageOnchange = (elem)=>{
            linkPopupImage = elem.files[0];
            $("#linkImgDiv").html(`<img src="${URL.createObjectURL(elem.files[0])}" alt=""><span class="img-del-btn" onclick="linkImageDel()">x</span>`)
          }

          linkImageDel = ()=>{
            linkPopupImage = "";
            $("#linkImgDiv").html("");
          }
          
        }
        
        const errorsModal = document.querySelectorAll('.error');

        errorsModal.forEach(error => {
          error.remove();
        });
      }




      var headingDivId = 0;


      // Delete elem

      function deleteItem(e, element) {

        let cardElem = document.getElementById("contentCard")
        let parent = e.parentNode
        let key = e.parentNode.id

        if (element === "heading") {
          delete headingArray[key]
        } else if (element === "description") {
          delete descriptionArray[key]
        }
        else if (element === "image") {
          delete imagesContainerArrar[key]
        }
        else if (element === "video") {
          delete videoContainerArrary[key]
        }
        else if (element === "quiz") {
          delete quizContainerArray[key]
        }
        else if (element === "animation") {
          delete animationContainerArray[key]
        }
        else if (element === "title") {
          delete titleArray['title']
        }
        else if (element === "button") {
          delete btnContainerArray[key]
        }
        else if (element === 'link') {
          delete imgLinkContainerArray[key]
        } else if (element === "space") {
          delete emptyPageArray[key]
        } else if (element === "hyperLink") {
          delete hyperLinkArray[key]
        }
        else if (element === "updates") {
          delete updatesArray[key]
        }

        delete tempArray[key]
        parent.remove()

        // bg color remove

        let contentDiv = document.getElementById("contentCard")

        if (cardElem.innerText == "") {
          cardElem.innerHTML = '<h3 id="emptyPage" style="opacity:0.8">Add contents to create page..!</h3>'
          submitBtnDiv.style.display = "none"
          contentDiv.style.backgroundColor = "#fcfcfc"
        }

      }


      // Add Function

      function addElement() {

        let pageTitle = document.getElementById('pageTitle').className

        var modalBody = document.getElementById('pageContent')
        var children = modalBody.children[0].value
        var contentCards = document.getElementById("contentCard")

        if (modalBody.children[0].className === "form-control headingClass") {

          var div = document.createElement('div')
          let donorCheck=$("#colorPickerId").hasClass("donor-color");
          let titleCheck = $("#contentCard #title").length;
          div.className = `heading dragDiv ${donorCheck ?"donor-class":""}`

          div.draggable = true
          div.id = "headingId" + headingDivId
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id
          clickTag.setAttribute("onclick", `editModal("editHeading",this.previousElementSibling.id,this.parentElement.id)`)

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'heading')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          var elem = document.createElement("h2")
          elem.id = "page" + modalBody.children[0].id
          elem.contentEditable = false
          elem.innerText = children
          var ckTextValue = CKEDITOR.instances[modalBody.children[0].id]?.getData()



          let bgColor = document.getElementById(`colorPickerId`)?.value

          let paraDiv = document.createElement("div")
          paraDiv.className = "headingDiv"

          pageTitle !== "" ? paraDiv.id = `heading${headingDivId}` : paraDiv.id = ""

          let paraTag = document.createElement("p")
          paraTag.id = "heading" + headingDivId
          paraTag.innerHTML = ckTextValue

          paraDiv.appendChild(paraTag)

          div.appendChild(dropImg)
          div.appendChild(paraDiv)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;
          let donorExisting= $("#contentCard .donor-class").length;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (ckTextValue !== "") {

            //  
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()

            if (pageTitle !== "") {
              updatesContent.appendChild(div)

              var numb = updatesContentId?.match(/\d/g);
              numb = numb?.join("");
              let idCount = numb
              headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor, updates: `updates${idCount}` }
              tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor, updates: `updates${idCount}` }
              let headingDiv = document.getElementById(`headingId${headingDivId}`)
              headingDiv.style.backgroundColor = `${bgColor}`
              headingDivId = headingDivId + 1;
            }
            else {
              if(donorCheck){
                if(titleCheck === 0){
                  $("#contentCard").prepend(div);
                }else{
                  $("#contentCard #title").after(div)
                }
                headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,donor:true }
                tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,donor:true }
                let headingDiv = document.getElementById(`headingId${headingDivId}`)
                headingDiv.style.backgroundColor = `${bgColor}`
                headingDivId += 1
            }else{
              contentCards.appendChild(div)
              headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
              tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
              let headingDiv = document.getElementById(`headingId${headingDivId}`)
              headingDiv.style.backgroundColor = `${bgColor}`
              headingDivId += 1
            }
            }

            submitBtnDiv.style.display = "block"

          } else {
            let inputElem = document.getElementById(`cke_headingId${headingDivId}`)
            let errorElem = document.querySelector(".error")
            let errorAll = document.querySelectorAll(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }

        else if (modalBody.children[0].className === "form-control headingDescClass") {
          var div = document.createElement('div')
          div.className = "headingDesc dragDiv"
          div.id = `descriptionDiv${headingDescId}`
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "pageHeadDesc" + modalBody.children[0].id
          clickTag.id = "headDesctag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'description')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          let elemId;
          elemId = `descriptionDiv${headingDescId}`

          clickTag.setAttribute("onclick", `editModal("editDescription",this.previousElementSibling.id,this.parentElement.id)`)

          var ckTextValue = CKEDITOR.instances[modalBody.children[0].id]?.getData()
          var elem = document.createElement("p")
          elem.className="description"
          elem.id = "Description" + headingDescId
          elem.innerHTML = ckTextValue
          div.appendChild(dropImg)
          div.appendChild(elem)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)


          let elemBgColor = document.getElementById("descColorPicker").value

          let updatesContent;
          let updatesContentId;
          let parentDivId;

          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (CKEDITOR.instances[modalBody.children[0].id]?.getData() !== "") {


            if (pageTitle !== "") {

              $('#createModal').modal('hide');

              updatesContent.appendChild(div)

              var numb = updatesContentId?.match(/\d/g);
              numb = numb?.join("");
              let idCount = numb
              document.getElementById("emptyPage")?.remove()
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor, updates: `updates${idCount}` }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor, updates: `updates${idCount}` }
              let parentElem = document.getElementById(elemId)
              parentElem.style.backgroundColor = elemBgColor
              submitBtnDiv.style.display = "block"
              var sol_math = document.getElementById(`#Description${headingDescId}`);
              MathJax.Hub.Queue(["Typeset", MathJax.Hub, sol_math]);
              headingDescId = headingDescId + 1

            } else {

              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              contentCards.appendChild(div)
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor }
              let parentElem = document.getElementById(elemId)
              parentElem.style.backgroundColor = elemBgColor
              submitBtnDiv.style.display = "block"
              var sol_math = document.getElementById(`#Description${headingDescId}`);
              MathJax.Hub.Queue(["Typeset", MathJax.Hub, sol_math]);
              headingDescId = headingDescId + 1
            }

          } else {
            let inputElem = document.getElementById(`cke_headingDescId${headingDescId}`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }


        }
        else if (modalBody.children[0].className === "imgCard") {
          let imagesView = $('input[name="imageView"]:checked').val();
          let arrowBgColor = $("#arrowBgColor").val();
          let ParentId;

          var div = document.createElement('div')
          div.className = "imageContainer dragDiv"
          div.id = modalBody.children[0].id
          div.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var imgArry;

          var imgId = modalBody.children[0].id
          var numb = imgId?.match(/\d/g);
          numb = numb?.join("");
          if (pageTitle == "") {
            imgArry = imagesContainerArrar[`${imgId}`]
          } else {
            imgArry = imagesContainerArrar[`${imgId}`]["images"];
          }

          if (imgArry === undefined) {
            if ($("#imgErrorMsg").length === 0) {
              $("#imgInput").closest('form').after('<p class="error" id="imgErrorMsg">Upload the image..!</P')
            }
          } else {
            $("#imgErrorMsg").remove();
          }

          var imgSrc = document.getElementsByClassName("image")
          var parentContainer = document.getElementsByClassName("imgContainer")
          ParentId = parentContainer[0].id

          var imgContainer = document.createElement("div")
          imgContainer.className = "imagesDiv"
          imgContainer.id = parentContainer[0].id
          imgContainer.draggable = true

          var carouselContainer = document.createElement("div")
          carouselContainer.className = "container main-margin-top"
          carouselContainer.id = parentContainer[0].id

          clickTag.setAttribute("onclick", `editModal("editImages",this.previousElementSibling.id,this.parentElement.id)`)

          let images = '';
          imgArry.forEach((e, i) => {
            images += `
                    <img src=${URL.createObjectURL(e)} alt="img">
                </div>`
          })

          let imageSlideCount = '';
          let carouselImage = '';

          imgArry.forEach((e, i) => {
            imageSlideCount += `<button type="button" data-bs-target="#carouselwithIndicators${numb}" style="background-color:${arrowBgColor}" data-bs-slide-to="${i}" aria-current="true" class="${i == 0 ? "active" : ""}" aria-label="Slide ${i}">

                                </button>`
          })

          imgArry.forEach((e, i) => {
            carouselImage += `<div class="${i == 0 ? "carousel-item active" : "carousel-item"}">
              <img src=${URL.createObjectURL(e)} class="d-block w-100" alt="${e.name}" >
            </div>`
          })

          let carouselView = `
            <div id="carouselwithIndicators${numb}" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">
              <div class="carousel-indicators">
                ${imageSlideCount}
              </div>
              <div class=" carousel-inner">
                ${carouselImage}
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#carouselwithIndicators${numb}" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
      
              <button class="carousel-control-next" type="button" data-bs-target="#carouselwithIndicators${numb}" data-bs-slide="next">
                <span class="carousel-control-next-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
          </div>`

          imgContainer.innerHTML = images
          carouselContainer.innerHTML = carouselView

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'image')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)
          var existingElement = document.getElementById(tempId)

          tempId = parentContainer[0].id;
          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (imgContainer.innerHTML !== "") {
            tempArray[`${imgId}`] = { ...tempArray[`${imgId}`], "imagesView": imagesView, "arrowBgColor": arrowBgColor }
            if (pageTitle !== "") {
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              div.appendChild(dropImg)
              if (imagesView === "carousel") {
                div.appendChild(carouselContainer)
              } else {
                div.appendChild(imgContainer)
              }
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              updatesContent.appendChild(div)
              submitBtnDiv.style.display = "block"
              imageContainerId += 1
            } else {
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()

              div.appendChild(dropImg)
              if (imagesView === "carousel") {
                div.appendChild(carouselContainer)
              } else {
                div.appendChild(imgContainer)
              }
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              contentCards.appendChild(div)
              submitBtnDiv.style.display = "block"
              imageContainerId += 1
            }

          } else {
            let inputElem = document.querySelector(".imgContainer")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert image...!</p>');
            }
          }
        }
        else if (modalBody.children[0].className === "videoCard") {

          let keyId = modalBody.children[0].id

          let videoType = $('input[name="videoType"]:checked').val();
          let videoLink=$("#videoLinkInput").val();

          var div = document.createElement('div')
          div.className = "videoContainer dragDiv"
          div.id = `Div${keyId}`
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"


          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var parentContainerVideo = document.getElementsByClassName("videoCard")
          var videoArry = [];
          var videoDIv = document.getElementById("videoId")
          var videoSrc = videoDIv?.children[0].src

          var videoLocalSrc;
          let updateName="";

          if (pageTitle !== "") {
            if(videoType === 'upload'){
              videoLocalSrc = videoContainerArrary[`Div${parentContainerVideo[0].id}`]["files"]
          }
           let updateClassName = document.querySelector('#createModal .modal-header h5').className;
           updateClassName= updateClassName.split("_")[0]
           var updateNum = updateClassName?.match(/\d/g);
           updateNum = updateNum?.join("");
            updateName = `updates${updateNum}`;
          } else {
            if(videoType === 'upload'){
              videoLocalSrc = videoContainerArrary[`Div${parentContainerVideo[0].id}`]
          }
          }

          tempArray[`Div${parentContainerVideo[0].id}`]={...tempArray[`Div${parentContainerVideo[0].id}`],videoType}

          $(".video-link-error").remove();
          $(".thumbnail-error").remove();

          let videoPopupElem="";

          if(videoType === "link"){
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)
            if(thumbnailImage ==""){
              $("#videoThumbnail").after('<p class="error thumbnail-error">Please Upload the image.</p>');
            }
            if(videoLink !== "" && linkUrlValidate){
              if(thumbnailImage !==""){
                videoPopupElem=  `<div class="video-thumbnail" onclick="videoPopupOpen(this)" id="video_Div${parentContainerVideo[0].id}">
                                        <img src="${URL.createObjectURL(thumbnailImage)}" alt="" />
                                        <span><i class="fa-regular fa-circle-play"></i></span>
                                    </div>`
              }
            }else{
              $("#videoLinkInput").after('<p class="error video-link-error">Please enter the valid URL.</p>');
            }
          }


          var videoName = videoLocalSrc?.name

          var videoContainer = document.createElement("div")
          videoContainer.className = "videosDiv"
          videoContainer.id = parentContainerVideo[0].id
          videoContainer.draggable = true
          clickTag.setAttribute("onclick", "editModal('editVideo',this.previousElementSibling.id,this.parentElement.id)")

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'video')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          // deleteTag.setAttribute("onclick","return this.parentNode.remove()")

          var existingElement = document.getElementById(videoTempId)

          let videos = '';

          videos = `<video class="video-js vjs-big-play-centered vjs-show-big-play-button-on-pause" controls  preload="auto" alt="video">
                <source src=${videoSrc} />
            </video>`

            if(videoType === "link"){
              videoContainer.innerHTML= videoPopupElem
            }else{
              videoContainer.innerHTML = videos
            }

          //
          videoTempId = parentContainerVideo[0].id;

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          let videoParentElem= document.createElement('div');
          videoParentElem.className= "videoContainer"
          videoParentElem.innerHTML=videoPopupElem;

          div.appendChild(dropImg)
          div.appendChild(videoContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)


          let inputElem = document.querySelector(".videoModalContainer")

          if(videoType === "upload"){

          if (inputElem.innerHTML !== "") {

            if (pageTitle !== "") {
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              updatesContent.appendChild(div)
            } else {
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              contentCards.appendChild(div)
            }
            submitBtnDiv.style.display = "block"
            videoContainerId += 1
          } else {
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please upload the video.</p>');
            }
          }
            
        }else{
          var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
          let linkUrlValidate = matchYoutubeUrl(videoLink)
          if(videoLink !== "" && linkUrlValidate){
            if(thumbnailImage !==""){
              submitBtnDiv.style.display = "block"
              $('#createModal').modal('hide');
              if(typeof thumbnailImage === "string"){
                thumbnailImage = [thumbnailImage]
              }else{
                thumbnailImage = thumbnailImage;
              }
              if (pageTitle !== "") {
                tempArray[`Div${parentContainerVideo[0].id}`]={...tempArray[`Div${parentContainerVideo[0].id}`],type:"5",link:videoLink,image:thumbnailImage, updates:updateName}
                updatesContent.appendChild(div)
              }else{
                tempArray[`Div${parentContainerVideo[0].id}`]={...tempArray[`Div${parentContainerVideo[0].id}`],type:"5",link:videoLink,image:thumbnailImage}
                contentCards.appendChild(div)
              }
              videoContainerId += 1
            }
          }
        }

        videoPopupOpen= (elem)=>{
          let videoData = elem.id.split("_")[1];
          let videoLinkData = tempArray[`${videoData}`].link
          let videoelem = `<iframe height="345" src="${videoLinkData}?rel=0&amp;autoplay=1" allow="autoplay">
                          </iframe>`
          $("#videoPopupModal .modal-body").html(videoelem)
          $("#videoPopupModal").modal('show')
        }
        }
        else if (modalBody.children[0].className === "formClass") {

          let animationKey = modalBody.children[0].id
          var quizDiv = document.createElement('div')
          quizDiv.className = "quizContainer dragDiv"
          quizDiv.id = animationKey
          quizDiv.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var formElem = document.getElementsByClassName("formClass");
          var quiz = [];
          for (var i = 0; i < formElem.length; ++i) {
            const data = Object.fromEntries(new FormData(formElem[i]).entries());
            quiz.push(data);
          }
          var quizData = quiz;

          const { question, answer, ...rest } = quiz[0];

          var optionsList = []
          for (var key in rest) {
            var value = rest[key];
            if (value !== "") {
              optionsList.push(value)
            }
          }
          const { option0, option1, option2, option3 } = quiz[0];

          var options = ""
          for (let i = 0; i < optionsList.length; i++) {
            options += `<label class="options">${optionsList[i]}
              <input type="radio" name="radio" value=${optionsList[i]}/>
              <span class="checkmark"></span>
          </label>`
          }

          const div = document.createElement("div")

          for (var i = 0; i < quiz.length; i++) {
            const quizHtml = `<div class="container my-1">
                <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                    <div class="py-2 h5"><b>Q. ${quiz[i].question}</b></div>
                    <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                       ${options}
                    </div>
                </div>
            </div>`


            const submitBtn = `<button type="button" class="btn btn-primary" onclick="answerSubmit()">Submit</button>`


            div.style = "text-align:start"
            div.style = "width:90%"
            div.id = `quiz${quizId}`
            div.className = "quizClass"
            div.innerHTML = quizHtml
          }

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + quizId

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)


          clickTag.setAttribute("onclick", "editModal('editQuiz',this.previousElementSibling.id,this.parentElement.id)")

          // quizContainerArray[`${quizArray}`]=quiz[0]
          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'quiz')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          quizDiv.appendChild(dropImg)
          quizDiv.appendChild(div)
          quizDiv.appendChild(clickTag)
          quizDiv.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle?.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (quiz[0].quizQstn !== "" && optionsList.length >= 2 && answer) {

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()

            if (pageTitle !== "") {
              var numb = updatesContentId?.match(/\d/g);
              numb = numb?.join("");
              let idCount = numb
              quizContainerArray[`quizDiv${quizId}`] = { quiz: quiz[0], updates: `updates${idCount}` }
              tempArray[`quizDiv${quizId}`] = { type: "7", quiz: quiz[0], updates: `updates${idCount}` }
              updatesContent.appendChild(quizDiv)
            } else {
              quizContainerArray[`quizDiv${quizId}`] = { quiz: quiz[0] }
              tempArray[`quizDiv${quizId}`] = { type: "7", quiz: quiz[0] }
              contentCards.appendChild(quizDiv)
            }
            submitBtnDiv.style.display = "block"
            quizId += 1;

          } else {
            let qstnElem = document.querySelector(`#question${quizId}`)
            let optionOneElem = document.querySelector(`#option0`)
            let optionTwoElem = document.querySelector(`#option3`)
            let answerElem = document.querySelector(`#answer`)

            let errorQstn = document.querySelector(".qstnerror")
            let errorOptn = document.querySelector(".optnerror")
            let errorAns = document.querySelector(".anserror")

            if (qstnElem.value === "") {
              if (!errorQstn) {
                qstnElem.insertAdjacentHTML('afterend', '<p class="error qstnerror">Please enter the question...!</p>');
              }

            } else {
              if (errorQstn) {
                errorQstn.remove()
              }
            }
            if (optionsList.length < 2) {
              if (!errorOptn) {
                optionTwoElem.parentElement.insertAdjacentHTML('afterend', '<p class="error optnerror">Please enter atleast two options...!</p>');
              }

            } else {
              if (errorOptn) {
                errorOptn.remove()
              }
            }
            if (!answer) {
              if (!errorAns) {
                answerElem.insertAdjacentHTML('afterend', '<p class="error anserror">Please enter the answer...!</p>');
              }
            } else {
              if (errorAns) {
                errorAns.remove()
              }
            }
          }

        }
        else if (modalBody.children[0].className === "animationCard") {

          var div = document.createElement('div')
          div.className = "animationParentContainer dragDiv"
          div.id = modalBody.children[0].id
          div.draggable = true
          var dropAnimation = document.createElement("img")
          dropAnimation.className = "dragImg"
          dropAnimation.height = 20
          dropAnimation.width = 20
          dropAnimation.src = "/assets/img/sort.png"


          var imgId = modalBody.children[0].id

          var animationArry
          if (pageTitle == "") {
            animationArry = animationContainerArray[`${imgId}`]
          } else {
            animationArry = animationContainerArray[`${imgId}`]["files"];
          }

          var animationContainer = document.createElement("div")
          animationContainer.className = "animationsDiv"
          animationContainer.id = `animations${animationId}`
          animationContainer.draggable = true
          for (let i = 0; i < animationArry.length; i++) {
            animationContainer.innerHTML = `<img src=${animationArry[i]} alt="">`
          }

          let animations = '';
          animationArry.forEach((e, i) => {
            animations += `
                    <img src=${URL.createObjectURL(e)} alt="img">
                </div>`
          })
          animationContainer.innerHTML = animations


          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          clickTag.setAttribute("onclick", "editModal('editAnimation',this.previousElementSibling.id,this.parentElement.id)")
          //  clickTag.setAttribute("onclick", `showModal("editQuiz",${parentQuizContainer[0].id})`)

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)


          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'animation')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)


          div.appendChild(dropAnimation)
          div.appendChild(animationContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (animationContainer.innerHTML !== "") {

            $('#createModal').modal('hide');

            if (pageTitle !== "") {
              updatesContent.appendChild(div)
            } else {
              contentCards.appendChild(div)
            }
            document.getElementById("emptyPage")?.remove()
            submitBtnDiv.style.display = "block"

            animationId += 1
          } else {
            let inputElem = document.querySelector(".animationContainer")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert animation...!</p>');
            }
          }

        }
        else if (modalBody.children[0].id === "pageTitleId") {
          let pageTitle = document.getElementById("pageTitleField").value
          let colorPick = document.getElementById("colorPickerId").value
          let textureType = $('input[name="textureOption"]:checked').val();
          let textureColor = $("#textureBgColor").val();
          contentCards.style.backgroundColor = colorPick

          cardbgColor = colorPick

          var dropImg = document.createElement("img")
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var emptyDiv = document.createElement("div")
          emptyDiv.style = "height,20px"
          emptyDiv.style = "width,20px"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'title')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)


          var ckTextValue = CKEDITOR.instances['pageTitleField']?.getData()

          let titleDiv = document.createElement("div")
          titleDiv.className = "titleDiv"
          titleDiv.id = "title"
          let heading = document.createElement("p")
          heading.id = "pageHeadingId"
          heading.innerHTML = ckTextValue

          titleDiv.appendChild(emptyDiv)
          titleDiv.appendChild(heading)
          titleDiv.appendChild(clickTag)
          titleDiv.appendChild(deleteTag)

          clickTag.setAttribute("onclick", `editModal("editTitle","pageHeadingId")`)

          if (ckTextValue !== "") {
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
              contentCards.insertBefore(titleDiv, contentCards.firstChild);
              pageBgColor = cardbgColor
              if(textureType === "existing"){
                $(".createPageDiv").css('background-image',`url(${pageBgImage})`);
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
            }else if(textureType === "color"){
              $(".createPageDiv").css('background-image','');
              $(".createPageDiv").css('background-color',`${textureColor}`);
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
            }else if(textureType === "new"){
              if(pageBgImage !== ""){
                $(".createPageDiv").css('background-image',`url(${URL.createObjectURL(pageBgImage)})`);
              }
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage,imageIndex:textureImageIndex+1  }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage,imageIndex:textureImageIndex+1  }
            }
            submitBtnDiv.style.display = "block"
          } else {
            let inputElem = document.getElementById("cke_pageTitleField")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }
        else if (modalBody.children[0].className === "linkBtnDiv") {
          let btnName = document.getElementById("btnName").value;
          let btnLink = document.getElementById("btnLinkId").value;
          let btnType = $('input[name="buttonType"]:checked').val();
          let btnLocation = $('input[name="btnLocation"]:checked').val();
          let btnPosition = $('input[name="btnPosition"]:checked').val();
          let popupType = $('input[name="popupType"]:checked').val();
          let btnCount = $('input[name="buttonCount"]:checked').val();
          let btnColor = $("#btnColorPicker").val();

          let popupText = CKEDITOR.instances['popupText']?.getData();
          let popupTextColor = $("#popupTextColor").val();

          //Button two
          let btnTwoName = $("#btnNameTwo").val();
          let btnTwoLink = $("#btnLinkIdTwo").val();
          let btnTypeTwo = $('input[name="buttonTypeTwo"]:checked').val();
          let btnLocationTwo = $('input[name="btnLocationTwo"]:checked').val();
          let btnPositionTwo = $('input[name="btnPositionTwo"]:checked').val();
          let popupTypeTwo = $('input[name="popupTypeTwo"]:checked').val();
          let btnColorTwo = $("#btnColorPickerTwo").val();

          let popupTextTwo = CKEDITOR.instances['popupTextTwo']?.getData();
          let popupTextColorTwo = $("#popupTextColorTwo").val();

          //Button one error handling
          var forms = document.querySelectorAll("#linkForm form");

          let hasEmptyValue = [];
          var links = [];
          let menuBtnData= [];

          let menuBgColor = "";
          let menuPosition = "";

         
          let linkFontColor = "";

          let leftMenuType = "";
          let centerMenuType = "";
          let rightMenuType = "";

          let leftMenuLabel = "";
          let centerMenuLabel = "";
          let rightMenuLabel = "";

          let leftMenuBtnData = {};
          let centerMenuBtnData = [];
          let rightMenuBtnData = [];

          let menuListData= [];

          $(".btn-error").remove();
          $(".menu-error").remove();

          let menusList=[];

          if(btnCount === "menu"){
            menuBgColor = $("#menuBgColor").val();
            menuPosition = $(`input[name="menuBtnPosition"]:checked`).val();

            linkFontColor = $("#linkFontColor").val();
            $("input[name=btnListCheck]:checked").map(function () {
               menusList.push(this.value)
             })
           menusList.forEach((m)=>{
           let leftMenuForms = "";
           let menuBtnForms = "";

           if(m==="left"){
             leftMenuType = $(`input[name="leftMenuType"]:checked`).val();
             if(leftMenuType === "link"){
               menuBtnForms = document.querySelectorAll(`#leftMenuList .link-menu form`);
             }else{
               leftMenuLabel = $("#leftDropDownName").val();
               if(leftMenuLabel === ""){
                 hasEmptyValue.push(true);
                 $("#leftDropDownName").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
               }
               menuBtnForms = document.querySelectorAll(`#leftMenuList .drop-down-menu .menu-btns form`);
             }
           }else if(m ==="center"){
             centerMenuType = $(`input[name="centerMenuType"]:checked`).val();
             if(centerMenuType === "link"){
               menuBtnForms = document.querySelectorAll(`#centerMenuList .link-menu form`);
             }else{
               centerMenuLabel = $("#centerDropDownName").val();
               if(centerMenuLabel === ""){
                 hasEmptyValue.push(true);
                 $("#centerDropDownName").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
               }
               menuBtnForms = document.querySelectorAll(`#centerMenuList .drop-down-menu .menu-btns form`);
             }
           }else if(m === "right"){
             rightMenuType = $(`input[name="rightMenuType"]:checked`).val();
             if(rightMenuType === "link"){
               menuBtnForms = document.querySelectorAll(`#rightMenuList .link-menu form`);
             }else{
               rightMenuLabel = $("#rightDropDownName").val();
               if(rightMenuLabel === ""){
                 hasEmptyValue.push(true);
                 $("#rightDropDownName").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
               } 
               menuBtnForms = document.querySelectorAll(`#rightMenuList .drop-down-menu .menu-btns form`);
             }
           } 

           menuListData= [];
             Array.from(menuBtnForms).forEach((e)=>{
               let elements = e.elements;
               let obj ={};
               for(var i = 0 ; i < elements.length ; i++){
                 var item = elements.item(i);
                 if(item.name !==""){
                   if(item.name=="link"){
                     var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                     let linkUrlValidate = ValidateUrlExp.test(item.value);
                     if(linkUrlValidate ===false){
                       $(elements[i]).after('<p class="error menu-error mt-0">Please enter the valid URL.</p>')
                       hasEmptyValue.push(true)
                     }
                   }
 
                   if(item.name === "btnName"){
                     if(item.value == ""){
                       $(elements[i]).after('<p class="error menu-error mt-0">Please enter the valid name.</p>') 
                       hasEmptyValue.push(true)
                     }
                   }
 
                   obj[item.name] = item.value;
                 }
             }
              menuListData.push(obj)
             })
             if(m === "left"){
               if(leftMenuType === "link"){
                 leftMenuBtnData = {position:"left",type:leftMenuType,links:menuListData}
               }else{
                 leftMenuBtnData = {position:"left",label:leftMenuLabel,type:leftMenuType,links:menuListData}
               }
               menuBtnData.push(leftMenuBtnData);
             }else if(m === "right"){
               if(rightMenuType === "link"){
                 rightMenuBtnData = {position:"right",type:rightMenuType,links:menuListData}
               }else{
                 rightMenuBtnData = {position:"right",label:rightMenuLabel,type:rightMenuType,links:menuListData}
               }
               menuBtnData.push(rightMenuBtnData);
             }else if(m === "center"){
               if(centerMenuType === "link"){
                 centerMenuBtnData = {position:"center",type:centerMenuType,links:menuListData}
               }else{
                 centerMenuBtnData = {position:"center",label:centerMenuLabel,type:centerMenuType,links:menuListData}
               }
               menuBtnData.push(centerMenuBtnData);
             }
             
           })
           let menuForms = document.querySelectorAll("#menuBtnsDiv .menu-btns form");
  
            }else{
              if (btnName === "") {
                $("#btnName").after('<p class="error btn-error">Please enter the button name.</p>');
                hasEmptyValue.push(true);
              } else {
                hasEmptyValue.push(false);
              }
              if (btnType === "popup") {
                if (popupType === "link") {
                  var result = Array.from(forms).map((a, i) => {
                    var obj = {};
                    Array.from(a.querySelectorAll("[name]")).forEach((b, j) => {
                      obj[b.getAttribute("name")] = b.value;
                      if (b.value === "") {
                        $(b).after(`<div class="error btn-error">Please enter the value.</div>`);
                        hasEmptyValue.push(true);
                      } else {
                        hasEmptyValue.push(false);
                      }
                    });
                    links.push(obj);
                    return links;
                  });
                } else if (popupType === "image") {
                  if (popupImage === "") {
                    $("#imageUpload").after(`<div class="error btn-error">Please upload the image.</div>`);
                    hasEmptyValue.push(true);
                  } else {
                    hasEmptyValue.push(false);
                  }
                } else if (popupType === "pdf") {
                  if (popupPdf === "") {
                    $("#pdfUpload").after(`<div class="error btn-error">Please upload the document.</div>`);
                    hasEmptyValue.push(true);
                  } else {
                    hasEmptyValue.push(false);
                  }
                } else if (popupType === "text") {
                  if (popupText === "") {
                    $("#cke_popupText").after(`<div class="error btn-error">Please enter the value.</div>`);
                    hasEmptyValue.push(true);
                  } else {
                    hasEmptyValue.push(false);
                  }
                }
              } else {
                var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                let btnLinkValidate = ValidateUrlExp.test(btnLink);
                if (btnLink === "" || btnLinkValidate === false) {
                  $("#btnLinkId").after('<p class="error btn-error">Please enter the valid URL.</p>');
                  hasEmptyValue.push(true);
                } else {
                  hasEmptyValue.push(false);
                }
              }
    
              //Button two error handling
              let formsTwo = document.querySelectorAll("#linkFormTwo form");
              var linksTwo = [];
    
              if (btnCount === "two") {
                if (btnTwoName === "") {
                  $("#btnNameTwo").after('<p class="error btn-error">Please enter button name.</p>');
                  hasEmptyValue.push(true);
                } else {
                  hasEmptyValue.push(false);
                }
    
                if (btnTypeTwo === "popup") {
                  if (popupTypeTwo === "link") {
                    var resultTwo = Array.from(formsTwo).map((a, i) => {
                      var objTwo = {};
                      Array.from(a.querySelectorAll("[name]")).forEach((b, j) => {
                        objTwo[b.getAttribute("name")] = b.value;
                        if (b.value === "") {
                          $(b).after(`<div class="error btn-error">Please enter the value.</div>`);
                          hasEmptyValue.push(true);
                        } else {
                          hasEmptyValue.push(false);
                        }
                      });
                      linksTwo.push(objTwo);
                      return linksTwo;
                    });
                  } else if (popupTypeTwo === "image") {
                    if (popupImageTwo === "") {
                      $("#imageUploadTwo").after(`<div class="error btn-error">Please upload the image.</div>`);
                      hasEmptyValue.push(true);
                    } else {
                      hasEmptyValue.push(false);
                    }
                  } else if (popupTypeTwo === "pdf") {
                    if (popupPdfTwo === "") {
                      $("#pdfUploadTwo").after(`<div class="error btn-error">Please upload the document.</div>`);
                      hasEmptyValue.push(true);
                    } else {
                      hasEmptyValue.push(false);
                    }
                  } else if (popupTypeTwo === "text") {
                    if (popupTextTwo === "") {
                      $("#cke_popupTextTwo").after(`<div class="error btn-error">Please enter the value.</div>`);
                      hasEmptyValue.push(true);
                    } else {
                      hasEmptyValue.push(false);
                    }
                  }
                } else {
                  let ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                  let btnLinkTwoValidate = ValidateUrlExp.test(btnTwoLink);
                  if (btnTwoLink === "" || btnLinkTwoValidate === false) {
                    $("#btnLinkIdTwo").after('<p class="error btn-error">Please enter the valid URL.</p>');
                    hasEmptyValue.push(true);
                  } else {
                    hasEmptyValue.push(false);
                  }
                }
              }
    
            }

          $(".btn-error").get(0)?.scrollIntoView({behavior: 'smooth'});
          $(".menu-error").get(0)?.scrollIntoView({behavior: 'smooth'});

          let parentId = modalBody.children[0].id

          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)
          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'button')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          let btnDiv = document.createElement("div");
          btnDiv.className = `btnDiv dragDiv ${btnCount == 'menu'?' menu-button':''}`;
          btnDiv.id = parentId;

          let linkDiv = document.createElement("div");
          linkDiv.className = "linkDiv";
          linkDiv.id = "btnLink" + buttonId;

          if (btnCount === "one") {
            linkDiv.style.textAlign = `${btnPosition}`;
          } else if(btnCount === "two") {
            linkDiv.style.display = "grid";
            linkDiv.style.gridTemplateColumns = "repeat(2, 1fr)";
            linkDiv.style.gap = "10px";
          }else if(btnCount === 'menu'){
            linkDiv.style.display = "flex";
            linkDiv.style.gap = "5px";
            linkDiv.style.justifyContent =  "space-between"
            linkDiv.style.backgroundColor = `${menuBgColor}`
          }

          clickTag.setAttribute("onclick", `editModal("editButton",this.previousElementSibling.id,this.parentElement.id)`)

          let btnTag="";

          if (btnCount === "two") {
            if (btnType === "link") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="${btnLink}" id="linkTag${buttonId}_0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>
                      </div>`;
            } else if (btnType === "popup") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="#" id="linkTag${buttonId}_0" class="linkBtn link_${parentId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColor}">${btnName}</a>
                      </div>`
            }

            if (btnTypeTwo === "link") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="${btnTwoLink}" id="linkTag${buttonId}_1" target="_blank" class="linkBtn" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                    </div>`;
            } else if (btnTypeTwo === "popup") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="#" id="linkTag${buttonId}_1" class="linkBtn link_${parentId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                      </div>`
            }
          } else if(btnCount === "one")  {
            if (btnType === "link") {
              btnTag = `<a href="${btnLink}" id="linkTag${buttonId}0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>`;
            } else if (btnType === "popup") {
              btnTag = `<a href="#" id="linkTag${buttonId}1" class="linkBtn link_${parentId}" onclick="openPopupModal(this)" style="background-color:${btnColor}">${btnName}</a>`;
            }
          }else if(btnCount==="menu"){
            menuBtnData.forEach((btn,i)=>{
              if(btn.type === "link"){
                btnTag += `<a href="${btn['links'][0].link}" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn['links'][0].btnName}" class="linkBtn" target="_blank" style="color:${linkFontColor}">${btn['links'][0].btnName}</a>`;
              }else{
                let linkElem ="";
                btn['links'].forEach((l)=>{
                  linkElem += `<li><a class="dropdown-item" target="_blank" href="${l.link}">${l.btnName}</a></li>`
                  })

                btnTag += `<div class="dropdown">
                   <a class="btn dropdown-toggle" href="#" role="button" id="dropdownMenuLink${i}" onclick="dropDownChange(this)" data-bs-toggle="dropdown" aria-expanded="false" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn.label}"  style="color:${linkFontColor}">
                      <span>${btn.label}</span> 
                   </a>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink${i}">
                      ${linkElem}
                    </ul>
                  </div>`
              }

            });
          }

          let buttonOneInfo;
          let buttonTwoInfo;
          let menuBtnInfo;

          if(btnCount === "menu"){
            menuBtnInfo = menuBtnData;
          }else{
          if (btnType === "link") {
            buttonOneInfo = { name: btnName, btnType, link: btnLink, btnPosition, bgColor: btnColor }
          } else {
            if (popupType === "link") {
              buttonOneInfo = { name: btnName, btnType, popupType, links, bgColor: btnColor, btnLocation, btnPosition };
            } else if (popupType === "image") {
              buttonOneInfo = { name: btnName, btnType, popupType, image: popupImage, bgColor: btnColor, btnLocation, btnPosition };
            } else if (popupType === "pdf") {
              buttonOneInfo = { name: btnName, btnType, popupType, pdf: popupPdf, bgColor: btnColor, btnLocation, btnPosition };
            } else if (popupType === "text") {
              buttonOneInfo = { name: btnName, btnType, popupType, text: popupText, textBgColor: popupTextColor, bgColor: btnColor, btnLocation, btnPosition };
            }
          }
          if (btnCount === "two") {
            if (btnTypeTwo === "link") {
              buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, link: btnTwoLink, btnPosition: btnPositionTwo, bgColor: btnColorTwo }
            } else {
              if (popupTypeTwo === "link") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, links: linksTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if (popupTypeTwo === "image") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, image: popupImageTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if (popupTypeTwo === "pdf") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, pdf: popupPdfTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if (popupTypeTwo === "text") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, text: popupTextTwo, textBgColor: popupTextColorTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              }
            }
          }
        }
          let buttons = [];

          if(btnCount === "one"){
            buttons.push(buttonOneInfo);
          }else if (btnCount === "two") {
            buttons.push(buttonOneInfo);
            buttons.push(buttonTwoInfo);
          }else{
            buttons=[...menuBtnInfo.map(obj=>obj)];
          }

          linkDiv.innerHTML = btnTag;
          let updatesContent;
          let updatesContentId;
          let parentDivId;

          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          var numb = updatesContentId?.match(/\d/g);
          numb = numb?.join("");
          let idCount = numb;

          btnDiv.appendChild(dropImg)
          btnDiv.appendChild(linkDiv)
          btnDiv.appendChild(clickTag)
          btnDiv.appendChild(deleteTag)

          if (!hasEmptyValue.includes(true)) {
            if(btnCount ==="menu"){
              let titleCheck = $("#contentCard #title").length;
              let donorCheck = $("#contentCard .donor-class").length;
              if(donorCheck){
                $("#contentCard .donor-class").after(btnDiv);
              }else{
              if(titleCheck === 0){
                $("#contentCard").prepend(btnDiv);
              }else{
                $("#contentCard #title").after(btnDiv)
              }
            }
            tempArray[`${parentId}`] = { type: "8",menusList, btnCount,fontColor:linkFontColor, bgColor:menuBgColor, buttons }
            }else{
              if (pageTitle !== "") {
                updatesContent.appendChild(btnDiv);
                btnContainerArray[`${parentId}`] = { btnCount, buttons, updates: `updates${idCount}` }
                tempArray[`${parentId}`] = { type: "8", btnCount, buttons, updates: `updates${idCount}` }
              } else {
                contentCards.appendChild(btnDiv);
                btnContainerArray[`${parentId}`] = { btnCount, buttons }
                tempArray[`${parentId}`] = { type: "8", btnCount, buttons }
              }
            }
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            buttonId += 1;
          }

          dropDownChange = (elem)=>{
            $(`#${elem.id}`).dropdown('toggle')
          }

          let modalContent = '';
          let linkElem = "";

          openPopupModal = (elem) => {
            modalContent = '';
            let btnAttr = elem.classList[1].split("_")[1];
            let popupData = tempArray[`${btnAttr}`]['buttons'][0];
            let modalType = popupData['popupType'];

            if (modalType === "image") {
              modalContent = `<img src="${URL.createObjectURL(popupData.image)}" class="popupImage" />`
            } else if (modalType === "pdf") {
              modalContent = `<object data='${URL.createObjectURL(popupData.pdf)}' type='application/pdf' width='100%' height='700px'>`
            } else if (modalType === "link") {
              popupData.links.map((l) => {
                modalContent += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
              })
            } else if (modalType === "text") {
              modalContent = `<div class="p-3" style="background-color:${popupData.textBgColor}">${popupData.text}</div>`
            }

            $("#popupBtnModalEdit .modal-body").html(modalContent);
            $('#popupBtnModalEdit').modal('show');
          }

          //Button Two
          let modalContentTwo = '';
          let linkElemTwo = "";

          openPopupTwoModal = (elem) => {
            modalContentTwo = '';
            let elemIndex = elem.id.split("_")[1];
            let btnAttr = elem.classList[1].split("_")[1];
            let popupTwoData = tempArray[`${btnAttr}`]['buttons'][elemIndex];
            let modalTypeTwo = popupTwoData['popupType'];

            if (modalTypeTwo === "image") {
              modalContentTwo = `<img src="${URL.createObjectURL(popupTwoData.image)}" class="popupImage" />`
            } else if (modalTypeTwo === "pdf") {
              modalContentTwo = `<object data='${URL.createObjectURL(popupTwoData.pdf)}' type='application/pdf' width='100%' height='700px'>`
            } else if (modalTypeTwo === "link") {
              popupTwoData.links.map((l) => {
                modalContentTwo += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
              })
            } else if (modalTypeTwo === "text") {
              modalContentTwo = `<div class="p-3" style="background-color:${popupTwoData.textBgColor}">${popupTwoData.text}</div>`
            }

            $("#popupBtnModalEdit .modal-body").html(modalContentTwo);
            $('#popupBtnModalEdit').modal('show');
          }

        }
        else if (modalBody.children[0].className === "linkImgModalDiv") {

          let imgId = modalBody.children[0].id
          var div = document.createElement('div')
          div.className = "imgLink dragDiv"
          div.id = imgId
          div.draggable = true

          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'link')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          var imageLinkVal = $("#imgLinkField").val();
          let imageValue = $("#formFile").val();

          if (imageValue == "") {
            if ($(".link-img-error").length === 0) {
              $("#formFile").after(`<p class="error link-img-error">Please upload the image..!</p>`)
            }
          } else {
            $(".link-img-error").remove();
          }

          var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
          let linkUrlValidate = ValidateUrlExp.test(imageLinkVal)

          if (imageLinkVal) {
            imgLinkContainerArray[`${imgId}`]['link'] = imageLinkVal;
            tempArray[`${imgId}`]['link'] = imageLinkVal;
          }

          let linkData = imgLinkContainerArray[`${imgId}`]

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (linkData === undefined) {
            let imageLink = document.querySelector("#formFile")

            let errorName = document.querySelector(".linkName")
            let errorLink = document.querySelector(".linkImage")

            if (!errorLink) {
              imageLink.insertAdjacentHTML('afterend', '<p class="error linkImage">Please enter the link and insert a image...!</p>');
            } else {
              errorLink.remove()
            }
          }

          const { link, image } = imgLinkContainerArray[`${imgId}`]

          //

          let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${URL.createObjectURL(image)}" alt=""/></a>`

          let imgDiv = document.createElement("div")
          imgDiv.className = "linkImgClass"
          imgDiv.id = "img" + imgId

          imgDiv.innerHTML = imgLinkDiv

          div.appendChild(dropImg)
          div.appendChild(imgDiv)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          if (link !== "" && image !== "" && linkUrlValidate === true) {

            if (pageTitle !== "") {
              updatesContent.appendChild(div)
            } else {
              contentCards.appendChild(div)
            }
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            //
            submitBtnDiv.style.display = "block"
            buttonId += 1;
            imgLinkId += 1;
          }
          clickTag.setAttribute("onclick", `editModal("editImgLink",this.previousElementSibling.id,this.parentElement.id)`)
        }
        else if (modalBody.children[0].className === "hyperLinkModalDiv") {
          let hyperLinkView = $('input[name="hyperLinkType"]:checked').val();
          let hyperLinks = []
          let hyperLinkForms = document.getElementsByClassName("hyperLinkForm")
          let isEmpty = [];

          for (let h = 0; h < hyperLinkForms.length; h++) {
            let form = hyperLinkForms[h];
            let data = new FormData(form);
            data = data.entries();
            var obj = data.next();
            var retrieved = {};

            var f = form.id;
            var numberPattern = /\d+/g;
            f = f.match(numberPattern).join([]);

            while (undefined !== obj.value) {
              retrieved["caption"] = CKEDITOR.instances[`captionInput${f}`]?.getData()
              if (obj.value[0] === "file") {
                retrieved['image'] = [obj.value[1]];
              } else {
                retrieved[obj.value[0]] = obj.value[1];
              }
              obj = data.next();
              retrieved["caption"] = CKEDITOR.instances[`captionInput${f}`]?.getData()
            }

            var formElem = document.getElementById(`hyperLink_form${f}`);
            const inputFields = formElem.querySelectorAll(`input`)

            for (let i = 0; i < inputFields.length; i++) {
              let inputType = inputFields[i].type
              let inputName = inputFields[i].name
              if (inputName === "link") {
                var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                let hyperLinkVal = ValidateUrlExp.test(inputFields[i].value)
                if (inputFields[i].value === "" || hyperLinkVal === false) {
                  isEmpty.push(true);
                  if ($(`#hyperError${f}${i}`).length === 0) {
                    $(inputFields[i]).after(`<p class="error" id="hyperError${f}${i}">Please enter the valid URL..!</p>`)
                  }
                } else {
                  isEmpty.push(false);
                  $(`#hyperError${f}${i}`).remove();
                }
              } else if (inputType === "file") {
                if (inputFields[i].files.length === 0) {
                  isEmpty.push(true);
                  if ($(`#hyperError${f}${i}`).length === 0) {
                    $(inputFields[i]).after(`<p class="error" id="hyperError${f}${i}">Upload the image..!</p>`);
                  }
                } else {
                  isEmpty.push(false);
                  $(`#hyperError${f}${i}`).remove();
                }
              } else if (inputName === "caption") {
                if (CKEDITOR.instances[`captionInput${f}`]?.getData() === "") {
                  isEmpty.push(true);
                  if ($(`#hyperError${f}${i}`).length === 0) {
                    $(`#cke_captionInput${f}`).after(`<p class="error" id="hyperError${f}${i}">Please enter the field..!</p>`);
                  }
                } else {
                  isEmpty.push(false);
                  $(`#hyperError${f}${i}`).remove();
                }
              }
            }

            if (!isEmpty.includes(true)) {
              hyperLinks.push(retrieved)
            }
          }

          let modalId = modalBody.children[0].id

          let hyperDivId = modalId.split("_")[1]

          var div = document.createElement('div')
          div.className = "hyperLinksContainer"
          div.id = hyperDivId
          div.draggable = true

          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id



          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon


          clickTag.appendChild(editImg)

          clickTag.setAttribute("onclick", `editModal("editHyperLink",this.previousElementSibling.id,this.parentElement.id)`)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'hyperLink')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          let hyperLinkContainer = document.createElement("div")
          hyperLinkContainer.className = `hyperLinksDiv ${hyperLinkView === "stampcard" ? "stampcard" : ""}`
          hyperLinkContainer.id = `linksDiv${hyperLinkId}`

          let hyperLinkTag = "";
          hyperLinks.forEach((e, i) => {
            hyperLinkTag +=
              `<div class="hyperLink ${hyperLinkView === "stampcard" ? "stampcard" : ""}">
              <div class="linkDiv ${hyperLinkView === "stampcard" ? "stampcard" : ""}">
                  <a href="${e.link}" target="_blank">
                      <img src="${URL.createObjectURL(e.image[0])}" alt="">
                  </a>
              </div>
              <div class="captionDiv">  
                  ${e.caption}
              </div>
          </div>`
          })

          hyperLinkContainer.innerHTML = hyperLinkTag
          div.appendChild(dropImg)
          div.appendChild(hyperLinkContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            parentDivId = updatesContentId.split("").pop()
          }

          if (!isEmpty.includes(true)) {
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            if (pageTitle !== "") {
              updatesContent.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = { hyperLinkCards: hyperLinks, updates: `updates${parentDivId}` }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards: hyperLinks, updates: `updates${parentDivId}`, "hyperLinkType": hyperLinkView }
            } else {
              contentCards.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = { hyperLinkCards: hyperLinks }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards: hyperLinks, "hyperLinkType": hyperLinkView }
            }

            hyperLinkId += 1;
          }

        }
        else if (modalBody.children[0].className === "stampCardLinkModalDiv") {

          let stampCardLinks = []

          let stampCardLinkForms = document.getElementsByClassName("stampCardLinkForm")

          for (let h = 0; h < stampCardLinkForms.length; h++) {
            let form = stampCardLinkForms[h];
            let data = new FormData(form);
            data = data.entries();
            var obj = data.next();
            var retrieved = {};

            while (undefined !== obj.value) {
              retrieved["caption"] = CKEDITOR.instances[`stampCardcaptionInput${h}`]?.getData()
              retrieved[obj.value[0]] = obj.value[1];
              obj = data.next();
              retrieved["caption"] = CKEDITOR.instances[`stampCardcaptionInput${h}`]?.getData()
            }

            var formElem = document.getElementById(`stampCardLink_form${h}`);
            const inputFields = formElem.querySelectorAll(`input`)

            let isEmpty = false;

            for (let i = 0; i < inputFields.length; i++) {
              let inputType = inputFields[i].type
              let inputName = inputFields[i].name
              if (inputName === "link" && inputFields[i].value === "") {
                isEmpty = true
              } else if (inputType === "file" && inputFields[i].files.length === 0) {
                isEmpty = true
              }
              else if (CKEDITOR.instances[`stampCardcaptionInput${h}`]?.getData() === "") {
                isEmpty = true
              }
            }




            if (isEmpty === true) {
              if ($(`.formError${h}`).length == 0) {
                $(`#stampCardLink_form${h}`).after(`<span class="formError${h} error">Please enter the field..!</span>`)
              }
            } else {
              $(`.formError${h}`).remove()
              stampCardLinks.push(retrieved)
            }
          }

          let modalId = modalBody.children[0].id

          let stampCardLinkDivId = modalId.split("_")[1]

          var div = document.createElement('div')
          div.className = "stampCardLinkContainer"
          div.id = stampCardLinkDivId
          div.draggable = true

          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id



          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon


          clickTag.appendChild(editImg)

          clickTag.setAttribute("onclick", `editModal("editStampCardLink",this.previousElementSibling.id,this.parentElement.id)`)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'stampCardLink')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          let stampCardLinkContainer = document.createElement("div")
          stampCardLinkContainer.className = "stampCardLinksDiv"
          stampCardLinkContainer.id = `linksDiv${stampCardId}`

          let stampCardLinkTag = "";
          stampCardLinks.forEach((e, i) => {
            stampCardLinkTag +=
              `<div class="stampCardLink">
              <div class="linkDiv">
                  <a href="${e.link}" target="_blank">
                      <img src="${URL.createObjectURL(e.file)}" alt="">
                  </a>
              </div>
              <div class="captionDiv">
                  ${e.caption}
              </div>
          </div>`
          })

          stampCardLinkContainer.innerHTML = stampCardLinkTag
          div.appendChild(dropImg)
          div.appendChild(stampCardLinkContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !== "") {
            updatesContentId = pageTitle.split("_")[0]
            updatesContent = document.getElementById(updatesContentId)
            var numb = updatesContentId?.match(/\d/g);
            numb = numb?.join("");
            parentDivId = numb
          }

          if (stampCardLinks.length > 0) {
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            if (pageTitle !== "") {
              updatesContent.appendChild(div)
              stampCardLinkArray[`${stampCardLinkDivId}`] = { stampCardLinkCards: stampCardLinks, updates: `updates${parentDivId}` }
              tempArray[`${stampCardLinkDivId}`] = { type: "13", stampCardLinkCards: stampCardLinks, updates: `updates${parentDivId}` }
            } else {
              contentCards.appendChild(div)
              stampCardLinkArray[`${stampCardLinkDivId}`] = { stampCardLinkCards: stampCardLinks }
              tempArray[`${stampCardLinkDivId}`] = { type: "13", stampCardLinkCards: stampCardLinks }
            }

            stampCardId += 1;
          }

        }
        else if (modalBody.children[0].className === "updatesDiv") {

          let updateDivId = modalBody.children[0].id.split("_")[0]

          var div = document.createElement('div')
          div.className = "updatesDivContainer"
          div.id = `${updateDivId}`
          var dropImg = document.createElement("img")
          dropImg.className = "dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'updates')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          clickTag.setAttribute("onclick", `editModal("editUpdates",this.previousElementSibling.id,this.parentElement.id)`)

          let updaesContainer = document.createElement("div")
          updaesContainer.className = "updatesDivBox"
          updaesContainer.id = `updatesDiv${updatesId}`

          let elemBgColor = $(".updatesBgColor").val()
          let updatesHeading = CKEDITOR.instances['updatesHeading']?.getData()
          let accordionInput = $('#show:checked').val();

          let accordionShow = accordionInput === undefined ? false : true

          let updatesTag = `<div class="headingDiv" style="background-color:${elemBgColor}" id="updatesHeadingDiv${updatesId}">${updatesHeading}</div>
          <div class="updatesItems" id="updatesItems${updatesId}"></div>
          <div class="addButton">
            <div class="updatesBtns">
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('heading',this)">Header Band</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('description',this)">Description</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('image',this)">Image & Carousel</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('video',this)">Video</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('animation',this)">Gif Animation</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('quiz',this)">Add Quiz Question</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('link',this)">Image with Link</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this,'button')">Button with Link</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this,'popup')">Button with Popup</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('hyperLink',this)">Image[s] with Caption & Link</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('linkPopup',this)">Link with Popup</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="addSpace('updates',this)">Space</button>
            </div>
            <div>
              <button type="button" onclick="updatesBtnsFn(this)" id="updatesDiv${updatesId}_btn" class="updatesAddBtn rounded-circle">+</button>
            </div>
          </div>`

          updaesContainer.innerHTML = updatesTag
          div.appendChild(dropImg)
          div.appendChild(updaesContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          if (updatesHeading !== "") {
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            updatesArray[`${updateDivId}`] = { heading: updatesHeading, show: accordionShow, bgColor: elemBgColor }
            tempArray[`${updateDivId}`] = { type: "12", heading: updatesHeading, show: accordionShow, bgColor: elemBgColor }
            updatesId += 1;
            contentCards.appendChild(div)

            const updatesElemClassSort = document.querySelectorAll('.updatesDivContainer')

            for (var i = 0; i < updatesElemClassSort?.length; i++) {
              let ParentId = updatesElemClassSort[i].id
              let idCount = ParentId.split("").pop()
              let dragAreaUpdates = document.getElementById(`updatesItems${idCount}`)
              if (dragAreaUpdates) {
                new Sortable(dragAreaUpdates, {
                  filter: '.titleDiv',
                  handle: ".dragImg",
                  Animation: 350
                })
              }
            }

          }

          updatesBtnsFn = (event) => {
            let btnDiv = event.id.split("_")[0]
            $(`#${btnDiv} .updatesBtns`).toggleClass("active");
          }

        }
        else if (modalBody.children[0].className === "linkPopupDiv"){
          var selectedText = linkPopupText;
          let linkPopupDesc = CKEDITOR.instances['linkPopupDesc']?.getData();
          let nodeName = $(selectedElem)[0].nodeName;
          if(selectedText !==""){
            if(nodeName !== "A" && !linkChildElem.includes("A")){
              if(linkPopupDesc !== "" || linkPopupImage !== ""){
                var range = linkRange;
                var link = document.createElement('a');
                link.href = '#';
                link.className = 'popup-link';
                link.id='link'+linkPopupId;
                link.setAttribute("onclick","openLinkPopup(this)");
                link.appendChild(range.extractContents());
                range.insertNode(link);
                
                let elem=$(popupLinkElem).parent();
                let currentElem =popupLinkElem;
                let elemText = currentElem.innerHTML.toString();
                let descId = $(elem).attr('id')
                tempArray[`${descId}`]['text']=elemText.toString();
                descriptionArray[`${descId}`]['text']=elemText.toString();
                tempArray['linkPopup']={...tempArray['linkPopup'],type:"13",linkCount:linkPopupId+1,[`link${linkPopupId}`]:[{text:linkPopupDesc,image:linkPopupImage}]}
                linkPopupId +=1;
                $('#createModal').modal('hide');
              }
            }else{
              $(".link-text-error").css("display","block");
            }
          }else{
            $('#createModal').modal('hide');
          }

          var sel = window.getSelection ? window.getSelection() : document.selection;
          if (sel) {
              if (sel.removeAllRanges) {
                  sel.removeAllRanges();
              } else if (sel.empty) {
                  sel.empty();
              }
          }
        }
      }

      openLinkPopup = (elem)=>{
        let descId = elem.id;
        let linkData = tempArray['linkPopup'][elem.id][0]
        let imageElem = "";
        let descElem = "";
      
        if(linkData.image[0]=== undefined){
          if(linkData.image !==""){
            imageElem =`<img src="${URL.createObjectURL(linkData.image)}" alt="" />`
          }
        }else{
          if(linkData.image[0] !==""){
            imageElem =`<img src="${linkData.image[0]}" alt="" />`
          }
        }

        if(linkData.text !== ""){
          descElem = `<p>${linkData.text}</p>`
        }

        let previewElem=`<div class="link-popup-modal">
                      ${imageElem} 
                      ${descElem}
                    </div>`
        
        let editElem = `<div class="form-check mb-2">
                        <input class="form-check-input" type="checkbox" value="" id="removeLink" onchange="removeLink(event)">
                        <label class="form-check-label" for="removeLink">
                          Remove the link
                        </label>
                      </div>
                    
                    <div class="linkPopupDiv">
                      <div class="imgUploadDiv">
                        <div>
                          <input type="file" name="" id="linkPopupImageEdit" value="" onchange="linkImageOnchangeEdit(this)" hidden />
                          <label class="file-choose-label" for="linkPopupImageEdit" class="col-2">Choose Image</label>
                        </div>
                        <div id="linkImgDivEdit"></div>
                      </div>
                      <div>
                        <input type="text" id="linkPopupDescEdit" name="" value="" />
                      </div>
                  </div>`

        let LinkElem= `<div class="link-popup-edit edit_${descId}">
                        <ul class="nav nav-tabs" id="linkTab" role="tablist">
                          <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="profile-tab" data-bs-toggle="tab" data-bs-target="#previewLink" type="button" role="tab" aria-controls="profile" aria-selected="false">Preview</button>
                          </li>
                          <li class="nav-item" role="presentation">
                            <button class="nav-link" id="home-tab" data-bs-toggle="tab" data-bs-target="#editLink" type="button" role="tab" aria-controls="home" aria-selected="true">Edit</button>
                          </li>
                        </ul>
                        <div class="tab-content" id="linkTabContent">
                          <div class="tab-pane fade" id="editLink" role="tabpanel" aria-labelledby="home-tab">
                            ${editElem}
                          </div>
                          <div class="tab-pane fade show active" id="previewLink" role="tabpanel" aria-labelledby="profile-tab">
                            ${previewElem}
                          </div>
                        </div>
                      </div>`

        $("#linkPopupModal .modal-body").html(LinkElem);
        $("#linkPopupModal").modal('show')
        changeToRichtext([`linkPopupDescEdit`])
        
        if(linkData.text !== ""){
          CKEDITOR.instances[`linkPopupDescEdit`].setData(linkData.text);
        }

        if(linkData.image[0]=== undefined){
          if(linkData.image !== ""){
            linkPopupImage= linkData.image
            $("#linkImgDivEdit").html(`<img src="${URL.createObjectURL(linkPopupImage)}" alt=""><span class="img-del-btn" onclick="linkImageEditDel()">x</span>`)
          }
        }else{
          if(linkData.image[0] !== ""){
            linkPopupImage= linkData.image[0]
            $("#linkImgDivEdit").html(`<img src="${linkPopupImage[0]}" alt=""><span class="img-del-btn" onclick="linkImageEditDel()">x</span>`)
          }
        }

        linkImageOnchangeEdit = (elem)=>{
          linkPopupImage = elem.files[0];
          $("#linkImgDivEdit").html(`<img src="${URL.createObjectURL(linkPopupImage)}" alt=""><span class="img-del-btn" onclick="linkImageEditDel()">x</span>`)
        }

        linkImageEditDel = ()=>{
          linkPopupImage = "";
          $("#linkImgDivEdit").html("");
        }

        removeLink = (e)=>{
          const {checked} = e.target;
          if(checked){
            $(".linkPopupDiv").css("pointer-events","none");
            $(".linkPopupDiv").css("opacity","0.4");
          }else{
            $(".linkPopupDiv").css("pointer-events","auto");
            $(".linkPopupDiv").css("opacity","1");
          }
        }
      }

      linkPopupUpdate = ()=>{
        let linkPopupID=$(".link-popup-edit")[0].classList[1].split("_")[1];
        let linkPopupDescEdit = CKEDITOR.instances['linkPopupDescEdit']?.getData();
        let removeLink =  $('#removeLink').is(':checked');
        let currentElem = $(`#${linkPopupID}`).closest('.description');
        let parentElem = $(currentElem).parent();
        let descId = $(parentElem).attr('id');
        console.log(linkPopupID,"current")
        if(removeLink === false){
          tempArray['linkPopup'][`${linkPopupID}`]=[{text:linkPopupDescEdit,image:linkPopupImage}]
        }else{
          delete tempArray['linkPopup'][`${linkPopupID}`];
          let linkText = $(`#${linkPopupID}`).text();
          let dataArrayProp= $(`#${linkPopupID}`).parent().parent().attr('id');
          let parentElem= $(`#${linkPopupID}`).parent().text()
          $(`#${linkPopupID}`).replaceWith(`${linkText}`);
          let linkHtmlElem = $(currentElem).html().toString();
          
          tempArray[`${descId}`]['text']=linkHtmlElem;
          descriptionArray[`${descId}`]['text']=linkHtmlElem;
        }
       $("#linkPopupModal").modal('hide');
      }


       getSelectedText=()=> {
        var text = '';
        if (window.getSelection) {
            text = window.getSelection().toString();
        } else if (document.selection && document.selection.type != "Control") {
            text = document.selection.createRange().text;
        }
        return text;
    }

      // Edit Funtion

      function editModal(element, id, parentId) {
        document.getElementById("editPageContent").innerHTML = ""
        let updatesClass = document.getElementById(`${parentId}`)?.parentNode.className
        let updatesDivId = document.getElementById(`${parentId}`)?.parentNode.id
        var numb = updatesDivId?.match(/\d/g);
        numb = numb?.join("");
        let updatesId = numb

        let parentContentCard = document.getElementById("contentCard")

        if (element === "editQuiz") {

          $('#editModal').modal('show');
          const quizObject = quizContainerArray[`${parentId}`]['quiz']
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Quiz Question"
          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClassEdit"
          formDiv.id = parentId

          var options = ""

          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option0" placeholder="option 1" required name="option0" value="${quizObject['option0']}" >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option1" placeholder="option 2" required name="option1" value="${quizObject['option1']}" >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option2" placeholder="option 3" required name="option2" value="${quizObject['option2']}" >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option3" placeholder="option 4" required name="option3" value="${quizObject['option3']}" >
                </div>`


          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" value="${quizObject['answer']}" >
          </div>`

          var divOne = document.createElement("div")
          divOne.className = "quizEditDiv"
          divOne.id = id
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.value = quizObject['question']
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          modalBody.appendChild(formDiv)

        }
        else if (element === "editVideo") {
          $('#editModal').modal('show');
          var paramId = id
          let videosList = videoContainerArrary[`${parentId}`]
          let videoType = tempArray[`${parentId}`]['videoType']===undefined?"upload":tempArray[`${parentId}`]['videoType'];
          let videoLink="";
          thumbnailImage="";

          if(videoType === "link"){
            thumbnailImage=tempArray[`${parentId}`]['image'];
            videoLink= tempArray[`${parentId}`]['link'];
          }
          console.log(thumbnailImage, "img")
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Video"

          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          //
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="video-option mb-3">
            <fieldset>
            <legend class="col-form-label pt-0">Video Type:</legend>
            <div class="video-option-div">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="videoTypeEdit" id="videoUploadEdit" value="upload" onchange="videoTypeChangeEdit(this)" checked>
                <label class="form-check-label" for="videoUploadEdit">
                  Upload
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="videoTypeEdit" id="videoLinkEdit" value="link" onchange="videoTypeChangeEdit(this)" >
                <label class="form-check-label" for="videoLinkEdit">
                  Link
                </label>
              </div>
            </div>
        </fieldset>
        </div>
        <form action="" method="post" class="dragover" id="videoUploadDivEdit">
          <input name="file" type="file" class="file" id="videoInputEditId" onchange="videoOnChangeEdit(this)" accept="video/mp4" hidden />
          <label class="file-choose-label" for="videoInputEditId">Choose Video</label>
          <span id="videoEditChosen">No video chosen</span>
        </form>
        <div class="video-link-container" id="videoLinkDivEdit" style="display:none">
              <div class="input-div">
                <label>Video Link:</label>
                <div class="video-input">
                  <input class="form-control" type="text" id="videoLinkInputEdit" onkeyup="inputVerifyEdit(this)" />
                  <p class="sub-text">(Ex:https://www.youtube.com/embed/video_id)</p>
                </div>
              </div>
              <div class="video-thumbnail-container">
                <p>Thumbnail:</p>
                <div class="thumbnail-input">
                  <label class="file-choose-label" for="videoThumbnailEdit">Choose Image</label>
                  <input type="file" id="videoThumbnailEdit" onchange="videoThumbChangeEdit(this)" accept="image/png, image/jpeg" hidden />
                </div>
                <div id="thumbnailImageDivEdit"></div>
              </div>
            </div>
        <div class="videoModalContainerEdit" id=${paramId}>
        </div>`

          modalBody.appendChild(cardDiv)

          inputVerifyEdit = (e)=>{
            let videoLink= $(e).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)

            $(".video-link-error").remove();
            if(linkUrlValidate === false){
              $(e).after('<p class="error video-link-error">Please enter the valid URL.</p>')
            }else{
              $(".video-link-error").remove();
            }
          }
          
          videoTypeChangeEdit = (elem)=>{
            let videoTypeOption = $(elem).val();
            if(videoTypeOption === "upload"){
              $("#videoUploadDivEdit").css("display","flex");
              $("#videoLinkDivEdit").css("display","none");
            }else{
              $("#videoUploadDivEdit").css("display","none");
              $("#videoLinkDivEdit").css("display","flex");
              $(".videoModalContainerEdit").html("");
            }
          }

          videoThumbChangeEdit = (elem)=>{
            $(".thumbnail-error").remove();
            let sizeInMb = elem.files[0].size / (1024 * 1024);
            if(sizeInMb < 5){
              thumbnailImage = elem.files[0];
              $("#thumbnailImageDivEdit").html(`<img src="${URL.createObjectURL(thumbnailImage)}" />`);
            }else{
              $(elem).after('<p class="error thumbnail-error">Image should be less than 5MB.</p>');
            }
          }

          $(`input[name=videoTypeEdit][value=${videoType}]`).prop("checked", true);

          if(videoType === "link"){
            $("#videoUploadDivEdit").css("display","none");
            $("#videoLinkDivEdit").css("display","flex");
            $(".videoModalContainerEdit").html("");
            $("#videoLinkInputEdit").val(videoLink);
            let thumbnailURL = "";
            if(thumbnailImage[0] === undefined){
            if(typeof thumbnailImage === "object"){
              thumbnailURL = URL.createObjectURL(thumbnailImage);
            }else{
              thumbnailURL = thumbnailImage;
            }
          }else{
            if(typeof thumbnailImage[0] === "object"){
              thumbnailURL = URL.createObjectURL(thumbnailImage[0]);
            }else{
              thumbnailURL = thumbnailImage[0];
            }
          }
            $("#thumbnailImageDivEdit").html(`<img src="${thumbnailURL}" />`);
          }else{
            $("#videoUploadDivEdit").css("display","flex");
            $("#videoLinkDivEdit").css("display","none");
          }

          //
          const maxVideoSize = 10 * 1024 * 1024;
          //

          let button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainerEdit')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          var inputFile = document.querySelector('form input')

          var videoFile = []
          if(videoType == "upload"){
          if (updatesClass === "updatesItems") {
            videoFile = videoContainerArrary[`${parentId}`]['video'][0]
          } else {
            videoFile = videoContainerArrary[`${parentId}`]
          }
        }

          let files = []

          var inputId = document.getElementById("videoInputEditId")
          $("#videoEditChosen").css("display", "none")

          videoOnChangeEdit = (elem) => {
            $(".video-error-edit").remove();
            videoFile = elem.files[0];
            if (videoFile.size < maxVideoSize) {

              if (updatesClass === "updatesItems") {
                videoContainerArrary[`${parentId}`] = { files: videoFile, updates: `updates${updatesId}` }
                tempArray[`${parentId}`] = { type: "5", video: videoFile, updates: `updates${updatesId}` }
              } else {
                videoContainerArrary[`${parentId}`] = videoFile
                tempArray[`${parentId}`] = { type: "5", video: videoFile }
              }


              form.reset();
              container.innerHTML = ""
              showEditVideos()
            } else {
              container.innerHTML = `<p style="color:red" class="video-error-edit">Maximum video size is 10MP </p>`
            }
            //
          }

          let showEditVideos = () => {
            let videoUrl = ""
            if (typeof videoFile === "object") {
              videoUrl = URL.createObjectURL(videoFile)
            } else {
              videoUrl = videoFile
            }

            let videos = `<div class="video" id="videoEditId" draggable="true">
                      <video src=${videoUrl} alt="video">
                      <span onclick="delEditVideos()">&times;</span>
                  </div>`

            var imgDiv = document.createElement("div")
            imgDiv.innerHTML = videos

            container.appendChild(imgDiv)

          }

          delEditVideos = (index) => {
            files.splice(index, 1)
            showEditVideos()
          }

          if(videoType === "upload"){
            showEditVideos()
          }

          if(videoType === "link"){
            $(".videoModalContainerEdit").html("");
          }

        }
        else if (element === "editAnimation") {
          var paramId = id
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Gif Animation"
          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')


          var animationList = animationContainerArray[`${parentId}`]

          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <form action="" method="post" class="dragover">
                    <input name="file" type="file" class="file" id="animationInputId" multiple accept="image/gif" onchange="animationonEditChange(this)" hidden/>
                    <label class="file-choose-label" for="animationInputId">Choose GIF</label>
                    <span id="animationEditChosen">No GIF chosen</span>
                  </form>
                  <div class="animationEditContainer" id=${paramId}> 
                  </div>`

          modalBody.appendChild(cardDiv)


          var animationfiles = []

          if (updatesClass === "updatesItems") {
            animationfiles = animationContainerArray[`${parentId}`]['files']
          } else {
            animationfiles = animationContainerArray[`${parentId}`]
          }

          let files = [];
          let button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationEditContainer')
          container.id = paramId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');


          var input = document.getElementById("animationInputId")
          $("#animationEditChosen").css("display", "none")

          animationonEditChange = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (animationfiles.every(e => e.name !== file[i].name)) animationfiles.push(file[i])
            }

            if (updatesClass === "updatesItems") {
              animationContainerArray[`${paramId}`] = { files: animationfiles, updates: `updates${updatesId}` }
              tempArray[`${parentId}`] = { type: "6", animations: files, updates: `updates${updatesId}` }
            } else {
              animationContainerArray[`${paramId}`] = animationfiles
              tempArray[`${parentId}`] = { type: "6", animations: files }
            }
            form.reset();
            showAnimations()
          }

          let showAnimations = () => {
            if (updatesClass === "updatesItems") {
              animationfiles = animationContainerArray[`${parentId}`]['files']
            } else {
              animationfiles = animationContainerArray[`${parentId}`]
            }

            let animations = '';
            animationfiles.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                        <img src=${URL.createObjectURL(e)} alt="animation">
                        <span onclick="delEditAnimations(${i})">&times;</span>
                    </div>`
            })
            container.innerHTML = animations

          }

          delEditAnimations = (index) => {
            animationfiles.splice(index, 1)
            showAnimations()
          }

          showAnimations()

        }
        else if (element === "editTitle") {
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Page Title & Color"
          var modalBody = document.getElementById('editPageContent')
          let pageTitleContent = tempArray["title"]['title'];
          pageBgImage = "";

          let contentBgColor = tempArray["title"]['bgColor'];
          let textureType = tempArray["title"]['textureType'];
          let titleText = document.getElementById(id).innerText
          let textureColor = "#ffffff";
          if(textureType === "existing"){
            pageBgImage = tempArray["title"]['bgImage']
            textureImageIndex = tempArray["title"]['imageIndex']
          }else if(textureType === "new"){
            pageBgImage = tempArray["title"]['bgImage']
            textureImageIndex = tempArray["title"]['imageIndex']
          }else if(textureType === "color"){
            textureColor = tempArray["title"]['textureColor'];
          }

          let bgColor = cardbgColor

          var pageTitle = ` <div class="col-md-12">
            <label for="pageTitle" class="form-label">Title</label>
            <input type="text" class="form-control inputField" id="pageTitleFieldEdit">
          </div>
          <div class="col-12">
            <div class="row">
                <label for="colorPickerIdEdit" class="form-label col-6">Background Color</label>
                <input type="color" class="form-control form-control-color col-6" id="colorPickerIdEdit" value=${contentBgColor}>
            </div>
          </div>
          <div class="col-12 mt-3">
            <div class="row">
              <label class="col-4">
               Choose Texture:
              </label>
              <div class="col-8">
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOptionEdit" id="existingTextureEdit" onchange="textureChangeEdit(this)" value="existing" checked>
                  <label class="form-check-label" for="existingTextureEdit">Existing Texture</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOptionEdit" id="newTextureEdit" onchange="textureChangeEdit(this)" value="new" >
                  <label class="form-check-label" for="newTextureEdit">New Texture</label>
                </div>
                <div class="form-check form-check-inline">
                  <input class="form-check-input" type="radio" name="textureOptionEdit" id="textureColorEdit" onchange="textureChangeEdit(this)" value="color">
                  <label class="form-check-label" for="textureColorEdit">Bg Color</label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 textures-optionsEdit" id="existingTextureListEdit">
          </div>
           <div class="col-12 textures-optionsEdit gap-3 mt-3" id="textureUploadEdit" style="display:none">
                <div>
                  <input class="form-control" type="file" id="mainBgImageEdit" accept="image/png, image/jpeg" onchange="bgImageonChangeEdit(this)" hidden />
                  <label class="file-choose-label" for="mainBgImageEdit">Choose Image</label>
                </div>
                <div id="mainImgContainerEdit" style="display:none"></div>
          </div>
          <div class="col-12 textures-optionsEdit" id="textureColorDivEdit" style="display:none">
            <div class="row">
              <div class="col-4"></div>
            <input type="color" class="form-control form-control-color col-8" id="textureBgColorEdit" value="${textureColor}">
            </div>
          </div>
          `
          let textureImages=['../../assets/img/texture1.jpg','../../assets/img/texture2.jpg','../../assets/img/texture3.jpg'];

          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          parentDiv.innerHTML = pageTitle

          let elemValue = document.getElementById(id)
          modalBody.appendChild(parentDiv)

          $(`input[name=textureOptionEdit][value=${textureType}]`).prop("checked", true);

          textureImages.forEach((image,i)=>{
            $("#existingTextureListEdit").append(`<div class="form-check form-check-inline existing-list-img">
                    <input class="form-check-input" type="radio" name="textureImgOptionEdit" id="existingImgEdit${i}" onchange="textureImgChooseEdit(${i})">
                    <label for="existingImgEdit${i}">
                      <img src="${image}" />
                    </label>
                  </div>`)
          })

          $(".textures-optionsEdit").css("display","none")

          if(textureType === "existing"){
            $(`input[name='textureImgOptionEdit']:eq(${textureImageIndex})`).prop("checked", true);
            $(`#existingTextureListEdit`).css("display","flex");
          }else if(textureType === "new"){
          
            let pgImageUrl = "";

            if(pageBgImage[0]===undefined){
              if(typeof pageBgImage === "object"){
                pgImageUrl = URL.createObjectURL(pageBgImage);
              }else{
                pgImageUrl = pageBgImage
              }
            }else{
              if(typeof pageBgImage[0] === "object"){
                pgImageUrl = URL.createObjectURL(pageBgImage[0]);
              }else{
                pgImageUrl = pageBgImage[0]
              }
            }
            $("#mainImgContainerEdit").html(`<img src="${pgImageUrl}" /><span onclick="deltextureImgEdit()"><i class="fa-solid fa-xmark"></i></span>`)
            $("#mainImgContainerEdit").css("display","block");
            $("#textureUploadEdit").css("display","flex");
          }else if(textureType === "color"){
            $(`#textureColorDivEdit`).css("display","block");
          }

          textureImgChooseEdit = (index)=>{
            pageBgImage = textureImages[index];
            textureImageIndex=index;
          }

          textureChangeEdit=(elem)=>{
            $(".textures-optionsEdit").css("display","none")
            let textOption = $(elem).val();
            if(textOption==="existing"){
              $(`#existingTextureListEdit`).css("display","flex");
            }else if(textOption === "new"){
              $(`#textureUploadEdit`).css("display","flex");
            }else if(textOption === "color"){
              $(`#textureColorDivEdit`).css("display","block");
            }
            
          }

          bgImageonChangeEdit = (elem)=>{
            $(".texture-img-error").remove();
            let fileSizeInMB = elem.files[0].size / (1024 * 1024);
            if(fileSizeInMB > 20){
              $("#mainImgContainerEdit").parent().after("<p class='error texture-img-error'>Please upload an image less than 20MB.</p>")
            }else{
            pageBgImage = elem.files[0];
              $("#mainImgContainerEdit").html(`<img src="${URL.createObjectURL(elem.files[0])}" /><span onclick="deltextureImgEdit()"><i class="fa-solid fa-xmark"></i></span>`)
              $("#mainImgContainerEdit").css("display","block");
            }
          }

          deltextureImgEdit = () =>{
            $("#mainImgContainerEdit").html("");
            pageBgImage="";
            $("#mainImgContainerEdit").css("display","none");
          }

          changeToRichtext([`pageTitleFieldEdit`])

          CKEDITOR.instances[`pageTitleFieldEdit`].setData(pageTitleContent);

          var colorPickerField = document.getElementById("colorPickerEditId")
          let colorInputField = document.getElementById("colorEditId")
        }
        else if (element === "editButton") {
          $('#editModal').modal('show');
          popupImageTwo = "";
          popupImage = "";
          popupPdf = "";
          popupPdfTwo = "";
          let btnCount = tempArray[parentId]['btnCount'] === undefined ? "one" : tempArray[parentId]['btnCount'];
          let buttonOneData = tempArray[parentId]['buttons'][0] === undefined ? tempArray[parentId] : tempArray[parentId]['buttons'][0];
          let menuButtonData;
          let menuBgColor="";
          let menuPosition="";
          let menuFontColor = "";
          let menusList = [];
          if(btnCount === "menu"){
            menuButtonData = tempArray[parentId]['buttons'];
            menuBgColor = tempArray[parentId]['bgColor'];
            menuPosition = menuButtonData[0]['position'];
            menuFontColor = tempArray[parentId]['fontColor'];
            menusList = tempArray[parentId]['menusList'];
          }

          let btnType = buttonOneData['btnType'] === undefined ? 'link' : buttonOneData['btnType'];

          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = btnType === "link" ? "Edit Button with Link" : "Edit Button with popup [Text, Image, PDF, Link]";

          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent');
          
          let name="";
          let bgColor = "#b3b3b3";
          let link ="";
          if(btnCount !== "menu"){
            name=buttonOneData['name'];
            bgColor=buttonOneData['bgColor']
            link = buttonOneData['link'] === undefined ? '' : buttonOneData['link'];
          }

          let btnPosition = buttonOneData['btnPosition'] === undefined ? 'center' : buttonOneData['btnPosition'];
          let btnName = document.getElementById(`${id}`).children[0].innerText;
          let btnLink = document.getElementById(`${id}`).children[0].getAttribute("href");


          //Button two
          let buttonTwoData = "";
          let btnNameTwo = "";
          let bgColorTwo = '#b3b3b3';
          let linkTwo = "";
          let btnTypeTwo = "";
          let btnPositionTwo = "";
          let btnLocationTwo = '';
          let popupTypeTwo = '';
          let linksTwo;
          let popupTextTwo = '';
          let popupTextColorTwo = '#b3b3b3';

          if(btnCount !=="menu"){
          if (btnCount === "two") {
            buttonTwoData = tempArray[parentId]['buttons'][1];
            btnNameTwo = buttonTwoData['name'] === undefined ? '' : buttonTwoData['name'];
            bgColorTwo = buttonTwoData['bgColor'] === undefined ? '#b3b3b3' : buttonTwoData['bgColor'];
            linkTwo = buttonTwoData['link'] === undefined ? '' : buttonTwoData['link'];
            btnTypeTwo = buttonTwoData['btnType'] === undefined ? 'link' : buttonTwoData['btnType'];
            btnPositionTwo = buttonTwoData['btnPosition'] === undefined ? 'center' : buttonTwoData['btnPosition'];

            if (btnTypeTwo === "popup") {
              btnLocationTwo = buttonTwoData['btnLocation'] === undefined ? 'body' : buttonTwoData['btnLocation'];
              popupTypeTwo = buttonTwoData['popupType'] === undefined ? 'link' : buttonTwoData['popupType'];
              if (popupTypeTwo === 'link') {
                linksTwo = buttonTwoData['links'];
              } else if (popupTypeTwo === 'image') {
                popupImageTwo = buttonTwoData['image'];
              } else if (popupTypeTwo === 'pdf') {
                popupPdfTwo = buttonTwoData['pdf'];
              } else if (popupTypeTwo === "text") {
                popupTextTwo = buttonTwoData['text'] === undefined ? "" : buttonTwoData['text'];
                popupTextColorTwo = buttonTwoData['textBgColor'] === undefined ? '#b3b3b3' : buttonTwoData['textBgColor'];
              }
            }
          }
        }
          let btnLocation = '';
          let popupType = '';
          let links;
          let popupText = '';
          let popupTextColor = '#b3b3b3';

        if(btnCount !=="menu"){
          if (btnType === "popup") {
            btnLocation = buttonOneData['btnLocation'] === undefined ? 'body' : buttonOneData['btnLocation'];
            popupType = buttonOneData['popupType'] === undefined ? 'link' : buttonOneData['popupType'];

            if (popupType === 'link') {
              links = buttonOneData['links'];
            } else if (popupType === 'image') {
              popupImage = buttonOneData['image'];
            }
            else if (popupType === 'pdf') {
              popupPdf = buttonOneData['pdf'];
            } else if (popupType === "text") {
              popupText = buttonOneData['text'];
              popupTextColor = buttonOneData['textBgColor'];
            }
          }
        }

          let nameInput = document.createElement("input")
          nameInput.className = "form-control col-12"
          nameInput.id = "btnNameEdit"
          nameInput.value = btnName


          let buttonInput = `<div class="row gap-3">
            <div class="col-12">
              <fieldset class="row">
                <legend class="col-form-label col-4 pt-0">Buttons:</legend>
                <div class="col-8">
                  <div class="form-check form-check-inline" id="oneBtnOptionEdit">
                    <input class="form-check-input" type="radio" name="buttonCountEdit" id="oneEdit" value="one" onchange="buttonCountChangeEdit(this)" checked>
                    <label class="form-check-label" for="oneEdit">
                      Single
                    </label>
                  </div>
                  <div class="form-check form-check-inline" id="twoBtnOptionEdit">
                    <input class="form-check-input" type="radio" name="buttonCountEdit" id="twoEdit" value="two" onchange="buttonCountChangeEdit(this)" >
                    <label class="form-check-label" for="twoEdit">
                      Double
                    </label>
                  </div>
                   <div class="form-check form-check-inline" id="menuBtnOptionEdit">
                      <input class="form-check-input" type="radio" name="buttonCountEdit" id="menuEdit" value="menu" onchange="buttonCountChangeEdit(this)" >
                      <label class="form-check-label" for="menu">
                        Menu
                      </label>
                    </div>
                </div>
            </fieldset>
          </div>
          <div class="gap-3 flex-column" id="firstBtnDivEdit" style="display:flex">
            <div class="col-12">
              <fieldset class="row">
                <legend class="col-form-label col-4 pt-0">Button Type:</legend>
                <div class="col-8">
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonTypeEdit" id="link" value="link" onchange="buttonTypeChangeEdit(this)">
                    <label class="form-check-label" for="link">
                      Link
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="buttonTypeEdit" id="popup" value="popup" onchange="buttonTypeChangeEdit(this)" >
                    <label class="form-check-label" for="popup">
                      Popup
                    </label>
                  </div>
                </div>
            </fieldset>
          </div>
          <div class="col-12">
            <input type="text" class="form-control" id="btnNameEdit" placeholder="Name" value="${name}">
          </div>
          <div class="col-12" id="linkDivEdit" style="display:block">
            <input type="text" class="form-control" id="btnLinkIdEdit" placeholder="Link" value="${link}">
          </div>
          <div class="col-12">
            <div class="row align-items-center">
            <label for="colorPickerIdEdit" class="form-label col-6">Choose background Color</label>
            <div class="col-4">
              <input type="color" class="form-control form-control-color" id="btnColorPickerEdit" value="${bgColor}">
            </div>
          </div>
          </div>
          <div class="col-12">
            
        <fieldset class="row mb-2 mt-2">
          <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
          <div class="col-sm-10">
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="btnPositionEdit" id="left" value="left">
              <label class="form-check-label" for="left">
                Left
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="btnPositionEdit" id="center" value="center" checked>
              <label class="form-check-label" for="center">
                Center
              </label>
            </div>

            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="btnPositionEdit" id="right" value="right">
              <label class="form-check-label" for="right">
                Right
              </label>
            </div>
          </div>
        </fieldset>
          </div>
        </div>
        <div id="popupDivEdit" style="display:none">
        <fieldset class="row mb-2 mt-2">
          <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
          <div class="col-sm-10">
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="btnLocationEdit" id="header" value="header">
              <label class="form-check-label" for="header">
                Header
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="btnLocationEdit" id="body" value="body" checked>
              <label class="form-check-label" for="body">
                Body
              </label>
            </div>
          </div>
        </fieldset>

        <fieldset class="row mb-2 mt-2">
          <legend class="col-form-label col-sm-2 pt-0">Content:</legend>
          <div class="col-sm-10">
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="popupTypeEdit" id="textBtnEdit" value="text">
              <label class="form-check-label" for="textBtnEdit">
                Text
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="popupTypeEdit" id="imageBtnEdit" value="image" checked>
              <label class="form-check-label" for="imageBtnEdit">
                Image
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="popupTypeEdit" id="pdfBtnEdit" value="pdf">
              <label class="form-check-label" for="pdfBtnEdit">
                PDF
              </label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="radio" name="popupTypeEdit" id="linkBtnEdit" value="link">
              <label class="form-check-label" for="linkBtnEdit">
                List of links
              </label>
            </div>
          </div>
        </fieldset>
        <div class="uploadContainerEdit">
          <div class="uploadDivEdit" id="pdfUploadEdit" style="display:none">
            <input type="file" id="pdfFileEdit" accept ="application/pdf" hidden/>
            <label for="pdfFileEdit">Choose PDF</label>
            <span id="pdfChosenEdit">No file chosen</span>
          </div>
          <div class="uploadDivEdit" id="imageUploadEdit" style="display:none">
            <input type="file" id="imageFileEdit" accept="image/png, image/jpeg" hidden/>
            <label for="imageFileEdit">Choose Image</label>
            <div id="previewDivEdit"></div>
          </div>
          <div class="uploadDivEdit" id="textUploadEdit" style="display:none">
            <input type="text" id="popupTextEdit"/>
            <div class="popup-text-color">
              <span for="popupTextColorEdit" class="form-label">Background Color</span>
              <input type="color" class="form-control form-control-color" id="popupTextColorEdit" value="${popupTextColor}">
            </div>
          </div>
          <div class="uploadDivEdit" id="linkUploadEdit">
            <div id="linkFormEdit">
            </div>
          </div>
        </div>
      </div>
    </div>
  </>`

          let buttonInputTwo = `<div class="gap-3 flex-column border-top pt-3" id="secondBtnDivEdit" style="display:none">
      <div class="row gap-4">
        <div class="col-12">
          <fieldset class="row">
            <legend class="col-form-label col-4 pt-0">Button Type:</legend>
            <div class="col-8">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="buttonTypeEditTwo" id="linkTwo" value="link" onchange="buttonTypeChangeEditTwo(this)" checked>
                <label class="form-check-label" for="linkTwo">
                  Link
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="buttonTypeEditTwo" id="popupTwo" value="popup" onchange="buttonTypeChangeEditTwo(this)" >
                <label class="form-check-label" for="popupTwo">
                  Popup
                </label>
              </div>
            </div>
        </fieldset>
      </div>
      <div class="col-12">
        <input type="text" class="form-control" id="btnNameEditTwo" placeholder="Name" value="${btnNameTwo}">
      </div>
      <div class="col-12" id="linkDivEditTwo" style="display:block">
        <input type="text" class="form-control" id="btnLinkIdEditTwo" placeholder="Link" value="${linkTwo}">
      </div>
      <div class="col-12">
        <div class="row align-items-center">
        <label for="colorPickerIdEditTwo" class="form-label col-6">Choose background Color</label>
        <div class="col-4">
          <input type="color" class="form-control form-control-color" id="btnColorPickerEditTwo" value="${bgColorTwo}">
        </div>
      </div>
      </div>
      <div class="col-12">
        
    <fieldset class="row mb-2 mt-2">
      <legend class="col-form-label col-sm-2 pt-0">Position:</legend>
      <div class="col-sm-10">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="btnPositionEditTwo" id="leftTwo" value="left">
          <label class="form-check-label" for="leftTwo">
            Left
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="btnPositionEditTwo" id="centerTwo" value="center" checked>
          <label class="form-check-label" for="centerTwo">
            Center
          </label>
        </div>

        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="btnPositionEditTwo" id="rightTwo" value="right">
          <label class="form-check-label" for="rightTwo">
            Right
          </label>
        </div>
      </div>
    </fieldset>
      </div>
    </div>
    <div id="popupDivEditTwo" style="display:none">
    <fieldset class="row mb-2 mt-2">
      <legend class="col-form-label col-sm-2 pt-0">Location:</legend>
      <div class="col-sm-10">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="btnLocationEditTwo" id="headerTwo" value="header">
          <label class="form-check-label" for="headerTwo">
            Header
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="btnLocationEditTwo" id="bodyTwo" value="body" checked>
          <label class="form-check-label" for="bodyTwo">
            Body
          </label>
        </div>
      </div>
    </fieldset>

    <fieldset class="row mb-2 mt-2">
      <legend class="col-form-label col-sm-2 pt-0">Content:</legend>
      <div class="col-sm-10">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="popupTypeEditTwo" id="textBtnEditTwo" value="text">
          <label class="form-check-label" for="textBtnEditTwo">
            Text
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="popupTypeEditTwo" id="imageBtnEditTwo" value="image" checked>
          <label class="form-check-label" for="imageBtnEditTwo">
            Image
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="popupTypeEditTwo" id="pdfBtnEditTwo" value="pdf">
          <label class="form-check-label" for="pdfBtnEditTwo">
            PDF
          </label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="popupTypeEditTwo" id="linkBtnEditTwo" value="link">
          <label class="form-check-label" for="linkBtnEditTwo">
            List of links
          </label>
        </div>
      </div>
    </fieldset>
    <div class="uploadContainerEditTwo">
      <div class="uploadDivEditTwo" id="pdfUploadEditTwo" style="display:none">
        <input type="file" id="pdfFileEditTwo" accept ="application/pdf" hidden/>
        <label for="pdfFileEditTwo">Choose PDF</label>
        <span id="pdfChosenEditTwo">No file chosen</span>
      </div>
      <div class="uploadDivEditTwo" id="imageUploadEditTwo" style="display:none">
        <input type="file" id="imageFileEditTwo" accept="image/png, image/jpeg" hidden/>
        <label for="imageFileEditTwo">Choose Image</label>
        <div id="previewDivEditTwo"></div>
      </div>
      <div class="uploadDivEditTwo" id="textUploadEditTwo" style="display:none">
        <input type="text" id="popupTextEditTwo"/>
        <div class="popup-text-color">
          <span for="popupTextColorEditTwo" class="form-label">Background Color</span>
          <input type="color" class="form-control form-control-color" id="popupTextColorEditTwo" value="${popupTextColorTwo}">
        </div>
      </div>
      <div class="uploadDivEditTwo" id="linkUploadEditTwo">
        <div id="linkFormEditTwo">
        </div>
      </div>
    </div>
  </div>
</div>
</div>`

    let menuBtnsElem="";

    if(btnCount === "menu"){
                    
                    menuButtonData.forEach((e,i)=>{
                      menuBtnsElem+=`<div class="menu-btns ${i !== 0 ? "mt-3":""}">
                        <form class="row gap-3" class="menuBtnForm" id="menuBtnEdit${i}">
                         <div class="col-12">
                              <input type="text" class="form-control" name="btnName" placeholder="Name" value="${e.btnName}">
                            </div>
                            <div class="col-12">
                              <input type="text" class="form-control" name="link" placeholder="Link" value="${e.link}">

                            </div>
                            
                          </form>
                          ${ i == 0 ?` <div class="add-more-btn">
                              <button type="button" id="addMoreMenuBtnEdit" onclick="addMoreBtnEdit()">
                                <i class="fa-solid fa-plus"></i>
                              </button>
                            </div>`
                             :
                             `<div class="delete-menu-btn">
                              <button type="button" onclick="deleteMenuBtnEdit(this)">
                                <i class="fa-solid fa-minus"></i>
                              </button>
                            </div>`
                          }
                        </div> ` 
                    })
            }

                
            let leftMenuBtnData = [];
            let rightMenuBtnData = [];
            let centerMenuBtnData = [];

            if(btnCount === "menu"){
              menuButtonData.forEach((e)=>{
                if(e.position === "left"){
                  leftMenuBtnData.push(e)
                }else if(e.position === "center"){
                  centerMenuBtnData.push(e);
                }else if(e.position === "right"){
                  rightMenuBtnData.push(e);
                }
              })
            }

              let leftMenuElem = "";
              let rightMenuElem = "";
              let centerMenuElem = "";

              if(leftMenuBtnData.length === 0){
                leftMenuElem = `<div class="link-menu menu-value-fields">
                          <form class="row gap-3" class="menuBtnForm">
                            <div class="col-12">
                                <input type="text" class="form-control" name="btnName" placeholder="Name">
                            </div>
                            <div class="col-12">
                              <input type="text" class="form-control" name="link" placeholder="Link">
                            </div>
                          </form>
                        </div>
                        <div class="drop-down-menu menu-value-fields" style="display:none">
                          <div class="menu-btns">
                              <div class="drop-down-label">
                                  <input type="text" class="form-control" id="leftDropDownNameEdit" name="btnName" placeholder="Name">
                              </div>
                            <div class="add-more-btn">
                              <button type="button" id="leftAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('left')">
                                <i class="fa-solid fa-plus"></i>
                              </button>
                            </div>
                          </div>
                        </div>`
              }else{
                    leftMenuBtnData.forEach((e)=>{
                        if(e.type === "link"){
                          leftMenuElem = `<div class="link-menu menu-value-fields">
                            <form class="row gap-3" class="menuBtnForm">
                        <div class="col-12">
                            <input type="text" class="form-control" name="btnName" placeholder="Name" value="${e['links'][0].btnName}">
                        </div>
                        <div class="col-12">
                          <input type="text" class="form-control" name="link" placeholder="Link" value="${e['links'][0].link}">
                        </div>
                      </form>
                    </div>
                    <div class="drop-down-menu menu-value-fields" style="display:none">
                      <div class="menu-btns">
                          <div class="drop-down-label">
                              <input type="text" class="form-control" id="leftDropDownNameEdit" name="btnName" placeholder="Name">
                          </div>
                        <div class="add-more-btn">
                          <button type="button" id="leftAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('left')">
                            <i class="fa-solid fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </div>`
                  }else if(e.type === "dropDown"){
                    let dropDownElem = "";

                    e.links.forEach((l,i)=>{
                      dropDownElem += `<div class="menu-btns mt-3">
                            <form class="row gap-3" class="menuBtnForm">
                            <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name" value="${l.btnName}">
                                </div>
                                <div class="col-12">
                                  <input type="text" class="form-control" name="link" placeholder="Link" value="${l.link}">
                                </div>
                              </form>
                                <div class="delete-menu-btn">
                                  <button type="button" onclick="deleteMenuBtnEdit(this,'left')">
                                    <i class="fa-solid fa-minus"></i>
                                  </button>
                                </div>
                                </div>`
                    })

                    leftMenuElem = `<div class="link-menu menu-value-fields" style="display:none">
                      <form class="row gap-3" class="menuBtnForm">
                        <div class="col-12">
                            <input type="text" class="form-control" name="btnName" placeholder="Name">
                        </div>
                        <div class="col-12">
                          <input type="text" class="form-control" name="link" placeholder="Link">
                        </div>
                      </form>
                    </div>
                    <div class="drop-down-menu menu-value-fields">
                      <div class="menu-btns">
                        <div class="drop-down-label">
                            <input type="text" class="form-control" id="leftDropDownNameEdit" name="btnName" placeholder="Name" value="${e.label}">
                        </div>
                        <div class="add-more-btn">
                          <button type="button" id="leftAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('left')">
                            <i class="fa-solid fa-plus"></i>
                          </button>
                        </div>
                      </div>
                      ${dropDownElem}
                    </div>`
                  }
                })
                }
                
                if(rightMenuBtnData.length === 0){
                  rightMenuElem = `<div class="link-menu menu-value-fields">
                            <form class="row gap-3" class="menuBtnForm">
                              <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name">
                              </div>
                              <div class="col-12">
                                <input type="text" class="form-control" name="link" placeholder="Link">
                              </div>
                            </form>
                          </div>
                          <div class="drop-down-menu menu-value-fields" style="display:none">
                            <div class="menu-btns">
                                <div class="drop-down-label">
                                    <input type="text" class="form-control" id="rightDropDownNameEdit" name="btnName" placeholder="Name">
                                </div>
                              <div class="add-more-btn">
                                <button type="button" id="rightAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('right')">
                                  <i class="fa-solid fa-plus"></i>
                                </button>
                              </div>
                            </div>
                          </div>`
                }else{ 
                    rightMenuBtnData.forEach((e)=>{
                        if(e.type === "link"){
                          rightMenuElem = `<div class="link-menu menu-value-fields">
                            <form class="row gap-3" class="menuBtnForm">
                              <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name" value="${e['links'][0].btnName}">
                              </div>
                              <div class="col-12">
                                <input type="text" class="form-control" name="link" placeholder="Link" value="${e['links'][0].link}">
                              </div>
                            </form>
                          </div>
                          <div class="drop-down-menu menu-value-fields" style="display:none">
                            <div class="menu-btns">
                                <div class="drop-down-label">
                                    <input type="text" class="form-control" id="rightDropDownNameEdit" name="btnName" placeholder="Name">
                                </div>
                              <div class="add-more-btn">
                                <button type="button" id="rightAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('right')">
                                  <i class="fa-solid fa-plus"></i>
                                </button>
                              </div>
                            </div>
                          </div>`
                  }else if(e.type === "dropDown"){
                    let dropDownElem = "";
                    e.links.forEach((l,i)=>{
                      dropDownElem += `<div class="menu-btns mt-3">
                            <form class="row gap-3" class="menuBtnForm">
                            <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name" value="${l.btnName}">
                                </div>
                                <div class="col-12">
                                  <input type="text" class="form-control" name="link" placeholder="Link" value="${l.link}">
                                </div>
                              </form>
                                <div class="delete-menu-btn">
                                  <button type="button" onclick="deleteMenuBtnEdit(this,'right')">
                                    <i class="fa-solid fa-minus"></i>
                                  </button>
                                </div>
                                </div>`
                    })

                    rightMenuElem = `<div class="link-menu menu-value-fields" style="display:none">
                      <form class="row gap-3" class="menuBtnForm">
                        <div class="col-12">
                            <input type="text" class="form-control" name="btnName" placeholder="Name">
                        </div>
                        <div class="col-12">
                          <input type="text" class="form-control" name="link" placeholder="Link">
                        </div>
                      </form>
                    </div>
                    <div class="drop-down-menu menu-value-fields" >
                      <div class="menu-btns">
                        <div class="drop-down-label">
                            <input type="text" class="form-control" id="rightDropDownNameEdit" name="btnName" placeholder="Name" value="${e.label}">
                        </div>
                        <div class="add-more-btn">
                          <button type="button" id="rightAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('right')">
                            <i class="fa-solid fa-plus"></i>
                          </button>
                        </div>
                      </div>
                      ${dropDownElem}
                    </div>`
                  }
                }) 
                }
               
              
                if(centerMenuBtnData.length === 0){
                  centerMenuElem = `<div class="link-menu menu-value-fields">
                            <form class="row gap-3" class="menuBtnForm">
                              <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name">
                              </div>
                              <div class="col-12">
                                <input type="text" class="form-control" name="link" placeholder="Link">
                              </div>
                            </form>
                          </div>
                          <div class="drop-down-menu menu-value-fields" style="display:none">
                            <div class="menu-btns">
                                <div class="drop-down-label">
                                    <input type="text" class="form-control" id="centerDropDownNameEdit" name="btnName" placeholder="Name">
                                </div>
                              <div class="add-more-btn">
                                <button type="button" id="centerAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('center')">
                                  <i class="fa-solid fa-plus"></i>
                                </button>
                              </div>
                            </div>
                          </div>`
                }else{
                  centerMenuBtnData.forEach((e)=>{
                  if(e.type === "link"){
                    centerMenuElem = `<div class="link-menu menu-value-fields">
                      <form class="row gap-3" class="menuBtnForm">
                        <div class="col-12">
                            <input type="text" class="form-control" name="btnName" placeholder="Name" value="${e['links'][0].btnName}">
                        </div>
                        <div class="col-12">
                          <input type="text" class="form-control" name="link" placeholder="Link" value="${e['links'][0].link}">
                        </div>
                      </form>
                    </div>
                    <div class="drop-down-menu menu-value-fields" style="display:none">
                      <div class="menu-btns">
                          <div class="drop-down-label">
                              <input type="text" class="form-control" id="centerDropDownNameEdit" name="btnName" placeholder="Name">
                          </div>
                        <div class="add-more-btn">
                          <button type="button" id="centerAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('center')">
                            <i class="fa-solid fa-plus"></i>
                          </button>
                        </div>
                      </div>
                    </div>`
                  }else if(e.type === "dropDown"){
                    let dropDownElem = "";

                    e.links.forEach((l,i)=>{
                      dropDownElem += `<div class="menu-btns mt-3">
                            <form class="row gap-3" class="menuBtnForm">
                            <div class="col-12">
                                  <input type="text" class="form-control" name="btnName" placeholder="Name" value="${l.btnName}">
                                </div>
                                <div class="col-12">
                                  <input type="text" class="form-control" name="link" placeholder="Link" value="${l.link}">
                                </div>
                              </form>
                                <div class="delete-menu-btn">
                                  <button type="button" onclick="deleteMenuBtnEdit(this,'center')">
                                    <i class="fa-solid fa-minus"></i>
                                  </button>
                                </div>
                                </div>`
                    })

                    centerMenuElem = `<div class="link-menu menu-value-fields" style="display:none">
                      <form class="row gap-3" class="menuBtnForm">
                        <div class="col-12">
                            <input type="text" class="form-control" name="btnName" placeholder="Name">
                        </div>
                        <div class="col-12">
                          <input type="text" class="form-control" name="link" placeholder="Link">
                        </div>
                      </form>
                    </div>
                    <div class="drop-down-menu menu-value-fields">
                      <div class="menu-btns">
                        <div class="drop-down-label">
                            <input type="text" class="form-control" id="centerDropDownNameEdit" name="btnName" placeholder="Name" value="${e.label}">
                        </div>
                        <div class="add-more-btn">
                          <button type="button" id="centerAddMoreMenuBtnEdit" onclick="addMoreBtnEdit('center')">
                            <i class="fa-solid fa-plus"></i>
                          </button>
                        </div>
                      </div>
                      ${dropDownElem}
                    </div>`
                  }
                }) 
                }
               
              
              let menuBtnsDiv=`<div class="menu-btns-conatiner" id="menuBtnsDivEdit" style="display:none">
                   <div class="col-12 my-2">
                          <div class="row align-items-center">
                          <label for="colorPickerId" class="form-label col-6">Background Color</label>
                          <div class="col-4">
                            <input type="color" class="form-control form-control-color" id="menuBgColorEdit" value="${menuBgColor}">
                          </div>
                    </div>
                  </div>
                  <div class="col-12 mb-2">
                      <div class="row align-items-center">
                        <label for="colorPickerId" class="form-label col-6">Font Color:</label>
                        <div class="col-4">
                          <input type="color" class="form-control form-control-color" id="linkFontColorEdit" value="${menuFontColor}">
                        </div>
                      </div>
                  </div>
                   <div class="col-12">
                      <fieldset class="row mb-2 mt-2">
                        <legend class="col-form-label col-4 pt-0">Menu List:</legend>
                        <div class="col-8">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheckEdit" id="leftBtnCheckEdit" onchange="buttonListChangeEdit(this,'left')" value="left">
                            <label class="form-check-label" for="leftBtnCheckEdit">Menu One</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheckEdit" id="centerBtnCheckEdit" onchange="buttonListChangeEdit(this,'center')" value="center">
                            <label class="form-check-label" for="centerBtnCheckEdit">Menu Two</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" type="checkbox" name="btnListCheckEdit" id="rightBtnCheckEdit" onchange="buttonListChangeEdit(this,'right')" value="right">
                            <label class="form-check-label" for="rightBtnCheckEdit">Menu Three</label>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                  <div class="col-12">
                          <fieldset class="row mb-2 mt-2">
                            <legend class="col-form-label col-4 pt-0">Menu Position in Page:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline buttons-check-div">
                                <input class="form-check-input" type="radio" name="menuBtnPositionEdit" onchange="menuPositionChangeEdit(this)" id="leftMenuEdit" value="left">
                                <label class="form-check-label" for="leftMenuEdit">
                                  Left
                                </label>
                              </div>
                              <div class="form-check form-check-inline buttons-check-div">
                                <input class="form-check-input" type="radio" name="menuBtnPositionEdit" onchange="menuPositionChangeEdit(this)" id="centerMenuEdit" value="center">
                                <label class="form-check-label" for="centerMenuEdit">
                                  Center
                                </label>
                              </div>
                              <div class="form-check form-check-inline buttons-check-div">
                                <input class="form-check-input" type="radio" name="menuBtnPositionEdit" onchange="menuPositionChangeEdit(this)" id="rightMenuEdit" value="right">
                                <label class="form-check-label" for="rightMenuEdit">
                                  Right
                                </label>
                              </div>
                            </div>
                          </fieldset>
                        </div>
                        <div class="links-container-edit" id="leftMenuListEdit" style="display:none">
                          <fieldset class="row mb-2 mt-2">
                            <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="leftMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'left')" id="LeftMenuLinkEdit" value="link" checked>
                                <label class="form-check-label" for="LeftMenuLinkEdit">
                                  Main Menu
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="leftMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'left')" id="leftMenuDropDownEdit" value="dropDown">
                                <label class="form-check-label" for="leftMenuDropDownEdit">
                                 Sub Menu
                                </label>
                              </div>
                            </div>
                          </fieldset>
                          ${leftMenuElem}
                        </div> 

                        <div class="links-container-edit" id="centerMenuListEdit" style="display:none">
                          <fieldset class="row mb-2 mt-2">
                            <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="centerMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'center')" id="centerMenuLinkEdit" value="link" checked>
                                <label class="form-check-label" for="centerMenuLinkEdit">
                                  Main Menu
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="centerMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'center')" id="centerMenuDropDownEdit" value="dropDown">
                                <label class="form-check-label" for="centerMenuDropDownEdit">
                                  Sub Menu
                                </label>
                              </div>
                            </div>
                          </fieldset>
                            ${centerMenuElem}
                        </div> 

                        <div class="links-container-edit" id="rightMenuListEdit" style="display:none">
                          <fieldset class="row mb-2 mt-2">
                            <legend class="col-form-label col-4 pt-0">Menu Type:</legend>
                            <div class="col-8">
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="rightMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'right')" id="rigtMenuLinkEdit" value="link" checked>
                                <label class="form-check-label" for="rigtMenuLinkEdit">
                                  Main Menu
                                </label>
                              </div>
                              <div class="form-check form-check-inline">
                                <input class="form-check-input" type="radio" name="rightMenuTypeEdit" onchange="MenuTypeChangeEdit(this,'right')" id="rightMenuDropDownEdit" value="dropDown">
                                <label class="form-check-label" for="rightMenuDropDownEdit">
                                  Sub Menu
                                </label>
                              </div>
                            </div>
                          </fieldset>
                          ${rightMenuElem}
                      </div>
                </div>`


                    let menuBtnCount = menuButtonData?.length;

                    addMoreBtnEdit = (elem)=>{
                      let menuAddElem=`<div class="menu-btns mt-3">
                        <form class="row gap-3" class="menuBtnForm">
                         <div class="col-12">
                              <input type="text" class="form-control" name="btnName" placeholder="Name">
                            </div>
                            <div class="col-12">
                              <input type="text" class="form-control" name="link" placeholder="Link">
                            </div>
                          </form>
                            <div class="delete-menu-btn">
                              <button type="button" onclick="deleteMenuBtnEdit(this,'${elem}')">
                                <i class="fa-solid fa-minus"></i>
                              </button>
                            </div>
                             </div>`
          
                      let formsLength = $(`#${elem}MenuListEdit .drop-down-menu .menu-btns`).length;
                      if(formsLength <=10){
                        $(`#${elem}MenuListEdit .drop-down-menu`).append(menuAddElem);
                      }else{
                        $(`#${elem}AddMoreMenuBtnEdit`).css("pointer-events", "none");
                        $(`#${elem}AddMoreMenuBtnEdit`).css("opacity", "0.4");
                      }
                      menuBtnCount+=1;
                  
                    } 
                    
            deleteMenuBtnEdit = (elem,position)=>{
              $(elem).closest('.menu-btns').remove();
              $(`#${position}AddMoreMenuBtnEdit`).css("pointer-events", "auto");
              $(`#${position}AddMoreMenuBtnEdit`).css("opacity", "1");
            }

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = parentId;
          mainDiv.innerHTML = buttonInput;
          mainDiv.innerHTML += buttonInputTwo;
          if(btnCount === "menu"){
            mainDiv.innerHTML += menuBtnsDiv;
          }
          modalBody.appendChild(mainDiv);

          $(`#${menusList[0]}MenuListEdit`).css("display","block");

          menuPositionChangeEdit = (elem)=>{
            let menuPosition = $(elem).val();
            $(".links-container-edit").css("display","none");
            if(menuPosition === "left"){
              $("#leftMenuListEdit").css("display","block");
            }else if(menuPosition === "center"){
              $("#centerMenuListEdit").css("display","block");
            }else if(menuPosition === "right"){
             $("#rightMenuListEdit").css("display","block");
            }
          }

          $(".buttons-check-div").css("pointer-events", "none");
          $(".buttons-check-div").css("opacity", "0.4");

          menusList.forEach((menu)=>{
            $(`input[name='btnListCheckEdit'][value='${menu}']`).prop("checked", true);
            $(`#${menu}MenuEdit`).parent().css("pointer-events", "auto");
            $(`#${menu}MenuEdit`).parent().css("opacity", "1");
          })

          buttonListChangeEdit = (elem,pos) =>{
            if ($(`#${elem.id}`).is(":checked") == false){
              $(`#${pos}MenuEdit`).parent().css("pointer-events", "none");
              $(`#${pos}MenuEdit`).parent().css("opacity", "0.4");
            }else{
              $(`#${pos}MenuEdit`).parent().css("pointer-events", "auto");
              $(`#${pos}MenuEdit`).parent().css("opacity", "1");
            }   
          }

          MenuTypeChangeEdit = (elem,position)=>{
            let menuType = $(elem).val();
            $(`#${position}MenuListEdit .menu-value-fields`).css("display","none");
            if(menuType === "link"){
              $(`#${position}MenuListEdit .link-menu`).css("display","block");
            }else if(menuType === "dropDown"){
              $(`#${position}MenuListEdit .drop-down-menu`).css("display","block");
            }
          }

          menuButtonData.forEach((btn)=>{
            if(btn.position === "left"){
              $(`input[name=leftMenuTypeEdit][value=${btn.type}]`).prop("checked", true);
            }else if(btn.position === "center"){
              $(`input[name=centerMenuTypeEdit][value=${btn.type}]`).prop("checked", true);
            }else if(btn.position === "right"){
              $(`input[name=rightMenuTypeEdit][value=${btn.type}]`).prop("checked", true);
            }
          })

      menusList.map((elem)=>{
        let formsLength = $(`#${elem}MenuListEdit .drop-down-menu .menu-btns`).length;
        if(formsLength >= 10){
          $(`#${elem}AddMoreMenuBtnEdit`).css("pointer-events", "none");
          $(`#${elem}AddMoreMenuBtnEdit`).css("opacity", "0.4");
        }
      })

          if(btnCount === "menu"){
            $(`input[name=menuBtnPositionEdit][value=${menuPosition}]`).prop("checked", true);
            $("#oneBtnOptionEdit").css("pointer-events", "none");
            $("#oneBtnOptionEdit").css("opacity", "0.4");
            $("#twoBtnOptionEdit").css("pointer-events", "none");
            $("#twoBtnOptionEdit").css("opacity", "0.4");
          }else{
            $("#menuBtnOptionEdit").css("pointer-events", "none");
            $("#menuBtnOptionEdit").css("opacity", "0.4");
          }

          changeToRichtext([`popupTextEdit`]);
          CKEDITOR.instances[`popupTextEdit`].setData(popupText);

          changeToRichtext([`popupTextEditTwo`]);
          CKEDITOR.instances[`popupTextEditTwo`].setData(popupTextTwo);

          //button two set values
          if (btnCount === "two") {
            $("#secondBtnDivEdit").css("display", "flex");
            $("#menuBtnsDivEdit").css("display", "none");
            $(`input[name=btnLocationEdit][value=header]`).parent().css("pointer-events", "none");
            $(`input[name=btnLocationEdit][value=header]`).parent().css("opacity", "0.4");
            $(`input[name=btnLocationEditTwo][value=header]`).parent().css("pointer-events", "none");
            $(`input[name=btnLocationEditTwo][value=header]`).parent().css("opacity", "0.4");
            $(`input[name=btnLocationEdit][value=body]`).prop("checked", true);
            $(`input[name=btnLocationEditTwo][value=body]`).prop("checked", true);

            if (popupTypeTwo !== "link") {
              let firstFormTwo = `  <form class="input-div">
                              <div class="links">
                                <input type='text' class="form-control" name='name' placeholder="Name">
                                <input type="text" class="form-control" name="link" placeholder="Link">
                              </div>
                              <div class="btn-div">
                                <button type="button" id="addInputFieldButtonEditTwo" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
                              </div>
                            </form> `;
              $("#linkFormEditTwo").html(firstFormTwo);
              $("#linkUploadEditTwo").css("display", "none");
            }

            if (btnTypeTwo === "link") {
              $("#imageUploadEditTwo").css("display", "flex");
            }
          }

          if(btnCount==="menu"){
            $("#secondBtnDivEdit").css("display", "none");
            $("#menuBtnsDivEdit").css("display", "block");
            $("#firstBtnDivEdit").css("display", "none");
            
          }

          //button count option set value  
          $(`input[name=buttonCountEdit][value=${btnCount}]`).prop("checked", true);

          //Button count change
          buttonCountChangeEdit = (elem) => {
            let btnCountOptionEdit = $(elem).val();
            if (btnCountOptionEdit === "one") {
              $("#firstBtnDivEdit").css("display", "flex");
              $("#secondBtnDivEdit").css("display", "none");
              $("#menuBtnsDivEdit").css("display", "none");
              if(btnType === "popup"){
                $("#imageUploadEdit").css("display","block");
              }
              $("#secondBtnDivEdit").css("display", "none");
              $(`input[name=btnLocationEdit][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocationEdit][value=header]`).parent().css("opacity", "1");
              $(`input[name=btnLocationEditTwo][value=header]`).parent().css("pointer-events", "auto");
              $(`input[name=btnLocationEditTwo][value=header]`).parent().css("opacity", "1");
            } else if(btnCountOptionEdit === "two") {
              $("#secondBtnDivEdit").css("display", "flex");
              $("#firstBtnDivEdit").css("display", "flex");
              $("#menuBtnsDivEdit").css("display", "none");
              $(`input[name=btnLocationEdit][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocationEdit][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocationEditTwo][value=header]`).parent().css("pointer-events", "none");
              $(`input[name=btnLocationEditTwo][value=header]`).parent().css("opacity", "0.4");
              $(`input[name=btnLocationEdit][value=body]`).prop("checked", true);
              $(`input[name=btnLocationEditTwo][value=body]`).prop("checked", true);
            }else if(btnCountOptionEdit === "menu"){
              $("#firstBtnDivEdit").css("display", "none");
              $("#secondBtnDivEdit").css("display", "none");
              $("#menuBtnsDivEdit").css("display", "block");
            }
          }

          if(btnCount !== "menu"){  
          if (popupType !== "link") {
            let firstForm = `  <form class="input-div">
                  <div class="links">
                    <input type='text' class="form-control" name='name' placeholder="Name">
                    <input type="text" class="form-control" name="link" placeholder="Link">
                  </div>
                  <div class="btn-div">
                    <button type="button" id="addInputFieldButtonEdit" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>
                  </div>
                </form> `;
            $("#linkFormEdit").html(firstForm);

            $("#linkUploadEdit").css("display", "none")
          }

          if (btnType === "link") {
            $("#imageUploadEdit").css("display", "flex")
          }
        }

          var linkBtnOption = document.getElementById('linkBtnEdit');
          var imageBtnOption = document.getElementById('imageBtnEdit');
          var pdfBtnOption = document.getElementById('pdfBtnEdit');
          var textBtnOption = document.getElementById('textBtnEdit');

          linkBtnOption.onclick = popupChangeEditFn;
          imageBtnOption.onclick = popupChangeEditFn;
          pdfBtnOption.onclick = popupChangeEditFn;
          textBtnOption.onclick = popupChangeEditFn;

          var linkDiv = $("#linkUploadEdit")
          var imageDiv = $("#imageUploadEdit")
          var pdfDiv = $("#pdfUploadEdit")
          var textDiv = $("#textUploadEdit")
          var uploadDiv = $(".uploadDivEdit")

          //Button two elements
          var linkBtnOptionTwo = document.getElementById('linkBtnEditTwo');
          var imageBtnOptionTwo = document.getElementById('imageBtnEditTwo');
          var pdfBtnOptionTwo = document.getElementById('pdfBtnEditTwo');
          var textBtnOptionTwo = document.getElementById('textBtnEditTwo');

          linkBtnOptionTwo.onclick = popupChangeEditTwoFn;
          imageBtnOptionTwo.onclick = popupChangeEditTwoFn;
          pdfBtnOptionTwo.onclick = popupChangeEditTwoFn;
          textBtnOptionTwo.onclick = popupChangeEditTwoFn;

          var linkDivTwo = $("#linkUploadEditTwo")
          var imageDivTwo = $("#imageUploadEditTwo")
          var pdfDivTwo = $("#pdfUploadEditTwo")
          var textDivTwo = $("#textUploadEditTwo")
          var uploadDivTwo = $(".uploadDivEditTwo")

          function popupChangeEditFn() {
            let popupType = $('input[name="popupTypeEdit"]:checked').val()
            $(".popup-error").remove();
            uploadDiv.css("display", "none")
            if (popupType === "link") {
              linkDiv.css("display", "block")
            } else if (popupType === "image") {
              imageDiv.css("display", "flex")
            } else if (popupType === "pdf") {
              pdfDiv.css("display", "block")
            }else if (popupType === "text") {
              textDiv.css("display", "block")
            }
          }

          //Button two popup type change
          function popupChangeEditTwoFn() {
            let popupTypeTwo = $('input[name="popupTypeEditTwo"]:checked').val()
            $(".popup-error-two").remove();
            uploadDivTwo.css("display", "none")
            if (popupTypeTwo === "link") {
              linkDivTwo.css("display", "block")
            } else if (popupTypeTwo === "image") {
              imageDivTwo.css("display", "flex")
            } else if (popupTypeTwo === "pdf") {
              pdfDivTwo.css("display", "block")
            } else if (popupTypeTwo === "text") {
              textDivTwo.css("display", "block")
            }
          }

          buttonTypeChangeEdit = (elem) => {
            let buttonOption = $(elem).val();
            if (buttonOption === "link") {
              $("#popupDivEdit").css("display", "none");
              $("#linkDivEdit").css("display", "block");
            } else if (buttonOption === "popup") {
              $("#linkDivEdit").css("display", "none");
              $("#popupDivEdit").css("display", "block");
              $(`input[name=popupTypeEdit][value=image]`).prop("checked", true);
              $("#imageUploadEdit").css("display","block");
            }
          }

          //Button two type change
          buttonTypeChangeEditTwo = (elem) => {
            let buttonOptionTwo = $(elem).val();
            if (buttonOptionTwo === "link") {
              $("#popupDivEditTwo").css("display", "none");
              $("#linkDivEditTwo").css("display", "block");
            } else if (buttonOptionTwo === "popup") {
              $("#linkDivEditTwo").css("display", "none");
              $("#popupDivEditTwo").css("display", "block");
              $(`input[name=popupTypeEditTwo][value=image]`).prop("checked", true);
              imageDivTwo.css("display", "flex");
            }
          }



          const pdfBtn = document.getElementById('pdfFileEdit');
          const pdfChosen = document.getElementById('pdfChosenEdit');
          pdfBtn.addEventListener('change', function () {
            pdfChosen.textContent = this.files[0].name;
            popupPdf = this.files[0];
          })

          //Button two pdf file select onchange
          const pdfBtnTwo = document.getElementById('pdfFileEditTwo');
          const pdfChosenTwo = document.getElementById('pdfChosenEditTwo');
          pdfBtnTwo.addEventListener('change', function () {
            pdfChosenTwo.textContent = this.files[0].name;
            popupPdfTwo = this.files[0];
          })

          const imageBtn = document.getElementById('imageFileEdit');
          const imageChosen = document.getElementById('imageChosenEdit');
          imageBtn.addEventListener('change', function () {
            $("#imageUploadEdit #previewDivEdit").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImg" />`);
            popupImage = this.files[0];
          })

          //Button two image file select onchange
          const imageBtnTwo = document.getElementById('imageFileEditTwo');
          const imageChosenTwo = document.getElementById('imageChosenEditTwo');
          imageBtnTwo.addEventListener('change', function () {
            $("#imageUploadEditTwo #previewDivEditTwo").html(`<img src=${URL.createObjectURL(this.files[0])} id="uploadedImgTwo" />`);
            popupImageTwo = this.files[0];
          })

          //Button one options value set
          $(`input[name=buttonTypeEdit][value=${btnType == "link" ? "link" : "popup"}]`).prop("checked", true);
          $(`input[name=btnPositionEdit][value="${btnPosition}"]`).prop("checked", true);
          if (btnType === "popup") {
            $(`input[name=btnLocationEdit][value=${btnLocation == "body" ? "body" : "header"}]`).prop("checked", true);
            $(`input[name=popupTypeEdit][value=${popupType}]`).prop("checked", true);
          }

          //Button two options value set
          if (btnCount === "two") {
            $(`input[name=buttonTypeEditTwo][value=${btnTypeTwo}]`).prop("checked", true);
            $(`input[name=btnPositionEditTwo][value=${btnPositionTwo}]`).prop("checked", true);
            if (btnTypeTwo === "popup") {
              $(`input[name=btnLocationEditTwo][value=${btnLocationTwo}]`).prop("checked", true);
              $(`input[name=popupTypeEditTwo][value=${popupTypeTwo}]`).prop("checked", true);
            }
          }

          //Button one popup div hide and show
          if (btnType === "link") {
            $("#popupDivEdit").css("display", "none");
            $("#linkDivEdit").css("display", "block");
          } else if (btnType === "popup") {
            $("#linkDivEdit").css("display", "none");
            $("#popupDivEdit").css("display", "block");
          }

          //Button two popup div hide and show
          if (btnTypeTwo === "link") {
            $("#popupDivEditTwo").css("display", "none");
            $("#linkDivEditTwo").css("display", "block");
          } else if (btnTypeTwo === "popup") {
            $("#linkDivEditTwo").css("display", "none");
            $("#popupDivEditTwo").css("display", "block");
          }

          //Button one popup input div hide and show
          if (popupType === "link") {
            linkDiv.css("display", "block")
          } else if (popupType === "image") {
            imageDiv.css("display", "flex")
          } else if (popupType === "pdf") {
            pdfDiv.css("display", "block")
          } else if (popupType === "text") {
            textDiv.css("display", "block")
          }

          //Button two popup input div hide and show
          if (popupTypeTwo === "link") {
            linkDivTwo.css("display", "block")
          } else if (popupTypeTwo === "image") {
            imageDivTwo.css("display", "flex")
          } else if (popupTypeTwo === "pdf") {
            pdfDivTwo.css("display", "block")
          } else if (popupTypeTwo === "text") {
            textDivTwo.css("display", "block")
          }

          let inputCount = 0;
          let imageUrl = '';
          let pdfUrl = '';


          if (popupType === 'image') {
            let popupBtnImgUrl = '';
            if(popupImage[0] === undefined){
              if (typeof popupImage === "object") {
                popupBtnImgUrl = URL.createObjectURL(popupImage);
              } else {
                popupBtnImgUrl = popupImage
              }
            }else{
              if (typeof popupImage[0] === "object") {
                popupBtnImgUrl = URL.createObjectURL(popupImage[0]);
              } else {
                popupBtnImgUrl = popupImage[0]
              }
            }
            
            $("#imageUploadEdit #previewDivEdit").html(`<img src=${popupBtnImgUrl} id="uploadedImgEdit" />`);
          } else if (popupType === "pdf") {
            if(typeof popupPdf=== "object"){
              pdfChosen.textContent = popupPdf.name;
            }
          } else if (popupType === 'link') {
            var input = '';

            links.forEach((l, i) => {
              input += `<form class="input-div"> 
                      <div class="links">
                        <input type='text' class="form-control" name='name' placeholder="Name" value="${l.name}">
                        <input type='text' class="form-control" name='link' placeholder="Link" value="${l.link}">
                      </div>
                      <div class="btn-div">
                        ${i == 0 ? `<button type="button" id="addInputFieldButtonEdit" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>`
                                  :
                                  `<button type="button" class="delete-btn" onClick="deleteEditInput(this)"><i class="fa-solid fa-xmark"></i></button>`
                                }

                      </div>
                    </form>`
            })
            $("#linkFormEdit").html(input);
            inputCount += 1;
          }

          // Button two links element
          let inputCountTwo = 0;

          if (popupTypeTwo === 'image') {
            let popupBtnImgUrl = '';
           if(popupImageTwo[0]=== undefined){
              if (typeof popupImageTwo === "object") {
                popupBtnImgUrl = URL.createObjectURL(popupImageTwo);
              } else {
                popupBtnImgUrl = popupImageTwo
              }
            }else{
              if (typeof popupImageTwo[0] === "object") {
                popupBtnImgUrl = URL.createObjectURL(popupImageTwo[0]);
              } else {
                 popupBtnImgUrl = popupImageTwo[0];
              }
            }
            
            $("#imageUploadEditTwo #previewDivEditTwo").html(`<img src=${popupBtnImgUrl} id="uploadedImgEditTwo" />`);
          } else if (popupTypeTwo === "pdf") {
            if(popupPdfTwo[0]===undefined){
              if(typeof popupTypeTwo === "object"){
                pdfChosenTwo.textContent = popupPdfTwo.name;
              }
            }
          } else if (popupTypeTwo === 'link') {
            var inputTwo = '';
            linksTwo.forEach((l, i) => {
              inputTwo += `<form class="input-div"> 
       <div class="links">
         <input type='text' class="form-control" name='name' placeholder="Name" value="${l.name}">
         <input type='text' class="form-control" name='link' placeholder="Link" value="${l.link}">
       </div>
       <div class="btn-div">
         ${i == 0 ? `<button type="button" id="addInputFieldButtonEditTwo" class='add-more-btn'><i class="fa-solid fa-plus"></i></button>`
                  :
                  `<button type="button" class="delete-btn" onClick="deleteEditInputTwo(this)"><i class="fa-solid fa-xmark"></i></button>`
                }

       </div>
     </form>`
            })
            $("#linkFormEditTwo").html(inputTwo);
            inputCountTwo += 1;
          }


          $("#addInputFieldButtonEdit").click(function () {
            var input = $(`<form class="input-div"> 
                            <div class="links">
                              <input type='text' class="form-control" name='name' placeholder="Name">
                              <input type='text' class="form-control" name='link' placeholder="Link">
                            </div>
                            <div class="btn-div">
                              <button type="button" class="delete-btn" onClick="deleteEditInput(this)"><i class="fa-solid fa-xmark"></i></button>
                            </div>
                          </form>`);
            $("#linkFormEdit").append(input);
            inputCount += 1;
          });

          deleteEditInput = (elem) => {
            $(elem).closest('form').remove();
          }

          $("#addInputFieldButtonEditTwo").click(function () {
            var input = $(`<form class="input-div"> 
                            <div class="links">
                              <input type='text' class="form-control" name='name' placeholder="Name">
                              <input type='text' class="form-control" name='link' placeholder="Link">
                            </div>
                            <div class="btn-div">
                              <button type="button" class="delete-btn" onClick="deleteEditInputTwo(this)"><i class="fa-solid fa-xmark"></i></button>
                            </div>
                          </form>`);
            $("#linkFormEditTwo").append(input);
            inputCount += 1;
          });

          deleteEditInputTwo = (elem) => {
            $(elem).closest('form').remove();
          }
        }
        else if (element === "editHeading") {
          $('#editModal').modal('show');
          let { bgColor, heading } = headingArray[`${parentId}`]
          let donorCheck = headingArray[`${parentId}`]['donor']
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText =donorCheck ?"Edit donor header": "Edit Header Band";

          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')
          var div = document.createElement('div')
          div.className = "editHeading"
          div.id = parentId
          var input = document.createElement('input')

          // let parentElem= document.getElementById(id).parentElement

         

          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="headingColorPickerId" value="${bgColor}">
          </div>`

          let colorDiv = document.createElement("div")
          colorDiv.className = "row g-3 mt-2"
          colorDiv.innerHTML = colorPick
          //input.className = "form-control headingClass"
          input.id = "editInput"

          let elemValue = document.getElementById(id)
          div.appendChild(input)
          modalBody.appendChild(div)
          modalBody.appendChild(colorDiv)
          changeToRichtext([`editInput`])
          CKEDITOR.instances[`editInput`].setData(heading);

          let colorInput = document.getElementById(`headingColorPickerId`)
        }
        else if (element === "editImgLink") {

          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Image with Link"


          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }


          var modalBody = document.getElementById('editPageContent')


          const { link, image } = imgLinkContainerArray[`${parentId}`]
          let linkImgUrl = "";
          if (typeof image[0] == "string") {
            linkImgUrl = image[0];
          } else if (typeof image[0] == "object") {
            linkImgUrl = URL.createObjectURL(image[0]);
          }

          let linkInput = `<input class="form-control" type="text" id="imgLinkEditField" onkeyup="validateEditValue(this)" placeholder="Image link" value=${link}>`

          let imgLinkContainer = `<div class="container col-md-12 mt-3">
          <div class="mb-3">
            <input class="form-control" type="file" id="formFileEdit" accept="image/png, image/jpeg" hidden />
            <label class="file-choose-label" for="formFileEdit">Choose Image</label>
            <span id="imageLinkChosenEdit">No image chosen</span>
            </div>
            <img id="linkFormEdit" src=${linkImgUrl} class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `${parentId}`


          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          $("#imageLinkChosenEdit").css("display", "none");

          let imgInputIdEdit = document.getElementById("formFileEdit")
          let imgDivEdit = document.getElementById("linkFormEdit")

          let linkInputElemEdit = document.getElementById("imgLinkEditField")
          let files;

          imgInputIdEdit.addEventListener("change", () => {
            files = event.target.files[0];
            imgDivEdit.src = URL.createObjectURL(files);
            if (updatesClass === "updatesItems") {
              imgLinkContainerArray[`${parentId}`] = { image: files, updates: `updates${updatesId}` }
              tempArray[`${parentId}`] = { type: "9", image: files, updates: `updates${updatesId}` }
            } else {
              imgLinkContainerArray[`${parentId}`] = { image: files }
              tempArray[`${parentId}`] = { type: "9", image: files }
            }

          })

          validateEditValue = (elem) => {
            let linkInputElem = $(elem).val();
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = ValidateUrlExp.test(linkInputElem)
            if (linkUrlValidate === false) {
              if ($(".link-error-edit").length === 0) {
                $(elem).after('<p class="error link-error-edit mt-0">Please enter the valid URL..!</p>')
              }
            } else {
              $(".link-error-edit").remove()
            }
          }

        }
        else if (element === "editDescription") {


          $('#editModal').modal('show');

          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Description"
          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }
          var modalBody = document.getElementById('editPageContent')

          let mainContainer = document.createElement("div")
          mainContainer.id = parentId
          mainContainer.className = "DescClass"

          var input = document.createElement('textarea')
          input.id = "descEditId"

          let descDiv = document.createElement('div')
          descDiv.id = id
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descEditColorPicker" value="#fcfcfc">
          </div>`

          let colorDiv = document.createElement("div")
          colorDiv.className = "row g-3 mt-2"
          colorDiv.innerHTML = colorPick

          descDiv.appendChild(input)

          mainContainer.appendChild(descDiv)
          mainContainer.appendChild(colorDiv)

          modalBody.appendChild(mainContainer)

          const { text, bgColor } = descriptionArray[`${parentId}`]

          changeToRichtext([`descEditId`])

          CKEDITOR.instances[`descEditId`].setData(text);

          let colorInputElem = document.getElementById("descEditColorPicker")
          colorInputElem.value = bgColor

        }
        else if (element === 'editImages') {
          $('#editModal').modal('show');
          var imagesList = imagesContainerArrar[`${parentId}`]
          var imageView = tempArray[`${parentId}`]['imagesView']
          var arrowBgColor = tempArray[`${parentId}`]['arrowBgColor'];

          var imgfiles;

          if (updatesClass === "updatesItems") {
            imgfiles = imagesList['images']
          } else {
            imgfiles = imagesList
          }

          var paramId = id
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Image and Carousel"
          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesClass}_editModal`
          } else {
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgEditCard"
          //
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <fieldset class="row mb-3">
                    <legend class="col-form-label col-sm-4 pt-0">Images View</legend>
                    <div class="col-sm-8">
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageViewEdit" value="normal" onchange="imageTypeEditFn(this)" id="normal">
                        <label class="form-check-label" for="normal">
                          Normal
                        </label>
                      </div>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="imageViewEdit" value="carousel" onchange="imageTypeEditFn(this)" id="carousel">
                        <label class="form-check-label" for="carousel">
                          Carousel
                        </label>
                      </div>
                    </div>
                  </fieldset>
                  <form action="" method="post" class="dragover">
                    <input name="file" type="file" class="file" id="imgInputEdit" multiple accept="image/png, image/jpeg" onchange="imageonChangeEdit(this)" hidden />
                    <label class="file-choose-label" for="imgInputEdit">Choose Image</label>
                    <span id="imageChosenEdit">No image chosen</span>
                  </form>
                  <div class="imgContainerEdit">
                  </div>

                  <div id="bgColorDivEdit" class="row gap-2">
                    <div class="col-12">
                      <div class="row align-items-center">
                        <label for="arrowBgColor" class="form-label col-6">Arrow Background Color</label>
                        <div class="col-4">
                          <input type="color" class="form-control form-control-color" id="arrowBgColorEdit" value="${arrowBgColor}">
                        </div>
                      </div>
                    </div>
                  </div>
                  `

          modalBody.appendChild(cardDiv)
          $("#imageChosenEdit").css("display", "none")
          if (imageView === "carousel") {
            $("#bgColorDivEdit").css("display", "block")
          } else if (imageView === "normal") {
            $("#bgColorDivEdit").css("display", "none")
          }

          imageTypeEditFn = (elem) => {
            let imageTypeOption = $(elem).val();
            if (imageTypeOption === "carousel") {
              $("#bgColorDivEdit").css("display", "block")
            } else if (imageTypeOption === "normal") {
              $("#bgColorDivEdit").css("display", "none")
            }
          }

          var container = document.querySelector('.imgContainerEdit')
          container.id = paramId

          showEditImages = () => {
            let images = '';
            imgfiles.forEach((e, i) => {
              let imgUrl = ""
              if (typeof e === "object") {
                imgUrl = URL.createObjectURL(e)
              } else {
                imgUrl = e
              }

              images += `<div class="image box" draggable="true"">
                        <img src=${imgUrl} alt="img" >
                       <span onclick="delEditImages(${i})"> &times;</span>
                    </div>`
            })


            container.innerHTML = images
          }

          delEditImages = (index) => {
            imgfiles.splice(index, 1)
            showEditImages()
          }

          showEditImages()

          var button = document.querySelector('.top button'),
            form = document.querySelector('form'),

            text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          let files = []
          var inputId = document.getElementById("imgInputEdit")

          imageonChangeEdit = (elem) => {
            let file = elem.files;
            for (let i = 0; i < file.length; i++) {
              if (imgfiles.every(e => e.name !== file[i].name)) {
                imgfiles.push(file[i])
              }

            }

            if (updatesClass == "updatesItems") {
              imagesContainerArrar[`${parentId}`] = { images: imgfiles, updates: `updates${updatesId}` }
              tempArray[`${parentId}`] = { type: "4", images: imgfiles, updates: `updates${updatesId}` }
            } else {
              imagesContainerArrar[`${parentId}`] = imgfiles
              tempArray[`${parentId}`] = { type: "4", images: imgfiles }
            }
            form.reset();
            showEditImages()

          }

          imageId += 1
          showEditImages()
          $(`input[name=imageViewEdit][value=${imageView == "normal" ? "normal" : "carousel"}]`).prop("checked", true);

        }
        else if (element === "editHyperLink") {
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Image(s) with Caption & Link"
          if (updatesClass === "updatesItems") {
            modalTitle.className = `${updatesDivId}_editModal`
          } else {
            modalTitle.className = ""
          }
          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "hyperLinkEdit"
          cardDiv.id = `${parentId}_editModal`

          let { hyperLinkCards } = hyperLinkArray[`${parentId}`]
          let { hyperLinkType } = tempArray[`${parentId}`]

          let imgUrl = ""
          if (typeof hyperLinkCards[0].image[0] === "object") {
            imgUrl = URL.createObjectURL(hyperLinkCards[0].image[0])
          } else {
            imgUrl = hyperLinkCards[0].image[0]
          }

          let editFormContent =
            `<form class="editForm" id="hyperLinkEdit_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">


                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/png, image/jpeg" id="hyperImgEditInput0_id" onchange="imgEditOnchangeFn(event)" hidden />
                    <label class="file-choose-label" for="hyperImgEditInput0_id">Choose Image</label>
                  </div>
                  <div class="hyperImgEditContainer" id="hyperImgEditInput0">
                    <img src=${imgUrl} alt="img" />
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInputEdit0" name="caption" />
                <input class="inputItem form-control mt-2" type="text" name="link" value="${hyperLinkCards[0].link}" />
              </div>
              <div class="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addEditInputs()">+</button>
              </div> 
            </div>
          </form>`

          let typeOptionEdit = `<fieldset class="row mt-2">
            <legend class="col-form-label col-4 pt-0">Visible Type:</legend>
            <div class="col-8">
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkTypeEdit" id="hyperNormal" value="normal">
                <label class="form-check-label" for="hyperNormal">
                  Normal
                </label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="hyperLinkTypeEdit" id="stampCard" value="stampcard">
                <label class="form-check-label" for="stampCard">
                  Stamp Card
                </label>
              </div>
            </div>
          </fieldset>`

          cardDiv.innerHTML = typeOptionEdit;
          cardDiv.innerHTML += editFormContent;

          let editRestContent = "";

          if (hyperLinkCards.length > 1) {
            for (let j = 1; j < hyperLinkCards.length; j++) {
              let hyperImgUrl = ""

              if (typeof hyperLinkCards[j].image[0] === "object") {
                hyperImgUrl = URL.createObjectURL(hyperLinkCards[j].image[0])
              } else {
                hyperImgUrl = hyperLinkCards[j].image[0]
              }
              editRestContent += `<form class="editForm" id="hyperLinkEdit_form${j}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${j}">
                  <div class="formDiv">

                    <div class="hyperLinkModalDivs">
                      <div>
                        <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/png, image/jpeg" id="hyperImgEditInput${j}_id" onchange="imgEditOnchangeFn(event)" hidden />
                        <label class="file-choose-label" for="hyperImgEditInput${j}_id">Choose Image</label>
                      </div>
                      <div class="hyperImgEditContainer" id="hyperImgEditInput${j}">
                        <img src=${hyperImgUrl} alt="img" />
                      </div>
                    </div>

                    <input class="inputItem form-control" type="text" name="caption" id="captionInputEdit${j}" value="${hyperLinkCards[j].caption}" />
                    <input class="inputItem form-control mt-2" type="text" name="link" value="${hyperLinkCards[j].link}" />
                  </div>
                  <div>
                    <button type="button" class="btn btn-danger" name="remove" id="${j}" onClick="removeEditInputs(this,${j})">X</button>
                  </div> 
                </div></form>`
            }
          }

          cardDiv.innerHTML += editRestContent

          modalBody.appendChild(cardDiv)

          changeToRichtext([`captionInputEdit0`])

          for (let k = 1; k < hyperLinkCards.length; k++) {
            changeToRichtext([`captionInputEdit${k}`])
            CKEDITOR.instances[`captionInputEdit${k}`].setData(hyperLinkCards[k].caption);
          }
          CKEDITOR.instances[`captionInputEdit0`].setData(hyperLinkCards[0].caption);

          var l = hyperLinkCards.length - 1;
          var length;

          addEditInputs = () => {

            l++;
            let addContent = `<form class="editForm" id="hyperLinkEdit_form${l}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${l}">
                <div class="formDiv">

                  <div class="hyperLinkModalDivs">
                    <div>
                      <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/png, image/jpeg" id="hyperImgEditInput${i}_id" onchange="imgEditOnchangeFn(event)" hidden />
                      <label class="file-choose-label" for="hyperImgEditInput${i}_id">Choose Image</label>
                    </div>
                    <div class="hyperImgEditContainer" id="hyperImgEditInput${l}">
                      
                    </div>
                  </div>
                  <input class="inputItem form-control" type="text" name="caption" id="captionInputEdit${l}" />
                  <input class="inputItem form-control mt-2" type="text" name="link" />
                </div>
                <div>
                  <button type="button" class="btn btn-danger" name="remove" id="${l}" onClick="removeEditInputs(this,${l})">X</button>
                </div> 
              </div> <p class="error" style="display:none">Please fill the value..!</p> </form>`

            $(".hyperLinkEdit").append(addContent)

            changeToRichtext([`captionInputEdit${l}`])

          }

          removeEditInputs = (e, index) => {
            hyperLinkArray[`${parentId}`]['hyperLinkCards'].splice(index, 1)
            var button_id = e.id
            $('#hyperLinkEdit_form' + button_id).remove();
          }

          imgEditOnchangeFn = (event) => {
            let linkid = event.target.id
            let linkDivId = linkid.split("_")[0]
            let imgDiv = document.getElementById(linkDivId)
            let count = linkDivId.split("").pop()

            if (hyperLinkArray[`${parentId}`]['hyperLinkCards'][`${count}`] !== undefined) {
              hyperLinkArray[`${parentId}`]['hyperLinkCards'][`${count}`].image = [event.target.files[0]]
            }

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }

          $(`input[name=hyperLinkTypeEdit][value=${hyperLinkType == "stampcard" ? "stampcard" : "normal"}]`).prop("checked", true);

        }
        else if (element === "editUpdates") {

          let updatesDivID = parentId.split("").pop()

          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Accordion"

          var modalBody = document.getElementById('editPageContent')

          const { heading, bgColor, show } = updatesArray[`${parentId}`]

          let updatesElem = `
            <input type="text" class="form-control" placeholder="Enter title" id="updatesHeadingEdit" value="${heading}" />
            <div class="bgDiv">
              <input type="color" id="bgColorEdit" class="updatesBgColor form-control form-control-color" value="${bgColor}" />
              <label for="bgColor" class="form-check-label">Background Color</label>
            </div>
            
            <div class="mb-3 form-check">
              <label for="show" class="form-check-label">Show</label>
              <input type="checkbox" class="form-check-input" id="showEdit" name="show" value="show" />
            </div>
          `
          let mainContainer = document.createElement("div")
          mainContainer.className = 'updatesDiv'
          mainContainer.id = `updatesDivContainer${updatesDivID}_modal`
          mainContainer.innerHTML = updatesElem

          modalBody.append(mainContainer)

          changeToRichtext([`updatesHeadingEdit`])
          CKEDITOR.instances[`updatesHeadingEdit`].setData(heading);

          document.getElementById("showEdit").checked = show;

        }
        const errors = document.querySelectorAll('.error');

        errors.forEach(error => {
          error.remove();
        });
      }

      // Update Function
      function updateElement() {
        var modalBody = document.getElementById('editPageContent')
        let updatesClassName = document.getElementById("EditPageTitle").className.split("_")[0]
        let regex = /\d/g;
        let updatesClass = updatesClassName.replace(regex, "");

        var numb = updatesClassName?.match(/\d/g);
        numb = numb?.join("");
        let updatesId = numb


        if (modalBody.children[0].className === "formClassEdit") {
          var formDivClass = document.getElementsByClassName("formClassEdit")[0]
          var quizArraykey = modalBody.children[0].id

          let updateId = document.querySelector(".quizEditDiv").id

          var updatedElement = document.getElementById(updateId)
          var formElem = document.getElementById("formId");
          const data = Object.fromEntries(new FormData(formDivClass).entries());

          let quizObject;
          let quiz = data
          if (updatesClass === "updatesItems") {
            quizContainerArray[`${quizArraykey}`] = { quiz, updates: `updates${updatesId}` }
            quizObject = quizContainerArray[`${quizArraykey}`]['quiz']
            tempArray[`${quizArraykey}`] = { type: "7", quiz: quizObject, updates: `updates${updatesId}` }

          } else {
            quizContainerArray[`${quizArraykey}`] = { quiz: data };

            quizObject = quizContainerArray[`${quizArraykey}`]['quiz']

            tempArray[`${quizArraykey}`] = { type: "7", quiz: quizObject }
          }

          const { question, answer, ...rest } = quizObject

          var options = ""
          let value = [];
          for (var property in rest) {
            if (rest[property] !== "") {
              options += `<label class="options">${rest[property]}
                <input type="radio" name="radio" value=${rest[property]}/>
                <span class="checkmark"></span>
            </label>`

              value.push(rest[property])
            }
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" value=${quizObject['answer']} />
          </div>`


          const quizHtml = `<div class="container my-1">
                <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                    <div class="py-2 h5"><b>Q. ${question}</b></div>
                    <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                       ${options}
                    </div>
                </div>
            </div>`

          if (answer !== "" && value.length >= 2 && question !== "") {
            $('#editModal').modal('hide');
            updatedElement.innerHTML = quizHtml
          } else {
            let qstnElem = document.querySelector(`.formClassEdit #question${quizId}`)
            let optionOneElem = document.querySelector(`.formClassEdit #option0`)
            let optionTwoElem = document.querySelector(`.formClassEdit #option3`)
            let answerElem = document.querySelector(`.formClassEdit #answer`)

            let errorQstn = document.querySelector(".qstnerror")
            let errorOptn = document.querySelector(".optnerror")
            let errorAns = document.querySelector(".anserror")

            if (qstnElem.value === "") {
              if (!errorQstn) {
                qstnElem.insertAdjacentHTML('afterend', '<p class="error qstnerror">Please enter the question...!</p>');
              }

            } else {
              if (errorQstn) {
                errorQstn.remove()
              }
            }
            if (value.length < 2) {
              if (!errorOptn) {
                optionTwoElem.parentElement.insertAdjacentHTML('afterend', '<p class="error optnerror">Please enter atleast two options...!</p>');
              }

            } else {
              if (errorOptn) {
                errorOptn.remove()
              }
            }
            if (answerElem.value === "") {
              if (!errorAns) {
                answerElem.insertAdjacentHTML('afterend', '<p class="error anserror">Please enter the answer...!</p>');
              }
            } else {
              if (errorAns) {
                errorAns.remove()
              }
            }
          }

        }
        else if (modalBody.children[0].className === "videoCard") {

          let videoType = $('input[name="videoTypeEdit"]:checked').val();
          let videoLink=$("#videoLinkInputEdit").val();

          var updatedElement = modalBody.children[0].id
          var editedElement = document.querySelector(".videoModalContainerEdit")

         
          tempArray[`${updatedElement}`]={...tempArray[`${updatedElement}`],videoType}

          $(".video-link-error").remove();
          $(".thumbnail-error").remove();

          let videoPopupElem="";

          if(videoType === "link"){
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)
            if(thumbnailImage ==""){
              $("#videoThumbnailEdit").after('<p class="error thumbnail-error">Please Upload the image.</p>');
            }
            if(videoLink !== "" && linkUrlValidate){
              if(thumbnailImage !==""){
                let thumbnailEditURL="";
                if(thumbnailImage[0] === undefined){
                if( typeof thumbnailImage === "object"){
                  thumbnailEditURL = URL.createObjectURL(thumbnailImage)
                }else{
                  thumbnailEditURL = thumbnailImage;
                }
              }else{
                if( typeof thumbnailImage[0] === "object"){
                  thumbnailEditURL = URL.createObjectURL(thumbnailImage[0])
                }else{
                  thumbnailEditURL = thumbnailImage[0];
                }
              }
              console.log(thumbnailEditURL,"url")
                videoPopupElem=  `<div class="video-thumbnail" onclick="videoPopupOpenEdit(this)" id="video_${updatedElement}">
                                        <img src="${thumbnailEditURL}" alt="" />
                                        <span><i class="fa-regular fa-circle-play"></i></span>
                                    </div>`
              }
            }else{
              $("#videoLinkInputEdit").after('<p class="error video-link-error">Please enter the valid URL.</p>');
            }
          }

          var videoSrc;
          let updateName = "";
          if (updatesClass === "updatesItems") {
            if(videoType === 'upload'){
              videoSrc = videoContainerArrary[updatedElement]['files']
              }
            let updateClassName = document.querySelector('#createModal .modal-header h5').className;
            updateClassName= updateClassName.split("_")[0];
            var updateNum = updateClassName?.match(/\d/g);
            updateNum = updateNum?.join("");
            updateName = `updates${updateNum}`;
          } else {
              if(videoType === 'upload'){
                videoSrc = videoContainerArrary[updatedElement]                    
            }
          }
          let uploadVideoElem;

          if(videoType === "link"){
            document.getElementById(editedElement.id).innerHTML = videoPopupElem;
          }else{
            uploadVideoElem = `<video src="${URL.createObjectURL(videoSrc)}" alt="" controls>`;
            document.getElementById(editedElement.id).innerHTML = uploadVideoElem;
          }
         
          if (videoType==="link"){
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let linkUrlValidate = matchYoutubeUrl(videoLink)
            if(videoLink !== "" && linkUrlValidate){
              if(thumbnailImage !==""){
                if(typeof thumbnailImage === "string"){
                  thumbnailImage = [thumbnailImage]
                }else{
                  thumbnailImage = thumbnailImage;
                }
                if (updatesClass === "updatesItems") {
                  tempArray[`${updatedElement}`]={...tempArray[`${updatedElement}`],type:"5",link:videoLink,image:thumbnailImage,updates:updateName}
                  }else{
                    tempArray[`${updatedElement}`]={...tempArray[`${updatedElement}`],type:"5",link:videoLink,image:thumbnailImage}
                }
                $('#editModal').modal('hide');
              }
            }
          }
          $('#editModal').modal('hide');

          videoPopupOpenEdit= (elem)=>{
            let videoData = elem.id.split("_")[1];
            let videoLinkData = tempArray[`${videoData}`].link
            let videoelem = `<iframe height="345" src="${videoLinkData}?rel=0&amp;autoplay=1" allow="autoplay">
                            </iframe>`
            $("#videoPopupModal .modal-body").html(videoelem)
            $("#videoPopupModal").modal('show')
          }
          console.log(tempArray)
        }
        else if (modalBody.children[0].className === "animationCard") {

          let parentDivId = modalBody.children[0].id
          var updatedAnimation = document.querySelector(".animationEditContainer").id
          var animationSrc = animationContainerArray[updatedAnimation.id]

          let animationsImg;
          if (updatesClass === "updatesItems") {
            animationsImg = animationContainerArray[`${parentDivId}`]['files']
          } else {
            animationsImg = animationContainerArray[`${parentDivId}`]
          }

          let animations = ''

          for (let animation of animationsImg) {
            animations += `<img src=${URL.createObjectURL(animation)} alt="img">`
          }

          if (animationsImg.length > 0) {
            $('#editModal').modal('hide');
            document.getElementById(updatedAnimation).innerHTML = animations
          } else {
            let animationElem = document.querySelector(".animationEditContainer")
            let errorElem = document.querySelector(".error")
            if (animationsImg.length === 0) {
              animationElem.insertAdjacentHTML('afterend', '<p class="error">Please insert animation...!</p>');
            }
          }

        }
        else if (modalBody.children[0].id === "pageTitleId") {
          let parentContentCard = document.querySelector("#contentCard")
          var ckTextValue = CKEDITOR.instances['pageTitleFieldEdit']?.getData()
          let updatedElement = document.getElementById("pageHeadingId")
          let inputValue = document.querySelector(".inputField").value
          let contentBgColor = $('#colorPickerIdEdit').val()
          let textureType = $('input[name="textureOptionEdit"]:checked').val();
          let textureColor = $("#textureBgColorEdit").val();

          if (ckTextValue !== "") {
            //
            $('#editModal').modal('hide');
            pageBgColor = contentBgColor
            parentContentCard.style.backgroundColor = `${contentBgColor}`
            updatedElement.innerHTML = ckTextValue
            if(textureType === "existing"){
              $(".createPageDiv").css('background-image',`url(${pageBgImage})`);
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor,imageIndex:textureImageIndex, bgImage:pageBgImage }
            }else if(textureType === "color"){
              $(".createPageDiv").css('background-image','');
              $(".createPageDiv").css('background-color',`${textureColor}`);
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, textureColor }
            }else if(textureType === "new"){
              if(pageBgImage !== ""){
                $(".createPageDiv").css('background-image',`url(${URL.createObjectURL(pageBgImage)})`);
              }
              titleArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage,imageIndex:textureImageIndex+1  }
              tempArray["title"] = { "type": "1", title: ckTextValue,textureType, bgColor: cardbgColor, bgImage:pageBgImage,imageIndex:textureImageIndex+1  }
            }
          } else {
            let inputElem = document.getElementById("cke_pageTitleFieldEdit")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }
        else if (modalBody.children[0].className === "linkBtnDiv") {
          let elemId = modalBody.children[0].id
          let btnCount = $('input[name="buttonCountEdit"]:checked').val();
          let btnName = document.getElementById("btnNameEdit").value;
          let btnLink = document.getElementById("btnLinkIdEdit")?.value;
          let btnColor = document.getElementById("btnColorPickerEdit").value;
          let btnType = $('input[name="buttonTypeEdit"]:checked').val();
          let btnLocation = $('input[name="btnLocationEdit"]:checked').val();
          let btnPosition = $('input[name="btnPositionEdit"]:checked').val();
          let popupType = $('input[name="popupTypeEdit"]:checked').val();

          let popupText=CKEDITOR.instances['popupTextEdit']?.getData();
          let popupTextColor = $("#popupTextColorEdit").val();

                    //Button two
          let btnTwoName = $("#btnNameEditTwo").val();
          let btnTwoLink = $("#btnLinkIdEditTwo").val();
          let btnTypeTwo = $('input[name="buttonTypeEditTwo"]:checked').val();
          let btnLocationTwo = $('input[name="btnLocationEditTwo"]:checked').val();
          let btnPositionTwo = $('input[name="btnPositionEditTwo"]:checked').val();
          let popupTypeTwo = $('input[name="popupTypeEditTwo"]:checked').val();
          let btnColorTwo = $("#btnColorPickerEditTwo").val();

          let popupTextTwo=CKEDITOR.instances['popupTextEditTwo']?.getData();
          let popupTextColorTwo = $("#popupTextColorEditTwo").val();

          let menuBgColor = "";
          let menuPosition = "";

          let linkFontColor = ""; 

          
          let leftMenuType = "";
          let centerMenuType = "";
          let rightMenuType = "";

          let leftMenuLabel = "";
          let centerMenuLabel = "";
          let rightMenuLabel = "";

          let leftMenuBtnData = {};
          let centerMenuBtnData = [];
          let rightMenuBtnData = [];

          let menuListData= [];

          let menusList=[];

          if(btnCount === "menu"){
            menuBgColor = $("#menuBgColorEdit").val();
            menuPosition = $(`input[name="menuBtnPositionEdit"]:checked`).val();
            linkFontColor = $("#linkFontColorEdit").val();
            $("input[name=btnListCheckEdit]:checked").map(function () {
              menusList.push(this.value)
            })
          }

          let updatedElement = document.getElementById(elemId).children[1];
          $(updatedElement).removeAttr("style");
          if (btnCount === "one") {
            updatedElement.style.textAlign = `${btnPosition}`
          } else if(btnCount === "two") {
            updatedElement.style.display = "grid";
            updatedElement.style.gridTemplateColumns = "repeat(2, 1fr)";
            updatedElement.style.gap = "10px";
          }else if(btnCount === 'menu'){
            updatedElement.style.display = "flex";
            updatedElement.style.gap = "5px";
            updatedElement.style.justifyContent = "space-between"
            updatedElement.style.backgroundColor = `${menuBgColor}`
          }

          var forms = document.querySelectorAll("#linkFormEdit form");

          let hasEmptyValue = [];
          var links = [];
          let menuBtnData = [];

            $(".btn-error-edit").remove();
            $(".menu-error").remove();
            if(btnCount !=="menu"){
          if (btnName === "") {
            $("#btnNameEdit").after('<p class="error btn-error-edit">Please enter the button name.</p>');
            hasEmptyValue.push(true);
          } else {
            hasEmptyValue.push(false);
          }

          if (btnType === "popup") {
            if (popupType === "link") {
              var result = Array.from(forms).map((a, i) => {
                var obj = {};
                Array.from(a.querySelectorAll("[name]")).forEach((b, j) => {
                  obj[b.getAttribute("name")] = b.value;
                  console.log(b.value,"value")
                  if (b.value === "") {
                    $(b).after(`<div class="error btn-error-edit">Please enter the value.</div>`);
                    hasEmptyValue.push(true);
                  } else {
                    hasEmptyValue.push(false);
                  }
                });
                links.push(obj);
                return links;
              });
            } else if (popupType === "image") {
              if (popupImage === "") {
                $("#imageUploadEdit").after(`<div class="error btn-error-edit">Please upload the image..!</div>`);
                hasEmptyValue.push(true);
              } else {
                hasEmptyValue.push(false);
              }
            } else if (popupType === "pdf") {
              if (popupPdf === "") {
                $("#pdfUploadEdit").after(`<div class="error btn-error-edit">Please upload the document..!</div>`);
                hasEmptyValue.push(true);
              } else {
                hasEmptyValue.push(false);
              }
            }else if(popupType === "text"){
              if(popupText === ""){
                $("#cke_popupTextEdit").after(`<div class="error btn-error-edit">Please enter the value.</div>`);
                hasEmptyValue.push(true);
              } else {
                hasEmptyValue.push(false);
              }
            }

          } else {
            var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
            let btnLinkValidate = ValidateUrlExp.test(btnLink);
            if (btnLink === "" || btnLinkValidate === false) {
              $("#btnLinkIdEdit").after('<p class="error btn-error-edit">Please enter the valid URL.</p>');
              hasEmptyValue.push(true);
            } else {
              hasEmptyValue.push(false);
            }
          }

           //Button two error handling  
          var formsTwo = document.querySelectorAll("#linkFormEditTwo form");

          var linksTwo = [];

          if (btnCount === "two") {
            if (btnTwoName === "") {
              $("#btnNameEditTwo").after('<p class="error btn-error-edit">Please enter button name.</p>');
              hasEmptyValue.push(true);
            } else {
              hasEmptyValue.push(false);
            }

            if (btnTypeTwo === "popup") {
              if (popupTypeTwo === "link") {
                var resultTwo = Array.from(formsTwo).map((a, i) => {
                  var objTwo = {};
                  Array.from(a.querySelectorAll("[name]")).forEach((b, j) => {
                    objTwo[b.getAttribute("name")] = b.value;
                    if (b.value === "") {
                      $(b).after(`<div class="error btn-error-edit">Please enter the value.</div>`);
                      hasEmptyValue.push(true);
                    } else {
                      hasEmptyValue.push(false);
                    }
                  });
                  linksTwo.push(objTwo);
                  return linksTwo;
                });
              } else if (popupTypeTwo === "image") {
                if (popupImageTwo === "") {
                  $("#imageUploadTwo").after(`<div class="error btn-error-edit">Please upload the image.</div>`);
                  hasEmptyValue.push(true);
                } else {
                  hasEmptyValue.push(false);
                }
              } else if (popupTypeTwo === "pdf") {
                if (popupPdfTwo === "") {
                  $("#pdfUploadTwo").after(`<div class="error btn-error-edit">Please upload the document.</div>`);
                  hasEmptyValue.push(true);
                } else {
                  hasEmptyValue.push(false);
                }
              }else if(popupTypeTwo === "text"){
                if(popupTextTwo === ""){
                  $("#cke_popupTextEditTwo").after(`<div class="error btn-error-edit">Please enter the value.</div>`);
                  hasEmptyValue.push(true);
                } else {
                  hasEmptyValue.push(false);
                }
              }
            } else {
              let ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
              let btnLinkTwoValidate = ValidateUrlExp.test(btnTwoLink);
              if (btnTwoLink === "" || btnLinkTwoValidate === false) {
                $("#btnLinkIdEditTwo").after('<p class="error btn-error-edit">Please enter the valid URL.</p>');
                hasEmptyValue.push(true);
              } else {
                hasEmptyValue.push(false);
              }
            }
          }
        }else{
          let menuForms = document.querySelectorAll("#menuBtnsDivEdit .menu-btns form");
          menusList.forEach((m)=>{
            let leftMenuForms = "";
            let menuBtnForms = "";

            if(m==="left"){
              leftMenuType = $(`input[name="leftMenuTypeEdit"]:checked`).val();
              if(leftMenuType === "link"){
                menuBtnForms = document.querySelectorAll(`#leftMenuListEdit .link-menu form`);
              }else{
                leftMenuLabel = $("#leftDropDownNameEdit").val();
                if(leftMenuLabel === ""){
                  hasEmptyValue.push(true);
                  $("#leftDropDownNameEdit").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
                }
                menuBtnForms = document.querySelectorAll(`#leftMenuListEdit .drop-down-menu .menu-btns form`);
              }
            }else if(m ==="center"){
              centerMenuType = $(`input[name="centerMenuTypeEdit"]:checked`).val();
              if(centerMenuType === "link"){
                menuBtnForms = document.querySelectorAll(`#centerMenuListEdit .link-menu form`);
              }else{
                centerMenuLabel = $("#centerDropDownNameEdit").val();
                if(centerMenuLabel === ""){
                  hasEmptyValue.push(true);
                  $("#centerDropDownNameEdit").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
                }
                menuBtnForms = document.querySelectorAll(`#centerMenuListEdit .drop-down-menu .menu-btns form`);
              }
            }else if(m === "right"){
              rightMenuType = $(`input[name="rightMenuTypeEdit"]:checked`).val();
              if(rightMenuType === "link"){
                menuBtnForms = document.querySelectorAll(`#rightMenuListEdit .link-menu form`);
              }else{
                rightMenuLabel = $("#rightDropDownNameEdit").val();
                if(rightMenuLabel === ""){
                  hasEmptyValue.push(true);
                  $("#rightDropDownNameEdit").after('<p class="error menu-error mt-0">Please enter the label name.</p>');
                } 
                menuBtnForms = document.querySelectorAll(`#rightMenuListEdit .drop-down-menu .menu-btns form`);
              }
            } 

            menuListData= [];
            Array.from(menuBtnForms).forEach((e)=>{
              let elements = e.elements;
              let obj ={};
              for(var i = 0 ; i < elements.length ; i++){
                var item = elements.item(i);
                if(item.name !==""){
                  if(item.name=="link"){
                    var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                    let linkUrlValidate = ValidateUrlExp.test(item.value);
                    if(linkUrlValidate ===false){
                      $(elements[i]).after('<p class="error menu-error mt-0">Please enter the valid URL.</p>')
                      hasEmptyValue.push(true)
                    }
                  }

                  if(item.name === "btnName"){
                    if(item.value == ""){
                      $(elements[i]).after('<p class="error menu-error mt-0">Please enter the valid name.</p>') 
                      hasEmptyValue.push(true)
                    }
                  }

                  obj[item.name] = item.value;
                }
            }
             menuListData.push(obj)
            })
            if(m === "left"){
              if(leftMenuType === "link"){
                leftMenuBtnData = {position:"left",type:leftMenuType,links:menuListData}
              }else{
                leftMenuBtnData = {position:"left",label:leftMenuLabel,type:leftMenuType,links:menuListData}
              }
              menuBtnData.push(leftMenuBtnData);
            }else if(m === "right"){
              if(rightMenuType === "link"){
                rightMenuBtnData = {position:"right",type:rightMenuType,links:menuListData}
              }else{
                rightMenuBtnData = {position:"right",label:rightMenuLabel,type:rightMenuType,links:menuListData}
              }
              menuBtnData.push(rightMenuBtnData);
            }else if(m === "center"){
              if(centerMenuType === "link"){
                centerMenuBtnData = {position:"center",type:centerMenuType,links:menuListData}
              }else{
                centerMenuBtnData = {position:"center",label:centerMenuLabel,type:centerMenuType,links:menuListData}
              }
              menuBtnData.push(centerMenuBtnData);
            }
          })
        }

          $(".btn-error-edit").get(0)?.scrollIntoView({behavior: 'smooth'});

          let btnTag = '';

          if (btnCount === "two") {
            if (btnType === "link") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="${btnLink}" id="linkTag${updatesId}_0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>
                      </div>`;
            } else if (btnType === "popup") {
              btnTag = `<div style="text-align:${btnPosition}">
                        <a href="#" id="linkTag${updatesId}_0" class="linkBtn link_${elemId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColor}">${btnName}</a>
                      </div>`
            }

            if (btnTypeTwo === "link") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="${btnTwoLink}" id="linkTag${updatesId}_1" target="_blank" class="linkBtn" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                    </div>`;
            } else if (btnTypeTwo === "popup") {
              btnTag += `<div style="text-align:${btnPositionTwo}">
                        <a href="#" id="linkTag${updatesId}_1" class="linkBtn link_${elemId}" onclick="openPopupTwoModal(this)" style="background-color:${btnColorTwo}">${btnTwoName}</a>
                      </div>`
            }
          }  else if(btnCount === "one") {
            if (btnType === "link") {
              btnTag = `<a href="${btnLink}" id="linkTag${updatesId}_0" target="_blank" class="linkBtn" style="background-color:${btnColor}">${btnName}</a>`;
            } else if (btnType === "popup") {
              btnTag = `<a href="#" id="linkTag${updatesId}_1" class="linkBtn link_${elemId}" onclick="openPopupModal(this)" style="background-color:${btnColor}">${btnName}</a>`;
            }
          }else if(btnCount === "menu"){
            menuBtnData.forEach((btn,i)=>{
              if(btn.type === "link"){
                btnTag += `<a href="${btn['links'][0].link}" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn['links'][0].btnName}" class="linkBtn" target="_blank" style="color:${linkFontColor}">${btn['links'][0].btnName}</a>`;
              }else{
                let linkElem ="";
                btn['links'].forEach((l)=>{
                  linkElem += `<li><a class="dropdown-item" target="_blank" href="${l.link}">${l.btnName}</a></li>`
                  })

                btnTag += `<div class="dropdown">
                   <a class="btn dropdown-toggle" href="#" role="button" id="dropdownMenuLinkEdit${i}" onclick="dropDownChangeEdit(this)" data-bs-toggle="dropdown" aria-expanded="false" data-bs-toggle="tooltip" data-bs-placement="top" title="${btn.label}" style="color:${linkFontColor}">
                      <span>${btn.label}</span> 
                   </a>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuLinkEdit${i}">
                      ${linkElem}
                    </ul>
                  </div>`
              }

            });
          }


          var color = $("#btnEditColor").val();

          let buttonOneInfo;
          let buttonTwoInfo;
          let menuBtnInfo;

          if(btnCount !== "menu"){
            if (btnType === "link") {
              buttonOneInfo = { name: btnName, btnType, link: btnLink, btnPosition, bgColor: btnColor }
            } else {
              if (popupType === "link") {
                buttonOneInfo = { name: btnName, btnType, popupType, links, bgColor: btnColor, btnLocation, btnPosition };
              } else if (popupType === "image") {
                buttonOneInfo = { name: btnName, btnType, popupType, image: popupImage, bgColor: btnColor, btnLocation, btnPosition };
              } else if(popupType === "pdf") {
                buttonOneInfo = { name: btnName, btnType, popupType, pdf: popupPdf, bgColor: btnColor, btnLocation, btnPosition };
              }else if(popupType === "text"){
                buttonOneInfo = { name: btnName, btnType, popupType, text: popupText,textBgColor:popupTextColor, bgColor: btnColor, btnLocation, btnPosition };
              }
            }

          if (btnCount === "two") {
            if (btnTypeTwo === "link") {
              buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, link: btnTwoLink, btnPosition: btnPositionTwo, bgColor: btnColorTwo }
            } else {
              if (popupTypeTwo === "link") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, links: linksTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if (popupTypeTwo === "image") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, image: popupImageTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              } else if(popupTypeTwo === "pdf") {
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, pdf: popupPdfTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              }else if(popupTypeTwo === "text"){
                buttonTwoInfo = { name: btnTwoName, btnType: btnTypeTwo, popupType: popupTypeTwo, text: popupTextTwo,textBgColor:popupTextColorTwo, bgColor: btnColorTwo, btnLocation: btnLocationTwo, btnPosition: btnPositionTwo };
              }
            }
          }
        }else{
          menuBtnInfo = menuBtnData;
        }
          let buttons = [];

          if(btnCount === "one"){
            buttons.push(buttonOneInfo);
          }else if (btnCount === "two") {
            buttons.push(buttonOneInfo);
            buttons.push(buttonTwoInfo);
          }else{
            buttons=[...menuBtnInfo.map(obj=>obj)];
          }


           if (!hasEmptyValue.includes(true)) {
              if(btnCount ==="menu"){
                tempArray[`${elemId}`] = { type: "8", menusList, btnCount, fontColor:linkFontColor,bgColor:menuBgColor, buttons }
              }else{
                if (updatesClass === "updatesItems") {
                  btnContainerArray[`${elemId}`] = { btnCount, buttons, updates: `updates${updatesId}` }
                  tempArray[`${elemId}`] = { type: "8", btnCount, buttons, updates: `updates${updatesId}` }
                } else {
                  btnContainerArray[`${elemId}`] = { btnCount, buttons }
                  tempArray[`${elemId}`] = { type: "8", btnCount, buttons }
                }
              }
            updatedElement.innerHTML = btnTag;
            $('#editModal').modal('hide');
          }

          dropDownChangeEdit = (elem)=>{
            $(`#${elem.id}`).dropdown('toggle')
          }

          let modalContent = '';
          let linkElem = "";

          openPopupModal = (elem) => {
            modalContent = '';

            let btnAttr = elem.classList[1].split("_")[1];
            let popupData = tempArray[`${btnAttr}`];
            let modalType = popupData['popupType'];

            if (modalType === "image") {
              let popupModalImg = "";
              if(typeof popupData.image === "object"){
                popupModalImg = URL.createObjectURL(popupData.image);
              }else{
                popupModalImg = popupData.image;
              }
              modalContent = `<img src="${popupModalImg}" class="popupImage" />`
            } else if (modalType === "pdf") {
              let popupModalPdf = "";
              if(typeof popupData.pdf === "object"){
                popupModalPdf = URL.createObjectURL(popupData.pdf);
              }else{
                popupModalPdf = popupData.pdf;
              }
              modalContent = `<object data='${popupModalPdf}' type='application/pdf' width='100%' height='700px'>`
            } else if (modalType === "link") {
              popupData.links.map((l) => {
                modalContent += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
              })
            }else if(modalType === "text"){
              modalContent =`<div class="p-3" style="background-color:${popupData.textBgColor}">${popupData.text}</div>`
            }

            $("#popupBtnModalEdit .modal-body").html(modalContent);
            $('#popupBtnModalEdit').modal('show');
          }

               //Button Two
          let modalContentTwo = '';
          let linkElemTwo = "";

          openPopupTwoModal = (elem) => {
            modalContentTwo = '';
            let elemIndex = elem.id.split("_")[1];
            let btnAttr = elem.classList[1].split("_")[1];
            let popupTwoData = tempArray[`${btnAttr}`]['buttons'][elemIndex];
            let modalTypeTwo = popupTwoData['popupType'];

            if (modalTypeTwo === "image") {
               let popupModalImgTwo = "";
              if(typeof popupTwoData.image === "object"){
                popupModalImgTwo = URL.createObjectURL(popupTwoData.image);
              }else{
                popupModalImgTwo = popupTwoData.image;
              }
              modalContentTwo = `<img src="${popupModalImgTwo}" class="popupImage" />`
            } else if (modalTypeTwo === "pdf") {
                 let popupModalPdfTwo = "";
              if(typeof popupTwoData.pdf === "object"){
                popupModalPdfTwo = URL.createObjectURL(popupTwoData.pdf);
              }else{
                popupModalPdfTwo = popupTwoData.pdf;
              }
              modalContentTwo = `<object data='${popupModalPdfTwo}' type='application/pdf' width='100%' height='700px'>`
            } else if (modalTypeTwo === "link") {
              popupTwoData.links.map((l) => {
                modalContentTwo += `<a class="poplink" target=_blank href="${l.link}">${l.name}</a>`
              })
            }else if(modalTypeTwo === "text"){
              modalContentTwo =`<div class="p-3" style="background-color:${popupTwoData.textBgColor}">${popupTwoData.text}</div>`
            }

            $("#popupBtnModalEdit .modal-body").html(modalContentTwo);
            $('#popupBtnModalEdit').modal('show');
          }
        }
        else if (modalBody.children[0].className === "editHeading") {

          let id = modalBody.children[0].id
          let updatedElement = document.getElementById(id).children[1]
          let editValue = CKEDITOR.instances['editInput']?.getData()
          let donorCheck = tempArray[`${id}`]['donor']

          let colorInput = document.getElementById("headingColorPickerId").value
          if (CKEDITOR.instances['editInput']?.getData() !== "") {

            //
            $('#editModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            updatedElement.innerHTML = editValue

            if (updatesClass === "updatesItems") {
              headingArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput, updates: `updates${updatesId}` }
              tempArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput, updates: `updates${updatesId}` }
            } else {
              if(donorCheck){
                headingArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput,donor:true }
                tempArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput,donor:true }
              }else{
              headingArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput }
              tempArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput }
            }
          }
          } else {
            let inputElem = document.getElementById(`cke_editInput`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

          updatedElement.parentElement.style.backgroundColor = colorInput



        }
        else if (modalBody.children[0].className === "DescClass") {
          var ckTextValue = CKEDITOR.instances['descEditId']?.getData()
          let bgColor = document.getElementById("descEditColorPicker").value
          let elemId = modalBody.children[0].id
          let parentElem = document.getElementById(elemId)
          let updatedElement = parentElem.children[1]

          if (ckTextValue !== "") {
            //
            $('#editModal').modal('hide');
            updatedElement.innerHTML = ckTextValue
            parentElem.style.backgroundColor = bgColor
            var sol_math = document.getElementById(`#${updatedElement.id}`);
            MathJax.Hub.Queue(["Typeset", MathJax.Hub, sol_math]);
            if (updatesClass === "updatesItems") {
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: bgColor, updates: `updates${updatesId}` }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: bgColor, updates: `updates${updatesId}` }
            } else {
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: bgColor }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: bgColor }
            }

          } else {
            let inputElem = document.getElementById(`cke_descEditId`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }
        }
        else if (modalBody.children[0].className === "linkImgModalDiv") {
          let imgId = modalBody.children[0].id
          let updatedElement = document.getElementById(imgId).children[1]
          var imageLinkEditVal = $("#imgLinkEditField").val();
          var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
          let linkUrlValidate = ValidateUrlExp.test(imageLinkEditVal)

          if (linkUrlValidate) {
            imgLinkContainerArray[`${imgId}`]['link'] = imageLinkEditVal;
            tempArray[`${imgId}`]['link'] = imageLinkEditVal;
          }
          const { link, image } = imgLinkContainerArray[imgId];

          let linkEditUrl = ""
          if (typeof image[0] == "string") {
            linkEditUrl = image[0];
          } else if (typeof image[0] === "object") {
            linkEditUrl = URL.createObjectURL(image[0]);
          }

          let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${linkEditUrl}" alt=""/></a>`
          let linkInputElemEdit = document.getElementById("imgLinkEditField")

          if (linkInputElemEdit.value !== "" && linkUrlValidate) {
            //
            $('#editModal').modal('hide');
            updatedElement.innerHTML = imgLinkDiv
            if (updatesClass === "updatesItems") {
              imgLinkContainerArray[`${imgId}`] = { link: link, image: image, updates: `updates${updatesId}` }
              tempArray[`${imageId}`] = { type: "9", link: link, image: image, updates: `updates${updatesId}` }
            } else {
              imgLinkContainerArray[`${imgId}`] = { link: link, image: image }
              tempArray[`${imageId}`] = { type: "9", link: link, image: image }
            }

          } else {
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              linkInputElemEdit.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }


        }
        else if (modalBody.children[0].className === "imgEditCard") {
          let imagesView = $('input[name="imageViewEdit"]:checked').val();
          let arrowBgColor = $("#arrowBgColorEdit").val()
          let parentDivId = modalBody.children[0].id
          let updatesClass = document.getElementById("EditPageTitle").className.split("_")[0]
          let keyId = document.getElementsByClassName("imgContainerEdit")[0].id
          let currentELement = document.getElementById(parentDivId).childNodes[1];
          var numb = parentDivId?.match(/\d/g);
          numb = numb?.join("");

          let images;
          if (updatesClass === "updatesItems") {
            images = imagesContainerArrar[`${parentDivId}`]['images']
          } else {
            images = imagesContainerArrar[`${parentDivId}`]
          }

          let updatedElement = document.getElementById(keyId)
          let editedImages = '';
          let url = "";
          images.forEach((e, i) => {

            if (typeof e === "string") {
              url = e
            } else {
              url = URL.createObjectURL(e)
            }
            editedImages += `<img src=${url} alt="img">`
          })

          let updatedImages = `<div class="imagesDiv" id="${keyId}">
            ${editedImages}
          </div>`

          let imageSlideCount = '';
          let carouselImage = '';

          images.forEach((e, i) => {
            imageSlideCount += `<button type="button" data-bs-target="#carouselwithIndicators${numb}" style="background-color:${arrowBgColor}" data-bs-slide-to="${i}" aria-current="true" class="${i == 0 ? "active" : ""}" aria-label="Slide ${i}"></button>`
          })

          let carouselUrl = '';

          images.forEach((e, i) => {
            if (typeof e === "string") {
              carouselUrl = e
            } else {
              carouselUrl = URL.createObjectURL(e)
            }

            carouselImage += `<div class="${i == 0 ? "carousel-item active" : "carousel-item"}">
              <img src=${carouselUrl} class="d-block w-100" alt="${e.name}" >
            </div>`
          })

          let carouselView = `<div class="container main-margin-top">
            <div id="carouselwithIndicators${numb}" class="carousel slide" data-bs-ride="carousel" data-bs-interval="false">
              <div class="carousel-indicators">
                ${imageSlideCount}
              </div>
              <div class=" carousel-inner">
                ${carouselImage}
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#carouselwithIndicators${numb}" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
      
              <button class="carousel-control-next" type="button" data-bs-target="#carouselwithIndicators${numb}" data-bs-slide="next">
                <span class="carousel-control-next-icon" style="background-color:${arrowBgColor}" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
          </div>
        </div>`

          //
          if (images.length > 0) {
            tempArray[`${parentDivId}`] = { ...tempArray[`${parentDivId}`], "imagesView": imagesView, "arrowBgColor": arrowBgColor }
            $('#editModal').modal('hide');
            if (imagesView === "carousel") {
              currentELement.outerHTML = carouselView
            } else {
              currentELement.outerHTML = updatedImages
            }
          } else {
            let inputElem = document.querySelector(".imgContainerEdit")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert image...!</p>');
            }
          }
        }
        else if (modalBody.children[0].className === "hyperLinkEdit") {
          let hyperLinksUpdate = [];
          let hyperLinkType = $('input[name="hyperLinkTypeEdit"]:checked').val();
          let parentId = modalBody.children[0].id.split("_")[0]
          let { hyperLinkCards } = hyperLinkArray[`${parentId}`]
          let editForms = document.getElementsByClassName("editForm")

          let isEmpty = [];

          for (let h = 0; h < editForms.length; h++) {
            let form = editForms[h];
            let data = new FormData(form);
            data = data.entries();
            var obj = data.next();
            var retrieved = {};

            var f = form.id;
            var numberPattern = /\d+/g;
            f = f.match(numberPattern).join([]);

            while (undefined !== obj.value) {
              retrieved[obj.value[0]] = obj.value[1];

              if (obj.value[0] == "file") {
                if (hyperLinkCards[h]) {
                  retrieved["image"] = [hyperLinkCards[h].image[0]]
                  retrieved["file"] = [hyperLinkCards[h].image[0]]
                } else {
                  retrieved["image"] = [obj.value[1]]
                  retrieved["file"] = [obj.value[1]]
                }
              }
              obj = data.next();
              retrieved["caption"] = CKEDITOR.instances[`captionInputEdit${f}`]?.getData();
            }

            let inputFields = $(`#hyperLinkEdit_form${f} input`);

            for (let i = 0; i < inputFields.length; i++) {
              let inputType = inputFields[i].type
              let inputName = inputFields[i].name
              if (inputName === "link") {
                var ValidateUrlExp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
                let hyperLinkEditVal = ValidateUrlExp.test(inputFields[i].value)
                if (inputFields[i].value === "" || hyperLinkEditVal === false) {
                  isEmpty.push(true);
                  if ($(`#hyperError${f}${i}`).length === 0) {
                    $(inputFields[i]).after(`<p class="error" id="hyperError${f}${i}">Please enter the valid URL..!</p>`)
                  }
                } else {
                  isEmpty.push(false);
                  $(`#hyperError${f}${i}`).remove();
                }
              } else if (inputName === "caption") {
                if (CKEDITOR.instances[`captionInputEdit${f}`]?.getData() === "") {
                  isEmpty.push(true);
                  if ($(`#hyperError${f}${i}`).length === 0) {
                    $(`#cke_captionInputEdit${f}`).after(`<p class="error" id="hyperError${f}${i}">Please enter the field..!</p>`);
                  }
                } else {
                  isEmpty.push(false);
                  $(`#hyperError${f}${i}`).remove();
                }
              }
            }

            if (!isEmpty.includes(true)) {
              hyperLinksUpdate.push(retrieved)
            }
          }

          let parentElem = document.getElementById(parentId);
          let updatedElement = parentElem.children[1];
          updatedElement.className = `hyperLinksDiv ${hyperLinkType === "stampcard" ? "stampcard" : ""}`


          let hyperLinkTag = "";
          hyperLinksUpdate.forEach((e, i) => {
            let hyperUrl = ""
            if (typeof e.file[0] === "object") {
              hyperUrl = URL.createObjectURL(e.file[0])
            } else {
              hyperUrl = e.file[0]
            }
            hyperLinkTag +=
              `<div class="hyperLink ${hyperLinkType === "stampcard" ? "stampcard" : ""}">
              <div class="linkDiv ${hyperLinkType === "stampcard" ? "stampcard" : ""}">
                  <a href="${e.link}" target="_blank">
                      <img src="${hyperUrl}" alt="">
                  </a>
              </div>
              <div class="captionDiv">
                  ${e.caption}
              </div>
          </div>`
          })


          if (!isEmpty.includes(true)) {
            if (updatesClass === "updatesItems") {
              hyperLinkArray[`${parentId}`] = { hyperLinkCards: hyperLinksUpdate, updates: `updates${updatesId}` };
              tempArray[`${parentId}`] = { type: "11", hyperLinkCards: hyperLinksUpdate, updates: `updates${updatesId}`, "hyperLinkType": hyperLinkType };
            } else {
              hyperLinkArray[`${parentId}`] = { hyperLinkCards: hyperLinksUpdate };
              tempArray[`${parentId}`] = { type: "11", hyperLinkCards: hyperLinksUpdate, "hyperLinkType": hyperLinkType };
            }
            $('#editModal').modal('hide');
            updatedElement.innerHTML = hyperLinkTag;
          }

        }
        else if (modalBody.children[0].className === "updatesDiv") {
          let elemId = modalBody.children[0].id.split("_")[0]
          let elemCount = elemId.split("").pop()
          let updatedElemId = `updatesHeadingDiv${elemCount}`

          let updatedElem = document.getElementById(`${updatedElemId}`)

          let heading = CKEDITOR.instances['updatesHeadingEdit']?.getData()
          let bgColor = document.getElementById("bgColorEdit").value
          let accordionInput = $('#showEdit:checked').val();

          let showAccordion = accordionInput === undefined ? false : true;



          if (heading !== "") {
            $('#editModal').modal('hide');
            updatedElem.innerHTML = heading
            updatedElem.style.backgroundColor = bgColor
            updatesArray[`${elemId}`] = { heading: heading, show: showAccordion, bgColor: bgColor }
            tempArray[`${elemId}`] = { type: "12", heading: heading, show: showAccordion, bgColor: bgColor }
          }

        }
      }


      const logoSelectChange = (elem) => {
        let logoSelectOption = $(elem).val();
        if (logoSelectOption === "existingimage") {
          $('#logoChooseDiv').css("display", "none");
          $('#logoListDiv').css("display", "flex");
        } else if (logoSelectOption === "newimage") {
          $('#logoChooseDiv').css("display", "flex");
          $('#logoListDiv').css("display", "none");
        }
      }

      function submitModal() {
        let updatesElemClass = document.querySelectorAll('.updatesDivContainer')
        let gotoBtnDiv = document.getElementById("updateColorDiv")
        let update_name_elem = document.getElementById("updateNameDiv")
        let goto_select_div = document.getElementById("goToSelectDiv")

        let selectOption = document.getElementById('goToSelect')
        let gotoColor = document.getElementById("updateBgColor");

        $("#selectDivLogo").css("display", "none");
        pageLogoImage = "";

        let existingLogos = ['../../assets/img/img1.jpg', '../../assets/img/img2.jpg', '../../assets/img/img3.jpg', '../../assets/img/img4.jpg'];
        let logoElem = '';

        existingLogos.forEach((logo, i) => {
          logoElem += ` <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="imageList" value="newimage${i}"id="newimage${i}" onchange="logoChangeFromList(${i})">
            <label class="form-check-label" for="newimage">
              <img src="${logo}"/>
            </label>
          </div>`
        })


        let imageRadioElem = `<fieldset class="row mb-2 mt-2">
                                <div class="radio-seletion">
                                  ${logoElem}
                                  <div>
                            </fieldset>`

        $("#logoDiv").html(imageRadioElem)

        logoChangeFromList = (index) => {
          $("#pageLogoDiv").html(`<img src="${existingLogos[index]}"/>`);
          $("#selectDivLogo").css("display", "flex")
          pageLogoImage = existingLogos[index];
        }
        if (updatesElemClass.length > 0) {
          gotoBtnDiv.style.display = "flex"
          update_name_elem.style.display = "flex"
          goto_select_div.style.display = "flex"
        } else {
          gotoBtnDiv.style.display = "none"
          update_name_elem.style.display = "none"
          goto_select_div.style.display = "none"
        }

        const { gotoselect, gotoselectbg, gotoselectname } = gotoData;

        if (updatesElemClass.length === 0) {
          goto_select_div.style.display = "none"
        } else {
          goto_select_div.style.display = "flex"
        }

        selectOption.innerHTML = "";

        var nullOpt = document.createElement('option');
        nullOpt.value = null;
        nullOpt.innerHTML = "Choose Update...";
        selectOption.appendChild(nullOpt);
        for (let i = 0; i < updatesElemClass.length; i++) {
          let updatesElementsId = updatesElemClass[i].id
          let updatesElement = tempArray[`${updatesElementsId}`]['heading']

          var opt = document.createElement('option');
          opt.value = i;
          opt.innerHTML = updatesElement;
          selectOption.appendChild(opt);
        }

        CKEDITOR.instances[`updateName`].setData(gotoselectname);
        selectOption.value = gotoselect;
        gotoColor.value = gotoselectbg


        $('#submitModal').modal('show');
      }

      function goToFn() {
        let selectedValue = document.getElementById("goToSelect").value
        let update_name_elem = document.getElementById("updateNameDiv")
        let update_color_elem = document.getElementById("updateColorDiv")

        if (selectedValue === "null") {
          update_name_elem.style.display = "none"
          update_color_elem.style.display = "none"
        } else {
          update_name_elem.style.display = "flex"
          update_color_elem.style.display = "flex"
        }
      }



      $(function () {
        $("#sidebar").load("../../component/sidebar.html");
        $("#topbar-div").load("../../component/topbar.html");
      });


      // Menu Toggle

      let navigations = document.querySelector('.navigation');
      let toggles = document.querySelector('.toggle');
      let main = document.querySelector('.main');

      toggles.onclick = function () {
        navigations.classList.toggle('active');
        main.classList.toggle('active');
      }
      // add hovered classn selected list item

      let list = document.querySelectorAll('.navigation li');

      function activeLink() {
        list.forEach((item) =>
          item.classList.remove('hovered'));
        this.classList.add('hovered');
      }
      function activeMenu() {
        list.forEach((item) =>
          item.classList.remove('active'));
        this.classList.add('active');
      }
      list.forEach((item) =>
        item.addEventListener('mouseover', activeLink))

      list.forEach((item) =>
        item.addEventListener('click', activeMenu))



      let urlInputValue = $("#urlInput").val()


      function submitFn() {

        data = [];

        let mainDiv = document.getElementById("contentCard")

        let childElem = mainDiv.childNodes;

        // Parent Link Validation
        let parentLink = $("#mainPageLink").val();
        var regexp = /^(ftp|http|https|chrome|:\/\/|\.|@){2,}(localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\S*:\w*@)*([a-zA-Z]|(\d{1,3}|\.){7}){1,}(\w|\.{2,}|\.[a-zA-Z]{2,3}|\/|\?|&|:\d|@|=|\/|\(.*\)|#|-|%)*$/gum
        let urlValidate = regexp.test(parentLink)

        let keysArray = []

        for (let i = 0; i < childElem.length; i++) {
          keysArray.push(childElem[i].id)
        }

        let updatesValue = []

        let updatesKey = []

        const updatesElemClass = document.querySelectorAll('.updatesDivContainer')

        for (let i = 0; i < updatesElemClass.length; i++) {

          let ParentId = updatesElemClass[i].id

          var numb = ParentId.match(/\d/g);
          numb = numb.join("");
          let idCount = ParentId.split("").pop()
          let childElem = document.getElementById(`updatesItems${Number(numb)}`).childNodes

          for (let j = 0; j < childElem.length; j++) {
            updatesKey.push(childElem[j].id)
          }

        }

        updatesKey.forEach((e) => {
          updatesValue.push(tempArray[e])
        })

        let updatesElemObj = Object.groupBy(updatesValue, ({ updates }) => {
          return updates
        });

        keysArray.forEach((e, i) => {
          if (e.includes('updates')) {
            var numb = e.match(/\d/g);
            numb = numb.join("");
            let objId = `updates${numb}`
            let updates = updatesElemObj[`${objId}`]
            let element = tempArray[e]
            element = { ...element, updates }
            data.push(element)
          } else {
            data.push(tempArray[e])
          }
        })

        if(tempArray['linkPopup']){
          data.push(tempArray['linkPopup'])
        }

        data = data.map((item) => {
          if (item.type == "1") {
            if(item.textureType == "new"){
              item.textureType = "existing";
            }
          }
          return item;
        });

        console.log(data, "edit")

        var action = $('#acionId input:radio:checked').val();
        let urlInput = $("#urlInput").val()
        var selectCatText = $('#inputState option').filter(':selected').text();
        var selectCatValue = $('#inputState').val()
        var goToSelect = $('#goToSelect').val()
        var updateName = CKEDITOR.instances['updateName'].getData()
        var updateBtnColor = $('#updateBgColor').val()

        let updatesElemCheck = null;

        if (updatesElemClass.length !== 0) {
          if (goToSelect !== "null" && updateName !== "") {
            updatesElemCheck = true
          } else {
            updatesElemCheck = false
          }
        } else {
          updatesElemCheck = null;
        }

        const isDiv = updateName.startsWith("<div")
        const strIndex = updateName.indexOf(">")
        const substr = updateName.substr(0, strIndex + 1);

        let gotoName;

        if (isDiv) {
          const newTag = updateName.replace(substr, "")
          gotoName = newTag.replace("</div>", "");
        }


        if (urlInput !== "" && selectCatValue !== "null") {
          $('#submitModal').modal('hide');
          return false;
        }

      }

    </script>

</body>

</html>