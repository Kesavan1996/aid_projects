<!DOCTYPE html>
<html>

  <head>
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <title>Page Create</title>
    <link rel="stylesheet" type="text/css" href="editpage.css">

    <link href="//vjs.zencdn.net/8.3.0/video-js.min.css" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous" />

    <!-- <script src="http://code.jquery.com/jquery.min.js"></script>
    <script src="http://code.jquery.com/ui/1.8.17/jquery-ui.min.js"></script> -->

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"
      integrity="sha512-Eezs+g9Lq4TCCq0wae01s9PuNWzHYoCMkE97e2qdkYthpI0pzC3UGB03lgEHn2XM85hDOUF6qgqqszs+iXU4UA=="
      crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  </head>

  <body>
    <div class>
      <div>
        <div id="sidebar"> </div>
        <!--- main --->
        <div class="main">
          <div id="topbar-div"></div>
          <div class="createPageDiv">
            <div class="mainContainer">

              <div class="cards">
                <div class="card" id="contentCard">
                </div>

                <!-- edit -->

                <div id="submitBtnDiv" style="display: none;">
                  <button type="button" id="submitBtn" class="btn btn-primary" onclick="submitModal()">Submit</button>
                </div>

              </div>
              <div class="btnContainer">
                <div class="menuToggles">
                  <button type="button" class="btn rounded-circle ">
                    +
                  </button>

                </div>

                <div class="actionBtns">
                  <button type="button" class="btn btn-primary" id
                    onclick="showModal('pageTitle')"> Page
                    Title</button>
                  <button type="button" class="btn btn-primary" id="headingBtn"
                    onclick="showModal('heading')">
                    Heading</button>
                  <button type="button" class="btn btn-primary" id
                    onclick="showModal('headingDesc')">Description</button>
                  <!-- <button type="button" class="btn btn-primary" onclick="newText()" id="textBtn"><ion-icon
                    name="add-circle-outline"></ion-icon> Text</button> -->
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('image')">Image
                  </button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('video')">Video
                  </button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('animation')">Animation
                  </button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('quiz')">Quiz</button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('button')">Button</button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('imageLink')">Link</button>
                    <button type="button" class="btn btn-primary"
                    onclick="showModal('hyperLink')">Hyperlink</button>
                  <button type="button" class="btn btn-primary"
                    onclick="showModal('updates')">Updates</button>
                  <button type="button" class="btn btn-primary"
                    onclick="addSpace()">Empty Space</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="createModal" tabindex="-1"
        aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="pageTitle">Create Page</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"
                aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div id="pageContent">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary"
                onclick="addElement()">Ok</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="editModal" tabindex="-1"
        aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="EditPageTitle">Edit Page</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"
                aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div id="editPageContent">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary"
                onclick="updateElement()">Ok</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal -->
      <div class="modal fade" id="submitModal" tabindex="-1"
        aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Submit Page</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"
                aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="row mb-3">
                  <label for="inputEmail3" class="col-sm-2 col-form-label">Category</label>
                  <div class="col-sm-10">
                    <select id="inputState" class="form-select">
                      <option value="null" selected>Choose...</option>
                      <option value="1">Euroka</option>
                      <option value="2">AidIndia</option>
                      <option value="3">Ahaguru</option>
                    </select>
                  </div>
                </div>

                <!--  -->
                <div class="mb-3 row align-items-center">
                  <label for="url" class="col-sm-2 col-form-label">URL</label>
                  <div class="col-sm-10">
                    <p class="mb-1 urlTextClass">https://eureka.com/<span id="category"></span>/<span
                      id="urlName"></span>.html</p>
                    <input type="text" class="form-control" id="urlInput">
                  </div>
                </div>
                <fieldset class="row mb-3">
                  <legend class="col-form-label col-sm-2 pt-0">Status</legend>
                  <div class="col-sm-10" id="acionId">
                    <div class="form-check">
                      <input class="form-check-input" type="radio"
                        name="gridRadios" id="gridRadios1" value="Draft">
                      <label class="form-check-label" for="gridRadios1">
                        Draft
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio"
                        name="gridRadios" id="gridRadios2" value="Publish"
                        checked>
                      <label class="form-check-label" for="gridRadios2">
                        Publish
                      </label>
                    </div>
                  </div>
                </fieldset>
                <div class="row mb-3 align-items-center" id="goToSelectDiv" style="display:none">
                  <label for="goToSelect" class="col-sm-2 col-form-label">Go to update</label>
                  <div class="col-sm-10">
                    <select id="goToSelect" class="form-select" onchange="goToFn()">
                    </select>
                  </div>
                </div>
                <div class="mb-3 row align-items-center" id="updateNameDiv" style="display:none">
                  <label for="updateName" class="col-sm-2 col-form-label">Update display name</label>
                  <div class="col-sm-10 ">
                    <input type="text" class="form-control" id="updateName" />
                  </div>
                </div>
                <div class="mb-3 row align-items-center" id="updateColorDiv" style="display:none">
                  <label for="updateBgColor" class="col-sm-2 col-form-label">Update button color</label>
                  <div class="col-sm-10 ">
                    <input type="color" class="form-control form-control-color" id="updateBgColor" value="#53bcf5" />
                  </div>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary"
                data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary" onclick="submitFn()">Submit</button>
            </div>
          </div>
        </div>
      </div>

      <!-- <script src="https://code.jquery.com/jquery-1.10.2.js"></script> -->

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

      <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
      <script type="module"
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
      <script nomodule
        src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

      <script src="/assets/js/ckeditor/ckeditor.js"></script>

      <script>
      CKEDITOR.replace('editor');
      </script>

      <script>

      function changeToRichtext(id_list) {

        var basic = [
          {
            name: 'standard',
            items: ['Bold', 'Italic', 'NumberedList', 'BulletedList']
          },

          { name: 'paragraph', items: ['JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock'] },

          { name: 'styles', items: ['Font', 'FontSize', 'TextColor'] }
        ];
        id_list.forEach(id => {
          // CKEDITOR.plugins.addExternal('custom-list', '/assets/js/plugin/custom-list/', 'plugin.js');
          CKEDITOR.plugins.addExternal('font', '/assets/js/plugin/font/', 'plugin.js');
          CKEDITOR.plugins.addExternal('colorbutton', '/assets/js/plugin/colorbutton/', 'plugin.js');
          CKEDITOR.plugins.addExternal('floatpanel', '/assets/js/plugin/floatpanel/', 'plugin.js');
          CKEDITOR.plugins.addExternal('panelbutton', '/assets/js/plugin/panelbutton/', 'plugin.js');
          CKEDITOR.plugins.addExternal('colordialog', '/assets/js/plugin/colordialog/', 'plugin.js');
          CKEDITOR.plugins.addExternal('liststyle', '/assets/js/plugin/liststyle/', 'plugin.js');
          CKEDITOR.plugins.addExternal('justify', '/assets/js/plugin/justify/', 'plugin.js');
          CKEDITOR.config.extraPlugins = 'font,colorbutton,panelbutton,floatpanel,colordialog,liststyle,justify';
          CKEDITOR.config.colorButton_enableMore = true;

          CKEDITOR.config.enterMode = CKEDITOR.ENTER_BR;
          CKEDITOR.replace(id, {
            toolbar: basic,
            height: "25vh",
            allowedContent: true
          });

        });
      }

      var sort="../../assets/img/sort.png"
      var pen="../../assets/img/pen.png"
      var close="../../assets/img/close.png"

      var headingDivId = 0;
      var dragImageIcon = "../../assets/img/sort.png"
      var editImageIcon = "../../assets/img/pen.png"
      var deleteImageIcon = "../../assets/img/close.png"

      changeToRichtext([`updateName`])

      // Submit Modal Text

      let inputLinkText=$("#urlName")

      $('#urlInput').keyup(function(){
        let text=$.trim($('#urlInput').val())
        let trimText=text.split(" ").join("-")
        inputLinkText.text(trimText)
      });

      let inputCatName=$("#category")
      
      $("#inputState").change(function() {
        inputCatName.text($('#inputState option').filter(':selected').text())
      } );


      var parentDiv = document.getElementById('contentCard')
      let submitBtnDiv = document.getElementById("submitBtnDiv")
      if (parentDiv.innerText == "") {
        parentDiv.innerHTML = '<h3 id="emptyPage" style="opacity:0.8">Add contents to create page..!</h3>'
      }

      let menuToggles = document.querySelector(".menuToggles");
      menuToggles.onclick = function () {
        menuToggles.classList.toggle("active");
      };

      var inputId = 0
      var headingDescId = 0
      var subHeadingId = 0
      var quizId = 0
      var imageId = 0
      var animationId = 0;
      var spaceId = 0;
      var buttonId = 0;
      var imgLinkId = 0;
      var hyperLinkId = 0;
      var updatesId = 0;


      var delImagesEdit;

      var showImages;
      var showEditImages;
      //var showAnimations;
      // var showVideos;
      var showEditVideos;
      var files;
      var addInputs;
      var removeInputs;
      var imgOnchangeFn;
      var imgEditOnchangeFn;
      var addEditInputs;
      var updatesBtnsFn;
      var removeEditInputs;
      var delEditImages;
      var delEditVideos;

      var descriptionId;
      const delVideos = (index) => {
        files.pop()
      }
      const delImages = (index) => {
        files.splice(index, 1)
        showImages()
      }

      var delAnimations;
      var delEditAnimations;

      let data = []
      let dataCount = 0;

      let headingArray = {}

      var imageContainerId = 0;
      let imagesContainerArrar = {};

      var videoContainerId = 0;
      let videoContainerArrary = {};

      let emptySpaceCount = 0

      let quizContainerArray = {}
      let animationContainerArray = {}
      let btnContainerArray = {}
      let imgLinkContainerArray = {}
      let descriptionArray = {}
      let buttonsArray = {}
      let emptyPageArray = {}
      let quizArray = {}
      let titleArray = {}
      let hyperLinkArray= {}
      let updatesArray= {}

      //Temp Array

      let tempArray = {}

      var tempId = "";
      var videoTempId = "";

      let cardbgColor = ""

      // pagetitle color needs to be changed
      let pageBgColor="#fcfcfc";


      const dragArea = document.querySelector('.card')
        
      new Sortable(dragArea,{
        filter:'.titleDiv',
        handle:".dragImg",
        Animation:350
      })

      

        // Page onload function

      let fetchData=fetch('./Data.json')
      .then((response) => response.json())
      .then((json) => {return json.data});

      let fetchGotoData=fetch('./Data.json')
      .then((response) => response.json())
      .then((json) => {return json.goto});

        const fetchElem=(pageData,updatesElemId)=>{
          var parentContentCards
          if(updatesElemId){
            parentContentCards = document.getElementById(`${updatesElemId}`)
          }else{
            parentContentCards = document.getElementById("contentCard")
          }

          var idCount=updatesElemId?.split("").pop()

          pageData.map((data,i)=>{  

            if(data.type==="1"){
              parentContentCards.style.backgroundColor = data.bgColor
              cardbgColor = data.bgColor
  
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
  
              var emptyDiv=document.createElement("div")
              emptyDiv.style="width:20px"
  
              var clickTag = document.createElement("a")
              clickTag.href = "#"
  
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
  
              clickTag.appendChild(editImg)
  
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'title')")
  
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
  
              deleteTag.append(deleteImg)
  
              var ckTextValue = data.title
  
              let titleDiv = document.createElement("div")
              titleDiv.className = "titleDiv"
              titleDiv.id = "title"
              let heading = document.createElement("p")
              heading.id = "pageHeadingId"
              heading.innerHTML = ckTextValue
  
              titleDiv.appendChild(emptyDiv)
              titleDiv.appendChild(heading)
              titleDiv.appendChild(clickTag)
              titleDiv.appendChild(deleteTag)
  
              clickTag.setAttribute("onclick", `editModal("editTitle","pageHeadingId")`)
  
              document.getElementById("emptyPage")?.remove()
              //contentCards.appendChild(titleDiv)
              parentContentCards.insertBefore(titleDiv, parentContentCards.firstChild);
              titleArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }
              tempArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }
              //
              submitBtnDiv.style.display = "block"
  
            }
            else if (data.type === "2") {
                var div = document.createElement('div')
                div.className = "heading dragDiv"
               // div.draggable = true
                div.id = "headingId" + headingDivId
                var dropImg = document.createElement("img")
                dropImg.height = 20
                dropImg.width = 20
                dropImg.src = sort
      
                var clickTag = document.createElement("a")
                clickTag.href = "#"
                clickTag.setAttribute("onclick", `editModal("editHeading",this.previousElementSibling.id,this.parentElement.id)`)
      
                var editImg = document.createElement('img')
                editImg.width = 20
                editImg.height = 20
                editImg.src = pen
      
                clickTag.appendChild(editImg)
      
                var deleteTag = document.createElement("a")
                deleteTag.href = "#"
                deleteTag.setAttribute("onclick", "deleteItem(this,'heading')")
      
                var deleteImg = document.createElement("img")
                deleteImg.width = 20
                deleteImg.height = 20
                deleteImg.src = close
      
                deleteTag.append(deleteImg)
                var ckTextValue = data.heading
      
                let bgColor = data.bgColor
      
                let paraDiv = document.createElement("div")
                paraDiv.className = "headingDiv"
      
                let paraTag = document.createElement("p")
                paraTag.className="mb-0"
                paraTag.id = "heading" + headingDivId
                paraTag.innerHTML = ckTextValue
      
                paraDiv.appendChild(paraTag)
      
                div.appendChild(dropImg)
                div.appendChild(paraDiv)
                div.appendChild(clickTag)
                div.appendChild(deleteTag)
      
                  // 
                  document.getElementById("emptyPage")?.remove()
                  parentContentCards.appendChild(div)

                  if(updatesElemId){
                    headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,updates:`updates${idCount}` }
                    tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,updates:`updates${idCount}` }
                  }else{
                    headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
                    tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
                  }
      
                  let headingDiv = document.getElementById(`headingId${headingDivId}`)
                  headingDiv.style.backgroundColor = `${bgColor}`
                  //
                  submitBtnDiv.style.display = "block"
                  headingDivId += 1
      
              }
            else if(data.type==="3"){
              var div = document.createElement('div')
              div.className = "headingDesc dragDiv"
              div.id = `descriptionDiv${headingDescId}`
              div.draggable = true
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"  
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'description')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
              let elemId = "descriptionDiv" + headingDescId
    
              clickTag.setAttribute("onclick", `editModal("editDescription",this.previousElementSibling.id,this.parentElement.id)`)
    
              var ckTextValue = data.text
              var elem = document.createElement("p")
              elem.id = "Description" + headingDescId
              elem.innerHTML = ckTextValue
              div.appendChild(dropImg)
              div.appendChild(elem)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
  
              let elemBgColor = data.bgColor
  
              document.getElementById("emptyPage")?.remove()
              parentContentCards.appendChild(div)
              if(updatesElemId){
                descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor,updates:`updates${idCount}` }
                tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor,updates:`updates${idCount}` }
              }else{
                descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor }
                tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor }
              }

              let parentElem = document.getElementById(elemId)
              parentElem.style.backgroundColor = elemBgColor
              submitBtnDiv.style.display = "block"
              headingDescId = headingDescId + 1
            }
           else if(data.type==="4"){
              let ParentId;
              var div = document.createElement('div')
              div.className = "imageContainer dragDiv"
    
              //
              div.id = `imgContainerDiv${imageContainerId}`
              div.draggable = true
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
    
              var imgArry = data.images

              if(updatesElemId){   
                imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = {images:imgArry,updates:`updates${idCount}`}
                tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: imgArry,updates:`updates${idCount}`} 
              }else{    
                imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = imgArry
                tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: imgArry } 
              }
 
              var imgContainer = document.createElement("div")
              imgContainer.className = "imagesDiv"
              imgContainer.id = "imgContainer" + imageContainerId
              imgContainer.draggable = true
              //
              clickTag.setAttribute("onclick", `editModal("editImages",this.previousElementSibling.id,this.parentElement.id)`)
    
              let images = '';

              imgArry.forEach((e, i) => {
                images += `
                        <img src=${e} alt="img">
                    </div>`
              })
  
              imgContainer.innerHTML = images
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'image')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
                $('#createModal').modal('hide');
                document.getElementById("emptyPage")?.remove()
    
                div.appendChild(dropImg)
                div.appendChild(imgContainer)
                div.appendChild(clickTag)
                div.appendChild(deleteTag)
                parentContentCards.appendChild(div)
                submitBtnDiv.style.display = "block"
                imageContainerId += 1
            }
            else if(data.type==="5"){
  
              var div = document.createElement('div')
              div.className = "videoContainer dragDiv"
              div.id = "DivvideoContainer" + videoContainerId
              div.draggable = true
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"  
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
  
              var videoArry = data.video
              var videoSrc = data.video

              if(updatesElemId){   
              videoContainerArrary[`DivvideoContainer${videoContainerId}`] ={video:videoArry ,updates:`updates${idCount}`} 
              tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: videoArry,updates:`updates${idCount}` }
              }else{
                  
                videoContainerArrary[`DivvideoContainer${videoContainerId}`] = videoArry 
                tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: videoArry }
              }

              var videoContainer = document.createElement("div")
              videoContainer.className = "videosDiv"
              videoContainer.id = "videoContainer" + videoContainerId
              videoContainer.draggable = true
              clickTag.setAttribute("onclick", "editModal('editVideo',this.previousElementSibling.id,this.parentElement.id)")
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'video')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
              // deleteTag.setAttribute("onclick","return this.parentNode.remove()")
    
              var existingElement = document.getElementById(videoTempId)
    
              let videos = '';
    
              videos = `<video class="" controls  preload="auto" alt="video">
                    <source src=${videoSrc} />
                </video>`
              videoContainer.innerHTML = videos
  
    
    
              let inputElem = document.querySelector(".videoModalContainer")
                //
                $('#createModal').modal('hide');
                document.getElementById("emptyPage")?.remove()
                div.appendChild(dropImg)
                div.appendChild(videoContainer)
                div.appendChild(clickTag)
                div.appendChild(deleteTag)
                parentContentCards.appendChild(div)
                //
                submitBtnDiv.style.display = "block"
                videoContainerId += 1
            }
           /* else if(data.type==="6"){
              var div = document.createElement('div')
              div.className = "animationParentContainer dragDiv"
              div.id = "animationsDiv" + animationId
              div.draggable = true
              var dropAnimation = document.createElement("img")
              dropAnimation.height = 20
              dropAnimation.width = 20
              dropAnimation.src = sort
    
              var animationArry = data.animations;  
  
  
              var animationContainer = document.createElement("div")
              animationContainer.className = "animationsDiv"
              animationContainer.id = `animations${animationId}`
              animationContainer.draggable = true
  
    
              let animations = '';
              animationArry.forEach((e, i) => {
                animations += `
                        <img src=${URL.createObjectURL(e)} alt="img">
                    </div>`
              })
              animationContainer.innerHTML = animations

               if(updatesElemId){ 
                  
                  animationContainerArray[`animationsDiv${animationId}`] = {animations:animationArry,updates:`updates${idCount}`}
      
                  tempArray[`animationsDiv${animationId}`] = { type: "6", animations: animationArry,updates:`updates${idCount}` }  
              }else{
               animationContainerArray[`animationsDiv${animationId}`] = animationArry
  
              tempArray[`animationsDiv${animationId}`] = { type: "6", animations: animationArry }
              }
  

    
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"
    
              clickTag.setAttribute("onclick", "editModal('editAnimation',this.previousElementSibling.id,this.parentElement.id)")
    
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
    
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'animation')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
    
              div.appendChild(dropAnimation)
              div.appendChild(animationContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
  
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              parentContentCards.appendChild(div)
              submitBtnDiv.style.display = "block"
              animationId += 1
            }
            */
            else if(data.type==="7"){
              var quizDiv = document.createElement('div')
              quizDiv.className = "quizContainer dragDiv"
              quizDiv.id = "quizDiv" + quizId
              quizDiv.draggable = true
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
              var formElem = document.getElementsByClassName("formClass");
              var quiz = data.quiz
              var quizData = quiz;
    
              quizContainerArray[`quiz${quizId}`] = quiz;
    
              const { question, answer, ...rest } = quiz;
    
              var optionsList = []
              for (var key in rest) {
                var value = rest[key];
                if (value !== "") {
                  optionsList.push(value)
                }
              }
              const { option0, option1, option2, option3 } = quiz;
    
              var options = ""
              for (let i = 0; i < optionsList.length; i++) {
                options += `<label class="options">${optionsList[i]}
                  <input type="radio" name="radio" value=${optionsList[i]}/>
                  <span class="checkmark"></span>
              </label>`
              }
    
              const div = document.createElement("div")
    
  
                const quizHtml = `<div class="container my-1">
                    <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                        <div class="py-2 h5"><b>Q. ${question}</b></div>
                        <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                           ${options}
                        </div>
                    </div>
                </div>`
    
    
                const submitBtn = `<button type="button" class="btn btn-primary" onclick="answerSubmit()">Submit</button>`
    
               
                div.style = "text-align:start"
                div.style = "width:90%"
                div.id = `quiz${quizId}`
                div.className = "quizClass"
                div.innerHTML = quizHtml
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"
    
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
    
    
              clickTag.setAttribute("onclick", "editModal('editQuiz',this.previousElementSibling.id,this.parentElement.id)")
    
              // quizContainerArray[`${quizArray}`]=quiz[0]
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'quiz')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
              quizDiv.appendChild(dropImg)
              quizDiv.appendChild(div)
              quizDiv.appendChild(clickTag)
              quizDiv.appendChild(deleteTag)
  
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              parentContentCards.appendChild(quizDiv)
              if(updatesElemId){
              quizContainerArray[`quizDiv${quizId}`] = {quiz:quiz,updates:`updates${idCount}`}
              tempArray[`quizDiv${quizId}`] = {type:"7",quiz:quiz,updates:`updates${idCount}`}
              }else{
                quizContainerArray[`quizDiv${quizId}`] = {quiz:quiz}
                 tempArray[`quizDiv${quizId}`] = {type:"7",quiz:quiz}
              }

              submitBtnDiv.style.display = "block"
              quizId += 1;
    
            }
            else if(data.type==="8"){
              let btnName = data.name
              let btnLink = data.link
    
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"
    
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'button')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
              let btnDiv = document.createElement("div")
              btnDiv.className = "btnDiv dragDiv"
              btnDiv.id = `btnLinkDiv${buttonId}`
    
              let linkDiv = document.createElement("div")
              linkDiv.className = "linkDiv"
              linkDiv.id = "btnLink" + buttonId
    
              clickTag.setAttribute("onclick", `editModal("editButton",this.previousElementSibling.id,this.parentElement.id)`)
  
              let btnTag = `<a href=${btnLink} id="linkTag${buttonId}" target="_blank" class="linkBtn">${btnName}</a>`
    
              linkDiv.innerHTML = btnTag
    
              let btnColor = data.bgColor
    
              $('#createModal').modal('hide');
              btnDiv.appendChild(dropImg)
              btnDiv.appendChild(linkDiv)
              btnDiv.appendChild(clickTag)
              btnDiv.appendChild(deleteTag)
              parentContentCards.appendChild(btnDiv)

              if(updatesElemId){
                btnContainerArray[`btnLinkDiv${buttonId}`] = { name: btnName, link: btnLink, bgColor: btnColor,updates:`updates${idCount}` }
                tempArray[`btnLinkDiv${buttonId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor,updates:`updates${idCount}` }
              }else{
                btnContainerArray[`btnLinkDiv${buttonId}`] = { name: btnName, link: btnLink, bgColor: btnColor }
                tempArray[`btnLinkDiv${buttonId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor }
              }

              let childElem = document.getElementById(`linkTag${buttonId}`)
  
              childElem.style.backgroundColor = btnColor
              submitBtnDiv.style.display = "block"
              buttonId += 1;
            }
           /* else if(data.type==="9"){
              let imgId = `imgLink${imgLinkId}`
              var div = document.createElement('div')
              div.className = "imgLink dragDiv"
              div.id = imgId
              div.draggable = true
    
              var dropImg = document.createElement("img")
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = sort
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"  
    
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = pen
    
              clickTag.appendChild(editImg)
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'link')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = close
    
              deleteTag.append(deleteImg)
    
    
              const { link, image } = data
              if(updatesElemId){
                imgLinkContainerArray[`imgLink${imgLinkId}`] = { link:link, image: image,updates:`updates${idCount}` }
                tempArray[`imgLink${imgLinkId}`] = { type: "9", link: link, image: image,updates:`updates${idCount}` }
              }else{
               imgLinkContainerArray[`imgLink${imgLinkId}`] = { link:link, image: image }
              tempArray[`imgLink${imgLinkId}`] = { type: "9", link: link, image: image }
              }

    
              let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${URL.createObjectURL(image[0])}" alt=""/></a>`
    
              let imgDiv = document.createElement("div")
              imgDiv.className = "linkImgClass"
              imgDiv.id = "img" + imgId
    
              imgDiv.innerHTML = imgLinkDiv
    
              div.appendChild(dropImg)
              div.appendChild(imgDiv)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
    
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              parentContentCards.appendChild(div)
              submitBtnDiv.style.display = "block"
              buttonId += 1;
              imgLinkId += 1;
              clickTag.setAttribute("onclick", `editModal("editImgLink",this.previousElementSibling.id,this.parentElement.id)`)
            }
            */
            else if(data.type==="10"){
              if(updatesElemId){
                 addUpdateSpace(parentContentCards,`updates${idCount}`)
              }else{
                 addSpace()
              }
             
            }
            else if(data.type==="11"){

            
  
                let hyperLinks =[]
                hyperLinks=data.hyperlink
      
                let hyperDivId=`hyperLink${hyperLinkId}`
      
                var div = document.createElement('div')
                div.className = "hyperLinksContainer"
                div.id = hyperDivId
                div.draggable = true
      
                var dropImg = document.createElement("img")
                dropImg.className="dragImg"
                dropImg.height = 20
                dropImg.width = 30
                dropImg.src = dragImageIcon
      
                var clickTag = document.createElement("a")
                clickTag.href = "#"
      
                var editImg = document.createElement('img')
                editImg.width = 20
                editImg.height = 20
                editImg.src = editImageIcon
  
                clickTag.appendChild(editImg)
      
                clickTag.setAttribute("onclick", `editModal("editHyperLink",this.previousElementSibling.id,this.parentElement.id)`)
      
                var deleteTag = document.createElement("a")
                deleteTag.href = "#"
                deleteTag.setAttribute("onclick", "deleteItem(this,'hyperLink')")
      
                var deleteImg = document.createElement("img")
                deleteImg.width = 20
                deleteImg.height = 20
                deleteImg.src = deleteImageIcon
      
                deleteTag.append(deleteImg)
      
                let hyperLinkContainer=document.createElement("div")
                hyperLinkContainer.className="hyperLinksDiv"
                hyperLinkContainer.id=`linksDiv${hyperLinkId}`
      
                let hyperLinkTag="";
                hyperLinks.forEach((e,i)=>{
                  hyperLinkTag+=
                  `<div class="hyperLink">
                    <div class="linkDiv">
                        <a href="${e.link}" target="_blank">
                            <img src="${e.image[0]}" alt="">
                        </a>
                    </div>
                    <div class="captionDiv">
                        ${e.caption}
                    </div>
                </div>`
                })
      
                hyperLinkContainer.innerHTML=hyperLinkTag
                div.appendChild(dropImg)
                div.appendChild(hyperLinkContainer)
                div.appendChild(clickTag)
                div.appendChild(deleteTag)
      
                let updatesContent;
                let updatesContentId;
                let parentDivId;
      
      
                if (pageTitle !==""){
                //  updatesContentId= pageTitle.split("_")[0]
               //  updatesContent=document.getElementById(updatesContentId)
               //   parentDivId= updatesContentId.split("").pop()
                }
      
                  $('#createModal').modal('hide');
                  document.getElementById("emptyPage")?.remove()
                  if(updatesElemId){
                    parentContentCards.appendChild(div)
                    hyperLinkArray[`${hyperDivId}`] = {hyperLinkCards:hyperLinks,updates:`updates${idCount}` }
                    tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards:hyperLinks,updates:`updates${idCount}` }
                  }else{
                    parentContentCards.appendChild(div)
                    hyperLinkArray[`${hyperDivId}`] = {hyperLinkCards:hyperLinks }
                    tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards:hyperLinks }
                  }
      
                  hyperLinkId+=1;
            
            }
            else if(data.type==="12"){

              const {heading,bgcolor,show,updates}=data
             // let updateDivId=modalBody.children[0].id.split("_")[0]

              var div = document.createElement('div')
              div.className = "updatesDivContainer"
              div.id = `updatesDivContainer${updatesId}`
              div.draggable = true
              var dropImg = document.createElement("img")
              dropImg.className="dragImg"
              dropImg.height = 20
              dropImg.width = 20
              dropImg.src = dragImageIcon
    
              var clickTag = document.createElement("a")
              clickTag.href = "#"
    
    
              var editImg = document.createElement('img')
              editImg.width = 20
              editImg.height = 20
              editImg.src = editImageIcon
    
              clickTag.appendChild(editImg)
    
              var deleteTag = document.createElement("a")
              deleteTag.href = "#"
              deleteTag.setAttribute("onclick", "deleteItem(this,'updates')")
    
              var deleteImg = document.createElement("img")
              deleteImg.width = 20
              deleteImg.height = 20
              deleteImg.src = deleteImageIcon
    
              deleteTag.append(deleteImg)
    
              clickTag.setAttribute("onclick", `editModal("editUpdates",this.previousElementSibling.id,this.parentElement.id)`)
    
              let updaesContainer=document.createElement("div")
              updaesContainer.className="updatesDivBox"
              updaesContainer.id=`updatesDiv${updatesId}`

    
              let updatesTag=`<div class="headingDiv" style="background-color:${bgcolor}" id="updatesHeadingDiv${updatesId}">${heading}</div>
              <div class="updatesItems" id="updatesItems${updatesId}"></div>
              <div class="addButton">
                <div class="updatesBtns">
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('heading',this)">Heading</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('description',this)">Description</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('image',this)">Image</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('video',this)">Video</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('animation',this)">Animation</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('quiz',this)">Quiz</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('link',this)">Link</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this)">Button</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('hyperLink',this)">Hyperlink</button>
                  <button type="button" class="btn updatesItems${updatesId}_btn" onclick="addSpace('updates',this)">Space</button>
                </div>
                <div>
                  <button type="button" onclick="updatesBtnsFn(this)" id="updatesDiv${updatesId}_btn" class="updatesAddBtn rounded-circle">+</button>
                </div>
              </div>`

   
              
              updaesContainer.innerHTML=updatesTag
              div.appendChild(dropImg)
              div.appendChild(updaesContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
  
                $('#createModal').modal('hide');
                document.getElementById("emptyPage")?.remove()
                updatesArray[`updatesDivContainer${updatesId}`] = {heading:heading,show:show,bgColor:bgcolor,updates:updates }
                tempArray[`updatesDivContainer${updatesId}`] = { type: "12", heading:heading,show:show,bgColor:bgcolor,updates:updates }
              
                parentContentCards.appendChild(div)

                fetchElem(updates,`updatesItems${updatesId}`)
                updatesId+=1;
    
                const updatesElemClassSort=document.querySelectorAll('.updatesDivContainer')
    
                for (var i = 0; i < updatesElemClassSort?.length; i++) {
                    let ParentId=updatesElemClassSort[i].id
                    let idCount= ParentId.split("").pop()
                    let dragAreaUpdates=document.getElementById(`updatesItems${idCount}`)  
                    if(dragAreaUpdates){
                      new Sortable(dragAreaUpdates,{
                        filter:'.titleDiv',
                        handle:".dragImg",
                        Animation:350
                      })
                    }
                  }
              
    
               updatesBtnsFn=(event)=>{
                  let btnDiv=event.id.split("_")[0]
                  $(`#${btnDiv} .updatesBtns`).toggleClass("active");
              }
    
            }
          })
        }

        let gotoData;

        window.onload=async()=> {
          let pageData= await fetchData
          gotoData= await fetchGotoData
          fetchElem(pageData)
      }
    


      function addUpdateSpace(element,updates) {
        let updatesDivId=element.id
        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let parentDiv = document.getElementById(`${updatesDivId}`)
        let spaceDiv = document.createElement('div')
        spaceDiv.className = "spaceDiv dragDiv"
        spaceDiv.id = `space${emptySpaceCount}`
        spaceDiv.style = "height:20px"
        spaceDiv.draggable = true

        var dropImg = document.createElement("img")
        dropImg.className="dragImg"
        dropImg.height = 20
        dropImg.width = 20
        dropImg.src = sort

        var clickTag = document.createElement("a")
        clickTag.href = "#"

        var editImg = document.createElement('img')
        editImg.width = 20
        editImg.height = 20
        editImg.src = pen

        clickTag.appendChild(editImg)

        var deleteTag = document.createElement("a")
        deleteTag.href = "#"
        //
        deleteTag.setAttribute("onclick", "deleteItem(this,'space')")

        var deleteImg = document.createElement("img")
        deleteImg.width = 20
        deleteImg.height = 20
        deleteImg.src = close

        deleteTag.append(deleteImg)
        spaceDiv.appendChild(dropImg)
        spaceDiv.appendChild(deleteTag)
        parentDiv.appendChild(spaceDiv)

        emptyPageArray[`space${emptySpaceCount}`] = { "type": "10",updates:`${updates}`}
        tempArray[`space${emptySpaceCount}`] = { "type": "10",updates:`${updates}`}
         
        emptySpaceCount += 1;

      }

      function addSpace(element,updates) {
        let updatesSpace=updates?.className?.split(" ")[1].split("_")[0]
        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let parentDiv = document.getElementById("contentCard")
        let spaceDiv = document.createElement('div')
        spaceDiv.className = "spaceDiv dragDiv"
        spaceDiv.id = `space${emptySpaceCount}`
        spaceDiv.style = "height:20px"
        spaceDiv.draggable = true

        var dropImg = document.createElement("img")
        dropImg.className="dragImg"
        dropImg.height = 20
        dropImg.width = 20
        dropImg.src = sort

        var clickTag = document.createElement("a")
        clickTag.href = "#"

        var editImg = document.createElement('img')
        editImg.width = 20
        editImg.height = 20
        editImg.src = pen

        clickTag.appendChild(editImg)

        var deleteTag = document.createElement("a")
        deleteTag.href = "#"
        //
        deleteTag.setAttribute("onclick", "deleteItem(this,'space')")

        var deleteImg = document.createElement("img")
        deleteImg.width = 20
        deleteImg.height = 20
        deleteImg.src = close

        deleteTag.append(deleteImg)
        spaceDiv.appendChild(dropImg)
        spaceDiv.appendChild(deleteTag)
        parentDiv.appendChild(spaceDiv)
        if(updatesSpace){
          let updatesDiv= document.getElementById(updatesSpace)
          let updatesCount=updatesSpace.split("").pop()
          updatesDiv.appendChild(spaceDiv)
          emptyPageArray[`space${emptySpaceCount}`] = { "type": "10",updates:`updates${updatesCount}`}
          tempArray[`space${emptySpaceCount}`] = { "type": "10",updates:`updates${updatesCount}`}
         }else{
           parentDiv.appendChild(spaceDiv)
           emptyPageArray[`space${emptySpaceCount}`] = { "type": "10" }
           tempArray[`space${emptySpaceCount}`] = { "type": "10" }
         }
        emptySpaceCount += 1;

      }


      function showModal(element, value) {

        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        document.getElementById("pageContent").innerHTML = ""
        if (element === "heading") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Heading"
          modalTitle.className=""

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('input')
          input.id = "headingId" + headingDivId
          input.className = "form-control headingClass"
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="colorPickerId" value="${pageBgColor}">
          </div>`
          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"

          mainDiv.innerHTML = colorPick
          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)
          changeToRichtext([`headingId${headingDivId}`])
        }
        else if (element === "headingDesc") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Description"
          modalTitle.className=""

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('textarea')
          input.id = "headingDescId" + headingDescId
          input.className = "form-control headingDescClass"


          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descColorPicker" value="${pageBgColor}">
          </div>`

          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"
          mainDiv.innerHTML = colorPick

          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)

          //CKEDITOR.replace(`headingDescId`+headingDescId,{ toolbar : 'Full', toolbarLocation : 'bottom' });

          changeToRichtext([`headingDescId${headingDescId}`])

        }
        else if (element === "image") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Images"
          modalTitle.className=""

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgCard"
          //
          cardDiv.id = `imgContainerDiv${imageContainerId}`
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <form action="" method="post" class="dragover">
                      <span class="inner"><span class="select">Browse</span></span>
                      <input name="file" type="file" class="file" multiple accept="image/*"/>
                  </form>
                  <div class="imgContainer">
                  </div>`

          modalBody.appendChild(cardDiv)

          files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.imgContainer')
          container.id = "imgContainer" + imageContainerId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            let file = input.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) {
                files.push(file[i])
              }

            }

            //

            imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = files
            tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: files }


            form.reset();
            showImages()
          })

          showImages = () => {
            let images = '';
            files.forEach((e, i) => {
              images += `<div class="image box" draggable="true"">
                        <img src=${URL.createObjectURL(e)} alt="img" >
                       <span onclick="delImages(${i})"> &times;</span>
                    </div>`
            })
            container.innerHTML = images

          }

          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          imageId += 1


        }
        else if (element === "quiz") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Quiz"
          modalTitle.className=""
          var modalBody = document.getElementById('pageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClass"
          formDiv.id = "quizDiv" + quizId
          var options = ""
          for (let i = 0; i < 4; i++) {
            options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option${i}" placeholder="option ${i + 1}" required name="option${i}" />
                </div>`
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" />
          </div>`

          var quizDivContainer =
            `<div class="row g-3">
               <div class="col-12">
                <textarea name="quizQstn" id="question"${quizId} />
               </div>
               ${options}
               ${answerDiv}
              </div>`


          var divOne = document.createElement("div")
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          // formDiv.innerHTML = quizDivContainer

          modalBody.appendChild(formDiv)
          // CKEDITOR.replace(`question${quizId}`,{ toolbar : 'Full', toolbarLocation : 'bottom' });



        }
        else if (element === 'video') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Video"
          modalTitle.className=""
          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          cardDiv.id = "videoContainer" + videoContainerId

          //
          cardDiv.innerHTML = `<div class="top">
                  <p>Import videos</p>
                </div>
                <form action="" method="post" class="dragover">
                    <span class="inner"><span class="select">Browse</span></span>
                    <input name="file" type="file" class="file" accept="video/mp4"/>
                </form>
                <div class="videoModalContainer"></div>`

          modalBody.appendChild(cardDiv)

          const maxAllowedSize = 10 * 1024 * 1024;

          let files = "",
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainer')
          //
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            files = input.files[0];

            if (files.size < maxAllowedSize) {
              videoContainerArrary[`DivvideoContainer${videoContainerId}`] = files
              tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: files }
              form.reset();
              showVideos()
            } else {
              container.insertAdjacentHTML('afterend', '<p style="color:red">Maximum video size is 10MP</p>');
            }
          })

          const showVideos = () => {
            let videos = `<div class="video" id="videoId" draggable="true">
                      <video src=${URL.createObjectURL(files)} alt="video" />
                      <span onclick="delVideos()">&times;</span>
                  </div>`
            container.innerHTML = videos

          }


          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          videoTempId = videoContainerId;

        }
        else if (element === "animation") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Animations"
          modalTitle.className=""
          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = "animationsDiv" + animationId
          cardDiv.innerHTML = `<div class="top">
                  <p>Import animations</p>
                </div>
                <form action="" method="post" class="dragover">
                    <span class="inner"><span class="select">Browse</span></span>
                    <input name="file" type="file" class="file" multiple accept="image/gif"/>
                </form>
                <div class="animationContainer">
                </div>`

          modalBody.appendChild(cardDiv)

          let files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationContainer')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            let file = input.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) files.push(file[i])
            }
            animationContainerArray[`animationsDiv${animationId}`] = files

            // animation data

            tempArray[`animationsDiv${animationId}`] = { type: "6", animations: files }

            form.reset();
            showAnimations()
          })

          const showAnimations = () => {
            let animations = '';
            files.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                      <img src=${URL.createObjectURL(e)} alt="animation">
                      <span onclick="delAnimations(${i})">&times;</span>
                  </div>`
            })
            container.innerHTML = animations

          }

          delAnimations = (index) => {
            files.splice(index, 1)
            showAnimations()
          }

          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })


        }
        else if (element === "pageTitle") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")

          modalTitle.innerText = "Add Page Title"
          var modalBody = document.getElementById('pageContent')
          var pageTitle = ` <div class="col-md-12">
              <input type="text" class="form-control" id="pageTitleField">
            </div>
            <div class="col-md-6">
              <label for="colorId" class="form-label">Color</label>
              <input type="text" class="form-control" id="colorId" value="#fcfcfc">
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose Color</label>
              <input type="color" class="form-control form-control-color" id="colorPickerId" value="#fcfcfc">
            </div>`

          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          parentDiv.innerHTML = pageTitle
          modalBody.appendChild(parentDiv)

          var colorPickerField = document.getElementById("colorPickerId")
          let colorInputField = document.getElementById("colorId")

          colorPickerField.addEventListener("change", (event) => {
            colorInputField.value = colorPickerField.value
          });

          changeToRichtext([`pageTitleField`])


        }
        else if (element === 'button') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Button"
          modalTitle.className=""
          var modalBody = document.getElementById('pageContent')

          let buttonInput = `<div class="row g-3">
            <div class="col-12">
              <input type="text" class="form-control" id="btnName" placeholder="Name">
            </div>
            <div class="col-12">
              <input type="text" class="form-control" id="btnLinkId" placeholder="Link">
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose background Color</label>
              <input type="color" class="form-control form-control-color" id="btnColorPicker" value="#fcfcfc">
            </div>
          </div>`

          let buttonDiv = document.createElement("div")
          buttonDiv.id = "btnLink"
          buttonDiv.className = "row g-3"

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = `btnLinkDiv${buttonId}`
          mainDiv.innerHTML = buttonInput


          modalBody.appendChild(mainDiv)

        }
        else if (element === "imageLink") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Link"
          modalTitle.className=""
          var modalBody = document.getElementById('pageContent')

          let linkInput = `<input class="form-control mb-3 linkInput" type="text" id="imgLinkField" placeholder="Enter link">`


          let imgLinkContainer = `<div class="container col-md-12">
          <div class="mb-3">
                <input class="form-control" type="file" id="formFile" accept="image/*">
            </div>
            <img id="linkImage" src="" class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `imgLink${imgLinkId}`

          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          let imgInputId = document.getElementById("formFile")
          let imgDiv = document.getElementById("linkImage")

          let linkInputElem = document.getElementById("imgLinkField")

          let files;

          imgInputId.addEventListener("change", () => {
            files = event.target.files[0];
            imgDiv.src = URL.createObjectURL(files);
            imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: linkInputElem.value, image: files }
            tempArray[`imgLink${imgLinkId}`] = { type: "9", link: linkInputElem.value, image: files }
          })

          linkInputElem.addEventListener("change", () => {
            imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: linkInputElem.value, image: files }
            tempArray[`imgLink${imgLinkId}`] = { type: "9", link: linkInputElem.value, image: files }

          })

        }
        else if(element === "hyperLink"){
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Hyperlink"
          modalTitle.className=""
          var modalBody = $("#pageContent")

          var formContent=
          `<form class="hyperLinkForm" id="hyperLink_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">
                <input class="inputItem form-control" type="text" name="link" />
                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgInput0_id" onchange="imgOnchangeFn(event)">
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput0">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInput0" name="caption" />
              </div>
              <div class="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addInputs()">+</button>
              </div> 
            </div>

          </form>`


          let mainContainer = document.createElement("div")
          mainContainer.className ='hyperLinkModalDiv'
          mainContainer.id=`modal_hyperLink${hyperLinkId}`
          mainContainer.innerHTML=formContent

          modalBody.append(mainContainer)

          var i =0;
          var length;

         addInputs=()=>{
          
          i++;
            
          let  addContent= `<form  class="hyperLinkForm"id="hyperLink_form${i}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${i}">
              <div class="formDiv">
                <input class="inputItem form-control" type="text" name="link" />
                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgInput${i}_id" onchange="imgOnchangeFn(event)">
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput${i}">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" name="caption" id="captionInput${i}" />
              </div>
              <div>
                <button type="button" class="btn btn-danger" name="remove" id="${i}" onClick="removeInputs(this)">X</button>
              </div> 
            </div> </form>`

            $(".hyperLinkModalDiv").append(addContent)

            changeToRichtext([`captionInput${i}`])

          }

          removeInputs=(e)=>{
            
            var button_id = e.id     
           $('#hyperLink_form'+button_id).remove();
          }

          changeToRichtext([`captionInput0`])

          imgOnchangeFn=(event)=>{
            let linkid=event.target.id
            let linkDivId=linkid.split("_")[0]
            let imgDiv=document.getElementById(linkDivId)

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }
        }
        else if(element === "updates"){
          $('#createModal').modal('show');
          $("#pageTitle").html("Add Updates")
          var modalBody = $("#pageContent")

          let updatesElem= `
            <input type="text" class="form-control" placeholder="Enter title" id="updatesHeading" />
            <div class="bgDiv">
              <input type="color" id="bgColor" class="updatesBgColor form-control form-control-color" value="#f2f2f2" />
              <label for="bgColor" class="form-check-label">Background Color</label>
            </div>
            
            <div class="mb-3 form-check">
              <label for="show" class="form-check-label">Show</label>
              <input type="checkbox" class="form-check-input" id="show" name="show" value="show" />
            </div>
          `
          let mainContainer = document.createElement("div")
          mainContainer.className ='updatesDiv'
          mainContainer.id=`updatesDivContainer${updatesId}_modal`
          mainContainer.innerHTML=updatesElem

          modalBody.append(mainContainer)
          changeToRichtext([`updatesHeading`])
        }
      
        const errorsModal = document.querySelectorAll('.error');

        errorsModal.forEach(error => {
          error.remove();
        });
      }


      function showUpdatesModal(element,updatesDivBox) {

        let menuToggles = document.querySelector(".menuToggles");
        menuToggles.classList.remove("active");

        let updatesDivClass=updatesDivBox.className.split(" ")[1].split("_")[0]

        let updatesIdCount=updatesDivClass.split("").pop()

        document.getElementById("pageContent").innerHTML = ""
        if (element === "heading") {

          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
            modalTitle.innerText = "Add Updates Heading"
            modalTitle.className=`${updatesDivClass}_modal`
          
          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('input')
          input.id = "headingId" + headingDivId
          input.className = "form-control headingClass"
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="colorPickerId" value="${pageBgColor}">
          </div>`
          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"

          mainDiv.innerHTML = colorPick
          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)
          changeToRichtext([`headingId${headingDivId}`])
        }
        else if (element === "description") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Description"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var input = document.createElement('textarea')
          input.id = "headingDescId" + headingDescId
          input.className = "form-control headingDescClass"


          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descColorPicker" value="${pageBgColor}">
          </div>`

          let mainDiv = document.createElement("div")
          mainDiv.className = "row g-3 mt-2"
          mainDiv.innerHTML = colorPick

          modalBody.appendChild(input)
          modalBody.appendChild(mainDiv)

          changeToRichtext([`headingDescId${headingDescId}`])

        }
        else if (element === "image") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Images"
          modalTitle.className=`${updatesDivClass}_modal`


          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgCard"
          //
          cardDiv.id = `imgContainerDiv${imageContainerId}`
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <form action="" method="post" class="dragover">
                      <span class="inner"><span class="select">Browse</span></span>
                      <input name="file" type="file" class="file" multiple accept="image/*"/>
                  </form>
                  <div class="imgContainer">
                  </div>`

          modalBody.appendChild(cardDiv)

          files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.imgContainer')
          container.id = "imgContainer" + imageContainerId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            let file = input.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) {
                files.push(file[i])
              }

            }

            imagesContainerArrar[`imgContainerDiv${imageContainerId}`] = {images:files,updates:`updates${updatesIdCount}`}

            tempArray[`imgContainerDiv${imageContainerId}`] = { type: "4", images: files,updates:`updates${updatesIdCount}` }

            form.reset();
            showImages()
            dragFunction();
          })

          showImages = () => {

            let images = '';
            files.forEach((e, i) => {
              images += `<div class="image box" draggable="true"">
                        <img src=${URL.createObjectURL(e)} alt="img" >
                       <span onclick="delImages(${i})"> &times;</span>
                    </div>`
            })
            container.innerHTML = images

          }

        }
        else if (element === "quiz") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Quiz"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClass"
          formDiv.id = "quizDiv" + quizId
          var options = ""
          for (let i = 0; i < 4; i++) {
            options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option${i}" placeholder="option ${i + 1}" required name="option${i}" />
                </div>`
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" />
          </div>`

          var quizDivContainer =
            `<div class="row g-3">
               <div class="col-12">
                <textarea name="quizQstn" id="question"${quizId} />
               </div>
               ${options}
               ${answerDiv}
              </div>`


          var divOne = document.createElement("div")
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          // formDiv.innerHTML = quizDivContainer

          modalBody.appendChild(formDiv)
          // CKEDITOR.replace(`question${quizId}`,{ toolbar : 'Full', toolbarLocation : 'bottom' });



        }
        else if (element === 'video') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Images"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          cardDiv.id = "videoContainer" + videoContainerId

          //
          cardDiv.innerHTML = `<div class="top">
                  <p>Import videos</p>
                </div>
                <form action="" method="post" class="dragover">
                    <span class="inner"><span class="select">Browse</span></span>
                    <input name="file" type="file" class="file" accept="video/mp4"/>
                </form>
                <div class="videoModalContainer"></div>`

          modalBody.appendChild(cardDiv)

          const maxAllowedSize = 10 * 1024 * 1024;

          let files = "",
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainer')
          //
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            files = input.files[0];

            if (files.size < maxAllowedSize) {

              videoContainerArrary[`DivvideoContainer${videoContainerId}`] = {files,updates:`updates${updatesIdCount}`}
              tempArray[`DivvideoContainer${videoContainerId}`] = { type: "5", video: files,updates:`updates${updatesIdCount}` }
              form.reset();
              showVideos()
            } else {
              container.insertAdjacentHTML('afterend', '<p style="color:red">Maximum video size is 10MP</p>');
            }
          })

          const showVideos = () => {
            let videos = `<div class="video" id="videoId" draggable="true">
                      <video src=${URL.createObjectURL(files)} alt="video" />
                      <span onclick="delVideos()">&times;</span>
                  </div>`
            container.innerHTML = videos

          }


          button?.addEventListener('click', () => {
            let form = new FormData();
            files.forEach((e, i) => form.append(`file[${i}]`, e))
          })

          videoTempId = videoContainerId;

        }
        else if (element === "animation") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Animations"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = "animationsDiv" + animationId
          cardDiv.innerHTML = `<div class="top">
                  <p>Import animations</p>
                </div>
                <form action="" method="post" class="dragover">
                    <span class="inner"><span class="select">Browse</span></span>
                    <input name="file" type="file" class="file" multiple accept="image/gif"/>
                </form>
                <div class="animationContainer">
                </div>`

          modalBody.appendChild(cardDiv)

          let files = [],
            button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationContainer')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          input.addEventListener("change", () => {
            let file = input.files;
            for (let i = 0; i < file.length; i++) {
              if (files.every(e => e.name !== file[i].name)) files.push(file[i])
            }
            animationContainerArray[`animationsDiv${animationId}`] = {files,updates:`updates${updatesIdCount}`}

            // animation data

            tempArray[`animationsDiv${animationId}`] = { type: "6", animations: files,updates:`updates${updatesIdCount}` }

            form.reset();
            showAnimations()
          })

          const showAnimations = () => {
            let animations = '';
            files.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                      <img src=${URL.createObjectURL(e)} alt="animation">
                      <span onclick="delAnimations(${i})">&times;</span>
                  </div>`
            })
            container.innerHTML = animations

          }

          delAnimations = (index) => {
            files.splice(index, 1)
            showAnimations()
          }

        }
        else if (element === "pageTitle") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")

          modalTitle.innerText = "Add Page Title"
          var modalBody = document.getElementById('pageContent')
          var pageTitle = ` <div class="col-md-12">
              <input type="text" class="form-control" id="pageTitleField">
            </div>
            <div class="col-md-6">
              <label for="colorId" class="form-label">Color</label>
              <input type="text" class="form-control" id="colorId" value="#fcfcfc">
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose Color</label>
              <input type="color" class="form-control form-control-color" id="colorPickerId" value="#fcfcfc">
            </div>`

          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          parentDiv.innerHTML = pageTitle
          modalBody.appendChild(parentDiv)

          var colorPickerField = document.getElementById("colorPickerId")
          let colorInputField = document.getElementById("colorId")

          colorPickerField.addEventListener("change", (event) => {
            colorInputField.value = colorPickerField.value
          });

          changeToRichtext([`pageTitleField`])


        }
        else if (element === 'button') {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Button"
          modalTitle.className=`${updatesDivClass}_modal`
          var modalBody = document.getElementById('pageContent')

          let buttonInput = `<div class="row g-3">
            <div class="col-12">
              <input type="text" class="form-control" id="btnName" placeholder="Name">
            </div>
            <div class="col-12">
              <input type="text" class="form-control" id="btnLinkId" placeholder="Link">
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose background Color</label>
              <input type="color" class="form-control form-control-color" id="btnColorPicker" value="#fcfcfc">
            </div>
          </div>`

          let buttonDiv = document.createElement("div")
          buttonDiv.id = "btnLink"
          buttonDiv.className = "row g-3"

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = `btnLinkDiv${buttonId}`
          mainDiv.innerHTML = buttonInput


          modalBody.appendChild(mainDiv)

        }
        else if (element === "link") {
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates Link"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = document.getElementById('pageContent')

          let linkInput = `<input class="form-control mb-3 linkInput" type="text" id="imgLinkField" placeholder="Enter link">`
          
          let imgLinkContainer = `<div class="container col-md-12">
          <div class="mb-3">
                <input class="form-control" type="file" id="formFileUpdates" accept="image/*">
            </div>
            <img id="linkImage" src="" class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `imgLink${imgLinkId}`

          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          let imgInputId = document.getElementById("formFileUpdates")
          let imgDiv = document.getElementById("linkImage")

          let linkInputElem = document.getElementById("imgLinkField")

          let files;

          imgInputId.addEventListener("change", () => {

            files = event.target.files[0];
            imgDiv.src = URL.createObjectURL(files);
              imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: linkInputElem.value, image: files,updates:`updates${updatesIdCount}` }
              tempArray[`imgLink${imgLinkId}`] = { type: "9", link: linkInputElem.value, image: files,updates:`updates${updatesIdCount}` }
          
          })

          linkInputElem.addEventListener("change", () => {
              imgLinkContainerArray[`imgLink${imgLinkId}`] = { link: linkInputElem.value, image: files,updates:`updates${updatesIdCount}` }
              tempArray[`imgLink${imgLinkId}`] = { type: "9", link: linkInputElem.value, image: files,updates:`updates${updatesIdCount}` }
          })

        }
        else if(element === "hyperLink"){
          $('#createModal').modal('show');
          var modalTitle = document.getElementById("pageTitle")
          modalTitle.innerText = "Add Updates HyperLink"
          modalTitle.className=`${updatesDivClass}_modal`

          var modalBody = $("#pageContent")

          var formContent=
          `<form class="hyperLinkForm" id="hyperLink_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">
                <input class="inputItem form-control" type="text" name="link" />
                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgInput0_id" onchange="imgOnchangeFn(event)">
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput0">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInput0" name="caption" />
              </div>
              <div classs="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addInputs()">+</button>
              </div> 
            </div>

          </form>`


          let mainContainer = document.createElement("div")
          mainContainer.className ='hyperLinkModalDiv'
          mainContainer.id=`modal_hyperLink${hyperLinkId}`
          mainContainer.innerHTML=formContent

          modalBody.append(mainContainer)

          var i =0;
          var length;

         addInputs=()=>{
          
          i++;
            
          let  addContent= `<form class="hyperLinkForm" id="hyperLink_form${i}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${i}">
              <div class="formDiv">
                <input class="inputItem form-control" type="text" name="link" />
                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgInput${i}_id" onchange="imgOnchangeFn(event)">
                  </div>
                  <div class="hyperImgContainer" id="hyperImgInput${i}">
                    
                  </div>
                </div>
                <input class="inputItem form-control" type="text" name="caption" id="captionInput${i}" />
              </div>
              <div>
                <button type="button" class="btn btn-danger" name="remove" id="${i}" onClick="removeInputs(this)">X</button>
              </div> 
            </div> </form>`

            $(".hyperLinkModalDiv").append(addContent)

            changeToRichtext([`captionInput${i}`])

          }

          removeInputs=(e)=>{
            
            var button_id = e.id     
           $('#hyperLink_form'+button_id).remove();
          }

          changeToRichtext([`captionInput0`])

          imgOnchangeFn=(event)=>{
            let linkid=event.target.id
            let linkDivId=linkid.split("_")[0]
            let imgDiv=document.getElementById(linkDivId)

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }
        }
        const errorsModal = document.querySelectorAll('.error');

        errorsModal.forEach(error => {
          error.remove();
        });
      }




      var headingDivId = 0;


      // Delete elem

      function deleteItem(e, element) {

        let cardElem = document.getElementById("contentCard")
        let parent = e.parentNode
        let key = e.parentNode.id

        if (element === "heading") {
          delete headingArray[key]
        } else if (element === "description") {
          delete descriptionArray[key]
        }
        else if (element === "image") {
          delete imagesContainerArrar[key]
        }
        else if (element === "video") {
          delete videoContainerArrary[key]
        }
        else if (element === "quiz") {
          delete quizContainerArray[key]
        }
        else if (element === "animation") {
          delete animationContainerArray[key]
        }
        else if (element === "title") {
          delete titleArray['title']
        }
        else if (element === "button") {
          delete btnContainerArray[key]
        }
        else if (element === 'link') {
          delete imgLinkContainerArray[key]
        } else if (element === "space") {
          delete emptyPageArray[key]
        }else if(element === "hyperLink"){
          delete hyperLinkArray[key]
        }else if(element === "updates"){
          delete updatesArray[key]
        }

        delete tempArray[key]
        parent.remove()

        // bg color remove

        let contentDiv = document.getElementById("contentCard")

        if (cardElem.innerText == "") {
          cardElem.innerHTML = '<h3 id="emptyPage" style="opacity:0.8">Add contents to create page..!</h3>'
          submitBtnDiv.style.display = "none"
          contentDiv.style.backgroundColor = "#fcfcfc"
        }

      }


      // Add Function

      function addElement() {

        let pageTitle=document.getElementById('pageTitle').className

        var modalBody = document.getElementById('pageContent')
        var children = modalBody.children[0].value
        var contentCards = document.getElementById("contentCard")

        if (modalBody.children[0].className === "form-control headingClass") {


          var div = document.createElement('div')
          div.className = "heading dragDiv"
         div.draggable = true
          div.id = "headingId" + headingDivId 
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id
          clickTag.setAttribute("onclick", `editModal("editHeading",this.previousElementSibling.id,this.parentElement.id)`)

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'heading')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          var elem = document.createElement("h2")
          elem.id = "page" + modalBody.children[0].id
          elem.contentEditable = false
          elem.innerText = children
          var ckTextValue = CKEDITOR.instances[modalBody.children[0].id]?.getData()



          let bgColor = document.getElementById(`colorPickerId`).value

          let paraDiv = document.createElement("div")
          paraDiv.className = "headingDiv"

          pageTitle !== ""?paraDiv.id=`heading${headingDivId}`:paraDiv.id=""

          let paraTag = document.createElement("p")
          paraTag.id = "heading" + headingDivId
          paraTag.innerHTML = ckTextValue

          paraDiv.appendChild(paraTag)

          div.appendChild(dropImg)
          div.appendChild(paraDiv)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
           updatesContent=document.getElementById(updatesContentId)
          parentDivId= updatesContentId.split("").pop()
           updatesDivContainer0
          }

          if (ckTextValue !== "") {

            //  
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()

            if(pageTitle !==""){  
              updatesContent.appendChild(div)
              let idCount=updatesContentId.split("").pop()
        
              headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,updates:`updates${idCount}` }
              tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor,updates:`updates${idCount}` }
              let headingDiv = document.getElementById(`headingId${headingDivId}`)
              headingDiv.style.backgroundColor = `${bgColor}`
              headingDivId=headingDivId+1;
            }
            else{
              contentCards.appendChild(div)
              headingArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
              tempArray[`headingId${headingDivId}`] = { "type": "2", heading: ckTextValue, bgColor: bgColor }
              let headingDiv = document.getElementById(`headingId${headingDivId}`)
              headingDiv.style.backgroundColor = `${bgColor}`
              headingDivId += 1
            }
            
            // heading Data

            
            //
            submitBtnDiv.style.display = "block"

          } else {           
            let inputElem = document.getElementById(`cke_headingId${headingDivId}`)
            let errorElem = document.querySelector(".error")
            let errorAll= document.querySelectorAll(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }

        else if (modalBody.children[0].className === "form-control headingDescClass") {
          var div = document.createElement('div')
          div.className = "headingDesc dragDiv"
          div.id = `descriptionDiv${headingDescId}`
          div.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "pageHeadDesc" + modalBody.children[0].id
          clickTag.id = "headDesctag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'description')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          let elemId;
          elemId=`descriptionDiv${headingDescId}`

          clickTag.setAttribute("onclick", `editModal("editDescription",this.previousElementSibling.id,this.parentElement.id)`)

          var ckTextValue = CKEDITOR.instances[modalBody.children[0].id]?.getData()
          var elem = document.createElement("p")
          elem.id = "Description" + headingDescId
          elem.innerHTML = ckTextValue
          div.appendChild(dropImg)
          div.appendChild(elem)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)


          let elemBgColor = document.getElementById("descColorPicker").value

          let updatesContent;
          let updatesContentId;
          let parentDivId;
          
          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
           updatesContent=document.getElementById(updatesContentId)
          parentDivId= updatesContentId.split("").pop()
          }

          if (CKEDITOR.instances[modalBody.children[0].id]?.getData() !== "") {


            if(pageTitle !==""){

              $('#createModal').modal('hide');

              updatesContent.appendChild(div)
              let idCount=updatesContentId.split("").pop()
        
              document.getElementById("emptyPage")?.remove()
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor,updates:`updates${idCount}` }
              tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor,updates:`updates${idCount}` }
              let parentElem = document.getElementById(elemId)
              parentElem.style.backgroundColor = elemBgColor
              submitBtnDiv.style.display = "block"
              headingDescId = headingDescId + 1

            }else{

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            contentCards.appendChild(div)
            descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: elemBgColor }
            tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: elemBgColor }
            let parentElem = document.getElementById(elemId)
            parentElem.style.backgroundColor = elemBgColor
            submitBtnDiv.style.display = "block"
            headingDescId = headingDescId + 1
            }

          } else {
            let inputElem = document.getElementById(`cke_headingDescId${headingDescId}`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }


        }
        else if (modalBody.children[0].className === "imgCard") {


          let ParentId;


          var div = document.createElement('div')
          div.className = "imageContainer dragDiv"

          //
          div.id =modalBody.children[0].id
          div.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var clickTag = document.createElement("a")
          clickTag.href = "#"


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var imgArry;
              
          var imgId=modalBody.children[0].id
          if(pageTitle ==""){
            imgArry = imagesContainerArrar[`${imgId}`]
          } else{
            imgArry = imagesContainerArrar[`${imgId}`]["images"] ;
          }
         
          var imgSrc = document.getElementsByClassName("image")
          var parentContainer = document.getElementsByClassName("imgContainer")
          ParentId = parentContainer[0].id


      /*    for (let i = 0; i < imgSrc.length; i++) {
            imgArry.push(imgSrc[i].children[0].src)
          }
      */

          var imgContainer = document.createElement("div")
          imgContainer.className = "imagesDiv"
          imgContainer.id = parentContainer[0].id
          imgContainer.draggable = true
          //
          clickTag.setAttribute("onclick", `editModal("editImages",this.previousElementSibling.id,this.parentElement.id)`)

          let images = '';
          imgArry.forEach((e, i) => {
            images += `
                    <img src=${URL.createObjectURL(e)} alt="img">
                </div>`
          })


          imgContainer.innerHTML = images

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'image')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)
          var existingElement = document.getElementById(tempId)

          //


          tempId = parentContainer[0].id;

          
          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
            updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }

          if (imgContainer.innerHTML !== "") {

            if(pageTitle !==""){
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              div.appendChild(dropImg)
              div.appendChild(imgContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              updatesContent.appendChild(div)
              submitBtnDiv.style.display = "block"
              imageContainerId += 1
            }else{
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
  
              div.appendChild(dropImg)
              div.appendChild(imgContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              contentCards.appendChild(div)
              submitBtnDiv.style.display = "block"
              imageContainerId += 1
            }

          } else {
            let inputElem = document.querySelector(".imgContainer")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert image...!</p>');
            }
          }


        }
        else if (modalBody.children[0].className === "videoCard") {

          let keyId = modalBody.children[0].id

          var div = document.createElement('div')
          div.className = "videoContainer dragDiv"
          div.id = `Div${keyId}`
          div.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"


          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)

          var parentContainerVideo = document.getElementsByClassName("videoCard")
          var videoArry = [];
          var videoDIv = document.getElementById("videoId")
          var videoSrc = videoDIv?.children[0].src

          var videoLocalSrc;

          if(pageTitle !==""){
            videoLocalSrc = videoContainerArrary[`Div${parentContainerVideo[0].id}`]["files"]
          } else{
            videoLocalSrc = videoContainerArrary[`Div${parentContainerVideo[0].id}`]
          }
          
          var videoName = videoLocalSrc?.name
          var videoType = videoLocalSrc?.type 

          var videoContainer = document.createElement("div")
          videoContainer.className = "videosDiv"
          videoContainer.id = parentContainerVideo[0].id
          videoContainer.draggable = true
          clickTag.setAttribute("onclick", "editModal('editVideo',this.previousElementSibling.id,this.parentElement.id)")

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'video')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          // deleteTag.setAttribute("onclick","return this.parentNode.remove()")

          var existingElement = document.getElementById(videoTempId)

          let videos = '';

          videos = `<video class="video-js vjs-big-play-centered vjs-show-big-play-button-on-pause" controls  preload="auto" alt="video">
                <source src=${videoSrc} type=${videoType} />
            </video>`
          videoContainer.innerHTML = videos

          //
          videoTempId = parentContainerVideo[0].id;

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
            updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }


          let inputElem = document.querySelector(".videoModalContainer")

          if (inputElem.innerHTML !== "") {

            if(pageTitle !==""){
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              div.appendChild(dropImg)
              div.appendChild(videoContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              updatesContent.appendChild(div)
            }else{
              $('#createModal').modal('hide');
              document.getElementById("emptyPage")?.remove()
              div.appendChild(dropImg)
              div.appendChild(videoContainer)
              div.appendChild(clickTag)
              div.appendChild(deleteTag)
              contentCards.appendChild(div)
            }
            submitBtnDiv.style.display = "block"
            videoContainerId += 1
          } else {
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert video...!</p>');
            }
          }
        }
        else if (modalBody.children[0].className === "formClass") {

          let animationKey = modalBody.children[0].id
          var quizDiv = document.createElement('div')
          quizDiv.className = "quizContainer dragDiv"
          quizDiv.id = animationKey
          quizDiv.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = "/assets/img/sort.png"

          var formElem = document.getElementsByClassName("formClass");
          var quiz = [];
          for (var i = 0; i < formElem.length; ++i) {
            const data = Object.fromEntries(new FormData(formElem[i]).entries());
            quiz.push(data);
          }
          var quizData = quiz;

          const { question, answer, ...rest } = quiz[0];

          var optionsList = []
          for (var key in rest) {
            var value = rest[key];
            if (value !== "") {
              optionsList.push(value)
            }
          }
          const { option0, option1, option2, option3 } = quiz[0];

          var options = ""
          for (let i = 0; i < optionsList.length; i++) {
            options += `<label class="options">${optionsList[i]}
              <input type="radio" name="radio" value=${optionsList[i]}/>
              <span class="checkmark"></span>
          </label>`
          }

          const div = document.createElement("div")

          for (var i = 0; i < quiz.length; i++) {
            const quizHtml = `<div class="container my-1">
                <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                    <div class="py-2 h5"><b>Q. ${quiz[i].question}</b></div>
                    <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                       ${options}
                    </div>
                </div>
            </div>`


            const submitBtn = `<button type="button" class="btn btn-primary" onclick="answerSubmit()">Submit</button>`

           
            div.style = "text-align:start"
            div.style = "width:90%"
            div.id = `quiz${quizId}`
            div.className = "quizClass"
            div.innerHTML = quizHtml
          }

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + quizId

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)


          clickTag.setAttribute("onclick", "editModal('editQuiz',this.previousElementSibling.id,this.parentElement.id)")

          // quizContainerArray[`${quizArray}`]=quiz[0]
          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'quiz')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)

          quizDiv.appendChild(dropImg)
          quizDiv.appendChild(div)
          quizDiv.appendChild(clickTag)
          quizDiv.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle?.split("_")[0]
            updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }

          if (quiz[0].quizQstn !== "" && optionsList.length >= 2 && answer) {

            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()

            if(pageTitle !==""){
              let idCount=updatesContentId.split("").pop()
              quizContainerArray[`quizDiv${quizId}`] = {quiz:quiz[0],updates:`updates${idCount}`}
              tempArray[`quizDiv${quizId}`] = {type:"7",quiz:quiz[0],updates:`updates${idCount}`}
              updatesContent.appendChild(quizDiv)
            }else{
              quizContainerArray[`quizDiv${quizId}`] = {quiz:quiz[0]}
              tempArray[`quizDiv${quizId}`] = {type:"7",quiz:quiz[0]}
              contentCards.appendChild(quizDiv)
            }
            submitBtnDiv.style.display = "block"
            quizId += 1;

          } else {
            let qstnElem = document.querySelector(`#question${quizId}`)
            let optionOneElem = document.querySelector(`#option0`)
            let optionTwoElem = document.querySelector(`#option3`)
            let answerElem = document.querySelector(`#answer`)

            let errorQstn = document.querySelector(".qstnerror")
            let errorOptn = document.querySelector(".optnerror")
            let errorAns = document.querySelector(".anserror")

            if (qstnElem.value === "") {
              if (!errorQstn) {
                qstnElem.insertAdjacentHTML('afterend', '<p class="error qstnerror">Please enter the question...!</p>');
              }

            } else {
              if (errorQstn) {
                errorQstn.remove()
              }
            }
            if (optionsList.length < 2) {
              if (!errorOptn) {
                optionTwoElem.parentElement.insertAdjacentHTML('afterend', '<p class="error optnerror">Please enter atleast two options...!</p>');
              }

            } else {
              if (errorOptn) {
                errorOptn.remove()
              }
            }
            if (!answer) {
              if (!errorAns) {
                answerElem.insertAdjacentHTML('afterend', '<p class="error anserror">Please enter the answer...!</p>');
              }
            } else {
              if (errorAns) {
                errorAns.remove()
              }
            }
          }

        }
        else if (modalBody.children[0].className === "animationCard") {

          var div = document.createElement('div')
          div.className = "animationParentContainer dragDiv"
          div.id = modalBody.children[0].id
          div.draggable = true
          var dropAnimation = document.createElement("img")
          dropAnimation.className="dragImg"
          dropAnimation.height = 20
          dropAnimation.width = 20
          dropAnimation.src = "/assets/img/sort.png"


          var imgId=modalBody.children[0].id

          var animationArry
          if(pageTitle ==""){
            animationArry = animationContainerArray[`${imgId}`]
          } else{
            animationArry = animationContainerArray[`${imgId}`]["files"] ;
          }

          var animationContainer = document.createElement("div")
          animationContainer.className = "animationsDiv"
          animationContainer.id = `animations${animationId}`
          animationContainer.draggable = true
          for (let i = 0; i < animationArry.length; i++) {
            animationContainer.innerHTML = `<img src=${animationArry[i]} alt="">`
          }

          let animations = '';
          animationArry.forEach((e, i) => {
            animations += `
                    <img src=${URL.createObjectURL(e)} alt="img">
                </div>`
          })
          animationContainer.innerHTML = animations


          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          clickTag.setAttribute("onclick", "editModal('editAnimation',this.previousElementSibling.id,this.parentElement.id)")
          //  clickTag.setAttribute("onclick", `showModal("editQuiz",${parentQuizContainer[0].id})`)

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = "/assets/img/pen.png"

          clickTag.appendChild(editImg)


          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'animation')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = '/assets/img/close.png'

          deleteTag.append(deleteImg)


          div.appendChild(dropAnimation)
          div.appendChild(animationContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
            updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }

          if (animationContainer.innerHTML !== "") {

            $('#createModal').modal('hide');

            if(pageTitle !==""){
              updatesContent.appendChild(div)
            }else{
              contentCards.appendChild(div)
            }
            document.getElementById("emptyPage")?.remove()
            submitBtnDiv.style.display = "block"

            animationId += 1
          } else {
            let inputElem = document.querySelector(".animationContainer")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert animation...!</p>');
            }
          }

        }
        else if (modalBody.children[0].id === "pageTitleId") {
          let pageTitle = document.getElementById("pageTitleField").value
          let colorPick = document.getElementById("colorId").value
          contentCards.style.backgroundColor = colorPick

          cardbgColor = colorPick

          var dropImg = document.createElement("img")
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var emptyDiv=document.createElement("div")
          emptyDiv.style="height,20px"
          emptyDiv.style="width,20px"

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'title')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)


          var ckTextValue = CKEDITOR.instances['pageTitleField']?.getData()

          let titleDiv = document.createElement("div")
          titleDiv.className = "titleDiv"
          titleDiv.id = "title"
          let heading = document.createElement("p")
          heading.id = "pageHeadingId"
          heading.innerHTML = ckTextValue

          titleDiv.appendChild(emptyDiv)
          titleDiv.appendChild(heading)
          titleDiv.appendChild(clickTag)
          titleDiv.appendChild(deleteTag)

          clickTag.setAttribute("onclick", `editModal("editTitle","pageHeadingId")`)

          if (ckTextValue !== "") {


            //
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            //contentCards.appendChild(titleDiv)
            contentCards.insertBefore(titleDiv, contentCards.firstChild);
            pageBgColor=cardbgColor
            titleArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }
            tempArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }
            //
            submitBtnDiv.style.display = "block"
          } else {
            let inputElem = document.getElementById("cke_pageTitleField")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }
        else if (modalBody.children[0].className === "linkBtnDiv") {
          let btnName = document.getElementById("btnName").value
          let btnLink = document.getElementById("btnLinkId").value

          let parentId = modalBody.children[0].id

          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)
          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'button')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          let btnDiv = document.createElement("div")
          btnDiv.className = "btnDiv dragDiv"
          btnDiv.id = parentId

          let linkDiv = document.createElement("div")
          linkDiv.className = "linkDiv"
          linkDiv.id = "btnLink" + buttonId

          clickTag.setAttribute("onclick", `editModal("editButton",this.previousElementSibling.id,this.parentElement.id)`)

          let btnTag = `<a href=${btnLink} id="linkTag${buttonId}" target="_blank" class="linkBtn">${btnName}</a>`

          linkDiv.innerHTML = btnTag

          let btnColor = document.getElementById("btnColorPicker").value

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
           updatesContent=document.getElementById(updatesContentId)
          parentDivId= updatesContentId.split("").pop()
          }

          if (btnName !== "" && btnLink !== "") {

           
            //
            $('#createModal').modal('hide');

            if(pageTitle !==""){

              let idCount=updatesContentId.split("").pop()
              btnDiv.appendChild(dropImg)
              btnDiv.appendChild(linkDiv)
              btnDiv.appendChild(clickTag)
              btnDiv.appendChild(deleteTag)
              updatesContent.appendChild(btnDiv)
              
              btnContainerArray[`${parentId}`] = { name: btnName, link: btnLink, bgColor: btnColor,updates:`updates${idCount}` }
              tempArray[`${parentId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor,updates:`updates${idCount}` }
            }else{
              btnDiv.appendChild(dropImg)
              btnDiv.appendChild(linkDiv)
              btnDiv.appendChild(clickTag)
              btnDiv.appendChild(deleteTag)
              contentCards.appendChild(btnDiv)
              
              btnContainerArray[`${parentId}`] = { name: btnName, link: btnLink, bgColor: btnColor }
              tempArray[`${parentId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor }
            }

            let childElem = document.getElementById(`linkTag${buttonId}`)

            childElem.style.backgroundColor = btnColor
            submitBtnDiv.style.display = "block"
            buttonId += 1;
          } else {

            let inputName = document.querySelector("#btnName")
            let inputLink = document.querySelector("#btnLinkId")

            let errorName = document.querySelector(".btnError")
            let errorLink = document.querySelector(".linkError")

            if (inputName.value === "") {
              if (!errorName) {
                inputName.insertAdjacentHTML('afterend', '<p class="error btnError">Please enter the button name...!</p>');
              }

            } else {
              if (errorName) {
                errorName.remove()
              }
            }
            if (inputLink.value === "") {
              if (!errorLink) {
                inputLink.insertAdjacentHTML('afterend', '<p class="error linkError">Please enter the link...!</p>');
              }

            } else {
              if (errorLink) {
                errorLink.remove()
              }
            }
          }

        }
        else if (modalBody.children[0].className === "linkImgModalDiv") {

          let imgId = modalBody.children[0].id
          var div = document.createElement('div')
          div.className = "imgLink dragDiv"
          div.id = imgId
          div.draggable = true

          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id

          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'link')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)


          let linkData = imgLinkContainerArray[`${imgId}`]
          
          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
           updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }

          if (linkData === undefined) {
            let imageLink = document.querySelector("#formFile")

            let errorName = document.querySelector(".linkName")
            let errorLink = document.querySelector(".linkImage")

            if (!errorLink) {
              imageLink.insertAdjacentHTML('afterend', '<p class="error linkImage">Please enter the link and insert a image...!</p>');
            } else {
              errorLink.remove()
            }
          }

          const { link, image } = imgLinkContainerArray[`${imgId}`]

          //

          let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${URL.createObjectURL(image)}" alt=""/></a>`

          let imgDiv = document.createElement("div")
          imgDiv.className = "linkImgClass"
          imgDiv.id = "img" + imgId

          imgDiv.innerHTML = imgLinkDiv

          div.appendChild(dropImg)
          div.appendChild(imgDiv)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          if (link !== "" && image !== "") {

            if(pageTitle !==""){
              updatesContent.appendChild(div)
            }else{
              contentCards.appendChild(div)
            }
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            //
            submitBtnDiv.style.display = "block"
            buttonId += 1;
            imgLinkId += 1;
          }
          clickTag.setAttribute("onclick", `editModal("editImgLink",this.previousElementSibling.id,this.parentElement.id)`)
        }
        else if(modalBody.children[0].className === "hyperLinkModalDiv"){

          let hyperLinks =[]

          let hyperLinkForms=document.getElementsByClassName("hyperLinkForm")

          for (let h=0;h<hyperLinkForms.length;h++){
            let form = hyperLinkForms[h];
            let data = new FormData(form);
            data = data.entries();              
            var obj = data.next();
            var retrieved = {}; 
                
            while(undefined !== obj.value) {  
              retrieved["caption"]=CKEDITOR.instances[`captionInput${h}`]?.getData()
              if(obj.value[0]==="file"){
                retrieved['image']=[obj.value[1]];
              }else{
                retrieved[obj.value[0]] = obj.value[1];
              }
              obj = data.next();   
              retrieved["caption"]=CKEDITOR.instances[`captionInput${h}`]?.getData()           
            }

            var formElem = document.getElementById(`hyperLink_form${h}`);
            const inputFields=formElem.querySelectorAll(`input`)

            let isEmpty=false;

            for(let i = 0; i < inputFields.length; i++){
              let inputType = inputFields[i].type
              let inputName = inputFields[i].name
              if(inputName === "link" && inputFields[i].value===""){
                isEmpty=true
              }else if(inputType==="file" && inputFields[i].files.length===0){
               isEmpty=true
              }
              else if(CKEDITOR.instances[`captionInput${h}`]?.getData()===""){
                isEmpty=true
              }
            }

            if(isEmpty===true){
              if($(`.formError${h}`).length==0){
                $(`#hyperLink_form${h}`).after(`<span class="formError${h} error">Please enter the field..!</span>`)
              }   
            }else{
              $(`.formError${h}`).remove()
              hyperLinks.push(retrieved)
            }
          }

          let modalId = modalBody.children[0].id

          let hyperDivId=modalId.split("_")[1]

          var div = document.createElement('div')
          div.className = "hyperLinksContainer"
          div.id = hyperDivId
          div.draggable = true

          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 30
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"
          arg = "page" + modalBody.children[0].id
          clickTag.id = "tag" + modalBody.children[0].id



          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          
          clickTag.appendChild(editImg)

          clickTag.setAttribute("onclick", `editModal("editHyperLink",this.previousElementSibling.id,this.parentElement.id)`)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'hyperLink')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          let hyperLinkContainer=document.createElement("div")
          hyperLinkContainer.className="hyperLinksDiv"
          hyperLinkContainer.id=`linksDiv${hyperLinkId}`

          let hyperLinkTag="";
          hyperLinks.forEach((e,i)=>{
            hyperLinkTag+=
            `<div class="hyperLink">
              <div class="linkDiv">
                  <a href="${e.link}" target="_blank">
                      <img src="${URL.createObjectURL(e.image[0])}" alt="">
                  </a>
              </div>
              <div class="captionDiv">  
                  ${e.caption}
              </div>
          </div>`
          })

          hyperLinkContainer.innerHTML=hyperLinkTag
          div.appendChild(dropImg)
          div.appendChild(hyperLinkContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          let updatesContent;
          let updatesContentId;
          let parentDivId;


          if (pageTitle !==""){
            updatesContentId= pageTitle.split("_")[0]
           updatesContent=document.getElementById(updatesContentId)
            parentDivId= updatesContentId.split("").pop()
          }

          if(hyperLinks.length>0){
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            if(pageTitle !==""){
              updatesContent.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = {hyperLinkCards:hyperLinks,updates:`updates${parentDivId}` }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards:hyperLinks,updates:`updates${parentDivId}` }
            }else{
              contentCards.appendChild(div)
              hyperLinkArray[`${hyperDivId}`] = {hyperLinkCards:hyperLinks }
              tempArray[`${hyperDivId}`] = { type: "11", hyperLinkCards:hyperLinks }
            }

            hyperLinkId+=1;
          }

        } 
        else if(modalBody.children[0].className === "updatesDiv"){

          let updateDivId=modalBody.children[0].id.split("_")[0]

          var div = document.createElement('div')
          div.className = "updatesDivContainer"
          div.id = `${updateDivId}`
          div.draggable = true
          var dropImg = document.createElement("img")
          dropImg.className="dragImg"
          dropImg.height = 20
          dropImg.width = 20
          dropImg.src = dragImageIcon

          var clickTag = document.createElement("a")
          clickTag.href = "#"


          var editImg = document.createElement('img')
          editImg.width = 20
          editImg.height = 20
          editImg.src = editImageIcon

          clickTag.appendChild(editImg)

          var deleteTag = document.createElement("a")
          deleteTag.href = "#"
          deleteTag.setAttribute("onclick", "deleteItem(this,'updates')")

          var deleteImg = document.createElement("img")
          deleteImg.width = 20
          deleteImg.height = 20
          deleteImg.src = deleteImageIcon

          deleteTag.append(deleteImg)

          clickTag.setAttribute("onclick", `editModal("editUpdates",this.previousElementSibling.id,this.parentElement.id)`)

          let updaesContainer=document.createElement("div")
          updaesContainer.className="updatesDivBox"
          updaesContainer.id=`updatesDiv${updatesId}`

          let elemBgColor = $(".updatesBgColor").val()
          let updatesHeading=CKEDITOR.instances['updatesHeading']?.getData()
          let accordionInput = $('#show:checked').val();

          let accordionShow = accordionInput===undefined?false:true

          let updatesTag=`<div class="headingDiv" style="background-color:${elemBgColor}" id="updatesHeadingDiv${updatesId}">${updatesHeading}</div>
          <div class="updatesItems" id="updatesItems${updatesId}"></div>
          <div class="addButton">
            <div class="updatesBtns">
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('heading',this)">Heading</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('description',this)">Description</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('image',this)">Image</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('video',this)">Video</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('animation',this)">Animation</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('quiz',this)">Quiz</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('link',this)">Link</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('button',this)">Button</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="showUpdatesModal('hyperLink',this)">Hyperlink</button>
              <button type="button" class="btn updatesItems${updatesId}_btn" onclick="addSpace('updates',this)">Space</button>
            </div>
            <div>
              <button type="button" onclick="updatesBtnsFn(this)" id="updatesDiv${updatesId}_btn" class="updatesAddBtn rounded-circle">+</button>
            </div>
          </div>`
          
          updaesContainer.innerHTML=updatesTag
          div.appendChild(dropImg)
          div.appendChild(updaesContainer)
          div.appendChild(clickTag)
          div.appendChild(deleteTag)

          if(updatesHeading !== ""){
            $('#createModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            updatesArray[`${updateDivId}`] = {heading:updatesHeading,show:accordionShow,bgColor:elemBgColor }
            tempArray[`${updateDivId}`] = { type: "12", heading:updatesHeading,show:accordionShow,bgColor:elemBgColor }
            updatesId+=1;
            contentCards.appendChild(div)

            const updatesElemClassSort=document.querySelectorAll('.updatesDivContainer')

              for (var i = 0; i < updatesElemClassSort?.length; i++) {
                let ParentId=updatesElemClassSort[i].id
                let idCount= ParentId.split("").pop()
                let dragAreaUpdates=document.getElementById(`updatesItems${idCount}`)  
                if(dragAreaUpdates){
                  new Sortable(dragAreaUpdates,{
                    filter:'.titleDiv',
                    handle:".dragImg",
                    Animation:350
                  })
                }
              }
            
          }

           updatesBtnsFn=(event)=>{
              let btnDiv=event.id.split("_")[0]
              $(`#${btnDiv} .updatesBtns`).toggleClass("active");
          }
          
        }
      }

      // Edit Funtion

      function editModal(element, id, parentId) {

        console.log(element,id,parentId,"edit")

        document.getElementById("editPageContent").innerHTML = ""

        let updatesClass = document.getElementById(`${parentId}`)?.parentNode.className
        let updatesDivId = document.getElementById(`${parentId}`)?.parentNode.id
        let updatesId=document.getElementById(`${parentId}`)?.parentNode.id.split("").pop()


        let parentContentCard = document.getElementById("contentCard")

        if (element === "editQuiz") {

          $('#editModal').modal('show');
          const quizObject = quizContainerArray[`${parentId}`]['quiz']
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Quiz"
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')

          var formDiv = document.createElement('form')
          formDiv.className = "formClassEdit"
          formDiv.id = parentId

          var options = ""

          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option0" placeholder="option 1" required name="option0" value=${quizObject['option0']} >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option1" placeholder="option 2" required name="option1" value=${quizObject['option1']} >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option2" placeholder="option 3" required name="option2" value=${quizObject['option2']} >
                </div>`
          options += `<div class="col-6 gy-3">
                  <input class="form-control"  id="option3" placeholder="option 4" required name="option3" value=${quizObject['option3']} >
                </div>`


          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" value=${quizObject['answer']} >
          </div>`

          var divOne = document.createElement("div")
          divOne.className = "quizEditDiv"
          divOne.id = id
          var divTwo = document.createElement("div")
          //divOne.className="row g-3"
          divTwo.className = "col-12"
          divTwo.style = "margin-bottom:10px"

          var textarea = document.createElement("input")
          textarea.className = "form-control"
          textarea.id = "question" + quizId
          textarea.name = "question"
          textarea.value = quizObject['question']
          textarea.placeholder = "Enter question"

          divTwo.appendChild(textarea)
          divOne.appendChild(divTwo)


          var div = document.createElement("div")
          div.className = "row"
          div.innerHTML = options
          div.innerHTML += answerDiv

          divOne.appendChild(div)

          formDiv.appendChild(divOne)

          modalBody.appendChild(formDiv)

        }
        else if (element === "editVideo") {
          $('#editModal').modal('show');
          var paramId = id
          let videosList = videoContainerArrary[`${parentId}`]
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Video"

          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "videoCard"
          //
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="top">
                  <p>Import videos</p>
                </div>
                <form action="" method="post" class="dragover">
                    <span class="inner"><span class="select">Browse</span></span>
                    <input name="file" type="file" class="file" id="videoInputEditId" accept="video/mp4"/>
                </form>
                <div class="videoModalContainerEdit" id=${paramId}>
                </div>`

          modalBody.appendChild(cardDiv)

          //
          const maxVideoSize = 10 * 1024 * 1024;
          //

          let button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.videoModalContainerEdit')
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          var inputFile = document.querySelector('form input');

          browse.addEventListener('click', () => inputFile.click());

          var videoFile = []

          if(updatesClass==="updatesItems"){
            videoFile = videoContainerArrary[`${parentId}`]['video'][0]
          }else{
            videoFile = videoContainerArrary[`${parentId}`]
          }

          let files = []

          var inputId = document.getElementById("videoInputEditId")
          inputId.onchange = e => {
            videoFile = e.target.files[0];

            if (videoFile.size < maxVideoSize) {

              if(updatesClass==="updatesItems"){
                videoContainerArrary[`${parentId}`] = {files:videoFile,updates:`updates${updatesId}`}
                tempArray[`${parentId}`] = { type: "5", video: videoFile ,updates:`updates${updatesId}`}
              }else{
                videoContainerArrary[`${parentId}`] = videoFile
                tempArray[`${parentId}`] = { type: "5", video: videoFile }
              }

             
              form.reset();
              container.innerHTML = ""
              showEditVideos()
            } else {
              container.innerHTML = `<p style="color:red">Maximum video size is 10MP </p>`
            }
            //
          }

          let showEditVideos = () => {
            let videoUrl=""
            if(typeof videoFile==="object"){
              videoUrl=URL.createObjectURL(videoFile)
            }else{
              videoUrl=videoFile
            }
           
            let videos = `<div class="video" id="videoEditId" draggable="true">
                      <video src=${videoUrl} alt="video">
                      <span onclick="delEditVideos()">&times;</span>
                  </div>`

            var imgDiv = document.createElement("div")
            imgDiv.innerHTML = videos

            container.appendChild(imgDiv)

          }

          delEditVideos = (index) => {
            files.splice(index, 1)
            showEditVideos()
          }

          showEditVideos()

        }
        else if (element === "editAnimation") {
          var paramId = id
          $('#editModal').modal('show');  
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Add Animations"
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')


          var animationList = animationContainerArray[`${parentId}`]

          var cardDiv = document.createElement("div")
          cardDiv.className = "animationCard"
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="top">
                    <p>Import animations</p>
                  </div>
                  <form action="" method="post" class="dragover">
                      <span class="inner"><span class="select">Browse</span></span>
                      <input name="file" type="file" class="file" id="animationInputId" multiple accept="image/gif"/>
                  </form>
                  <div class="animationEditContainer" id=${paramId}> 
                  </div>`

          modalBody.appendChild(cardDiv)


          var animationfiles = []

          if(updatesClass==="updatesItems"){
            animationfiles = animationContainerArray[`${parentId}`]['files']
          }else{
            animationfiles = animationContainerArray[`${parentId}`]
          }

          let files = [];
          let button = document.querySelector('.top button'),
            form = document.querySelector('form'),
            container = document.querySelector('.animationEditContainer')
          container.id = paramId
          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());


          var input = document.getElementById("animationInputId")

          input.addEventListener("change", () => {
            let file = input.files;
            for (let i = 0; i < file.length; i++) {
              if (animationfiles.every(e => e.name !== file[i].name)) animationfiles.push(file[i])
            }

            if(updatesClass==="updatesItems"){
              animationContainerArray[`${paramId}`] = {files:animationfiles,updates:`updates${updatesId}`}
              tempArray[`${parentId}`] = { type: "6", animations: files,updates:`updates${updatesId}` }
            }else{
              animationContainerArray[`${paramId}`] = animationfiles
              tempArray[`${parentId}`] = { type: "6", animations: files }
            }
            form.reset();
            showAnimations()
          })

          let showAnimations = () => {
            if(updatesClass==="updatesItems"){
              animationfiles = animationContainerArray[`${parentId}`]['files']
            }else{
              animationfiles = animationContainerArray[`${parentId}`]
            }
            
            let animations = '';
            animationfiles.forEach((e, i) => {
              animations += `<div class="animation box" draggable="true">
                        <img src=${URL.createObjectURL(e)} alt="animation">
                        <span onclick="delEditAnimations(${i})">&times;</span>
                    </div>`
            })
            container.innerHTML = animations

          }

          delEditAnimations = (index) => {
            animationfiles.splice(index, 1)
            showAnimations()
          }

          showAnimations()

        }
        else if (element === "editTitle") {
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Page Title"
          var modalBody = document.getElementById('editPageContent')

          let titleText = document.getElementById(id).innerText

          let bgColor = cardbgColor




          var pageTitle = ` <div class="col-md-12">
              <label for="pageTitle" class="form-label">Title</label>
              <input type="text" class="form-control inputField" id="pageTitleFieldEdit">
            </div>
            <div class="col-md-6">
              <label for="colorId" class="form-label">Color</label>
              <input type="text" class="form-control" id="colorEditId" value=${bgColor}>
            </div>
            <div class="col-6">
              <label for="colorPickerId" class="form-label">Choose Color</label>
              <input type="color" class="form-control form-control-color" id="colorPickerEditId" value=${bgColor}>
            </div>`


          var parentDiv = document.createElement("div")
          parentDiv.className = "row g-3 pageTitle"
          parentDiv.id = "pageTitleId"
          parentDiv.innerHTML = pageTitle

          let elemValue = document.getElementById(id)
          modalBody.appendChild(parentDiv)

          changeToRichtext([`pageTitleFieldEdit`])

          CKEDITOR.instances[`pageTitleFieldEdit`].setData(elemValue.innerHTML);

          var colorPickerField = document.getElementById("colorPickerEditId")
          let colorInputField = document.getElementById("colorEditId")

          colorPickerField.addEventListener("change", (event) => {
            colorInputField.value = colorPickerField.value
            cardbgColor = colorPickerField.value
          });
        }
        else if (element === "editButton") {
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Button"

          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')

          const { name, link, bgColor } = btnContainerArray[parentId]
          let btnName = document.getElementById(`${id}`).children[0].innerText
          let btnLink = document.getElementById(`${id}`).children[0].getAttribute("href")

          let rowDiv = document.createElement("div")
          rowDiv.className = "row g-3"

          let nameInput = document.createElement("input")
          nameInput.className = "form-control col-12"
          nameInput.id = "btnNameEdit"
          nameInput.value = btnName

          let linkInput = document.createElement("input")
          linkInput.className = "form-control col-12"
          linkInput.id = "btnLinkEdit"
          linkInput.value = btnLink

          let buttonLink = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="btnEditColor" value="${bgColor}">
          </div>`

          let btnDiv = document.createElement('div')
          btnDiv.innerHTML = buttonLink

          rowDiv.appendChild(nameInput)
          rowDiv.appendChild(linkInput)

          let buttonDiv = document.createElement("div")
          buttonDiv.id = "btnLink"
          buttonDiv.className = "row g-3"

          let mainDiv = document.createElement("div")
          mainDiv.className = "linkBtnDiv"
          mainDiv.id = parentId
          mainDiv.appendChild(rowDiv)
          mainDiv.appendChild(btnDiv)
          modalBody.appendChild(mainDiv)


        }
        else if (element === "editHeading") {
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Heading"

          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }

          var modalBody = document.getElementById('editPageContent')
          var div = document.createElement('div')
          div.className = "editHeading"
          div.id = parentId
          var input = document.createElement('input')

          // let parentElem= document.getElementById(id).parentElement

          let { bgColor, heading } = headingArray[`${parentId}`]

          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="headingColorPickerId" value="${bgColor}">
          </div>`

          let colorDiv = document.createElement("div")
          colorDiv.className = "row g-3 mt-2"
          colorDiv.innerHTML = colorPick
          //input.className = "form-control headingClass"
          input.id = "editInput"

          let elemValue = document.getElementById(id)
          div.appendChild(input)
          modalBody.appendChild(div)
          modalBody.appendChild(colorDiv)
          changeToRichtext([`editInput`])
          CKEDITOR.instances[`editInput`].setData(heading);

          let colorInput = document.getElementById(`headingColorPickerId`)
        }
        else if (element === "editImgLink") {

          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Link"

          
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }


          var modalBody = document.getElementById('editPageContent')


          const { link, image } = imgLinkContainerArray[`${parentId}`]

          let linkInput = `<input class="form-control mb-3" type="text" id="imgLinkEditField" placeholder="Image link" value=${link}>`

          let imgLinkContainer = `<div class="container col-md-12">
          <div class="mb-3">
                <input class="form-control" type="file" id="formFileEdit" accept="image/*">
            </div>
            <img id="linkFormEdit" src=${URL.createObjectURL(image)} class="img-fluid" /> </div>`


          let mainContainer = document.createElement("div")
          mainContainer.className = "linkImgModalDiv"
          mainContainer.id = `${parentId}`


          mainContainer.innerHTML = linkInput
          mainContainer.innerHTML += imgLinkContainer

          modalBody.appendChild(mainContainer)

          let imgInputIdEdit = document.getElementById("formFileEdit")
          let imgDivEdit = document.getElementById("linkFormEdit")

          let linkInputElemEdit = document.getElementById("imgLinkEditField")
          let files;

          imgInputIdEdit.addEventListener("change", () => {
            files = event.target.files[0];
            imgDivEdit.src = URL.createObjectURL(files);
            if(updatesClass==="updatesItems"){
              imgLinkContainerArray[`${parentId}`] = { link: linkInputElemEdit.value, image: files,updates:`updates${updatesId}` }
              tempArray[`${parentId}`] = { type: "9", link: linkInputElemEdit.value, image: files,updates:`updates${updatesId}` }
            }else{
              imgLinkContainerArray[`${parentId}`] = { link: linkInputElemEdit.value, image: files }
              tempArray[`${parentId}`] = { type: "9", link: linkInputElemEdit.value, image: files }
            }
            
          })

        }
        else if (element === "editDescription") {


          $('#editModal').modal('show');

          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Description"
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }
          var modalBody = document.getElementById('editPageContent')

          let mainContainer = document.createElement("div")
          mainContainer.id = parentId
          mainContainer.className = "DescClass"

          var input = document.createElement('textarea')
          input.id = "descEditId"

          let descDiv = document.createElement('div')
          descDiv.id = id
          let colorPick = `<div class="col-6">
            <label for="colorPickerId" class="form-label">Choose background Color</label>
            <input type="color" class="form-control form-control-color" id="descEditColorPicker" value="#fcfcfc">
          </div>`

          let colorDiv = document.createElement("div")
          colorDiv.className = "row g-3 mt-2"
          colorDiv.innerHTML = colorPick

          descDiv.appendChild(input)

          mainContainer.appendChild(descDiv)
          mainContainer.appendChild(colorDiv)

          modalBody.appendChild(mainContainer)

          const { text, bgColor } = descriptionArray[`${parentId}`]

          changeToRichtext([`descEditId`])

          CKEDITOR.instances[`descEditId`].setData(text);

          let colorInputElem = document.getElementById("descEditColorPicker")
          colorInputElem.value = bgColor

        }
        else if (element === 'editImages') {

          $('#editModal').modal('show');

          //

          var imagesList = imagesContainerArrar[`${parentId}`]

          var imgfiles;

          if(updatesClass==="updatesItems"){
            imgfiles=imagesList['images']
          }else{
            imgfiles=imagesList
          }   
          
          console.log(imagesList,"list")
          
          var paramId = id
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Images"
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesClass}_editModal`
          }else{
            modalTitle.className = ""
          }

         
          
          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "imgEditCard"
          //
          cardDiv.id = parentId
          cardDiv.innerHTML = `<div class="top">
                  </div>
                  <form action="" method="post" class="dragover">
                      <span class="inner"><span class="select">Browse</span></span>
                      <input name="file" type="file" class="file" id="imgInputEdit" multiple accept="image/*"/>
                  </form>
                  <div class="imgContainerEdit">
                  </div>`

          modalBody.appendChild(cardDiv)

         var container = document.querySelector('.imgContainerEdit')
          container.id = paramId

          showEditImages = () => {
            let images = '';
            imgfiles.forEach((e, i) => {
              let imgUrl=""
              if(typeof e ==="object"){
                imgUrl=URL.createObjectURL(e)
              }else{
                imgUrl=e
              }

              images += `<div class="image box" draggable="true"">
                        <img src=${imgUrl} alt="img" >
                       <span onclick="delEditImages(${i})"> &times;</span>
                    </div>`
            })


            container.innerHTML = images
          }

          delEditImages = (index) => {
            imgfiles.splice(index, 1)
            showEditImages()
          }

          showEditImages()

          var button = document.querySelector('.top button'),
            form = document.querySelector('form'),

          text = document.querySelector('.inner')
          browse = document.querySelector('.select')
          input = document.querySelector('form input');

          browse.addEventListener('click', () => input.click());

          

          let files = []
          var inputId = document.getElementById("imgInputEdit")

          inputId.onchange = e => {
            let file = inputId.files;
            for (let i = 0; i < file.length; i++) {
              if (imgfiles.every(e => e.name !== file[i].name)) {
                imgfiles.push(file[i])
              }

            }

            //

            if(updatesClass == "updatesItems"){
              imagesContainerArrar[`${parentId}`] = {images:imgfiles,updates:`updates${updatesId}`}
              tempArray[`${parentId}`] = { type: "4", images: imgfiles,updates:`updates${updatesId}` }
            }else{
              imagesContainerArrar[`${parentId}`] = imgfiles
              tempArray[`${parentId}`] = { type: "4", images: imgfiles }
            }
            form.reset();
            showEditImages()

          }


          imageId += 1

          showEditImages()

        }
        else if(element==="editHyperLink"){
          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit HyperLink"
          if(updatesClass==="updatesItems"){
            modalTitle.className = `${updatesDivId}_editModal`
          }else{
            modalTitle.className = ""
          }
          var modalBody = document.getElementById('editPageContent')
          var cardDiv = document.createElement("div")
          cardDiv.className = "hyperLinkEdit"
          cardDiv.id = `${parentId}_editModal`

          let {hyperLinkCards}=hyperLinkArray[`${parentId}`]

          let imgUrl=""


          if(typeof hyperLinkCards[0].image[0]==="object"){
            imgUrl=URL.createObjectURL(hyperLinkCards[0].image[0])
          }else{
            imgUrl=hyperLinkCards[0].image[0]
          }

          let editFormContent=


          `<form class="editForm" id="hyperLinkEdit_form0">
            <div class="d-flex gap-2 mb-2">
              <div class="formDiv">
                <input class="inputItem form-control" type="text" name="link" value="${hyperLinkCards[0].link}" />

                <div class="hyperLinkModalDivs">
                  <div>
                    <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgEditInput0_id" onchange="imgEditOnchangeFn(event)">
                  </div>
                  <div class="hyperImgEditContainer" id="hyperImgEditInput0">
                    <img src=${imgUrl} alt="img" />
                  </div>
                </div>
                <input class="inputItem form-control" type="text" id="captionInputEdit0" name="caption" />
              </div>
              <div class="addMore">
                <button type="button" class="btn btn-primary" name="add" id="add" onClick="addEditInputs()">+</button>
              </div> 
            </div>
          </form>`
          

          cardDiv.innerHTML=editFormContent

          let editRestContent=""

          if(hyperLinkCards.length>1){
              for(let j=1;j<hyperLinkCards.length;j++){
                  let hyperImgUrl=""

                  if(typeof hyperLinkCards[j].image[0]==="object"){
                    hyperImgUrl=URL.createObjectURL(hyperLinkCards[j].image[0])
                  }else{
                    hyperImgUrl=hyperLinkCards[j].image[0]
                  }
                  editRestContent+= `<form class="editForm" id="hyperLinkEdit_form${j}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${j}">
                  <div class="formDiv">
                    <input class="inputItem form-control" type="text" name="link" value="${hyperLinkCards[j].link}" />
                    <div class="hyperLinkModalDivs">
                      <div>
                        <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgEditInput${j}_id" onchange="imgEditOnchangeFn(event)">
                      </div>
                      <div class="hyperImgEditContainer" id="hyperImgEditInput${j}">
                        <img src=${hyperImgUrl} alt="img" />
                      </div>
                    </div>

                    <input class="inputItem form-control" type="text" name="caption" id="captionInputEdit${j}" value="${hyperLinkCards[j].caption}" />
                  </div>
                  <div>
                    <button type="button" class="btn btn-danger" name="remove" id="${j}" onClick="removeEditInputs(this,${j})">X</button>
                  </div> 
                </div></form>`
              }
          }

          cardDiv.innerHTML+=editRestContent

          modalBody.appendChild(cardDiv)

            changeToRichtext([`captionInputEdit0`])

          for(let k=1;k<hyperLinkCards.length;k++){
            changeToRichtext([`captionInputEdit${k}`])
            CKEDITOR.instances[`captionInputEdit${k}`].setData(hyperLinkCards[k].caption);
          }
          CKEDITOR.instances[`captionInputEdit0`].setData(hyperLinkCards[0].caption);

          var l = hyperLinkCards.length-1;
          var length;

          addEditInputs=()=>{
            
            l++;  
            let  addContent= `<form class="editForm" id="hyperLinkEdit_form${l}"> <div class="d-flex gap-2 mb-2" id="fieldDiv${l}">
                <div class="formDiv">
                  <input class="inputItem form-control" type="text" name="link" />
                  <div class="hyperLinkModalDivs">
                    <div>
                      <input class="inputItem form-control hyperImgClass" type="file" name="file" accept="image/*"/ id="hyperImgEditInput${l}_id" onchange="imgEditOnchangeFn(event)">
                    </div>
                    <div class="hyperImgEditContainer" id="hyperImgEditInput${l}">
                      
                    </div>
                  </div>
                  <input class="inputItem form-control" type="text" name="caption" id="captionInputEdit${l}" />
                </div>
                <div>
                  <button type="button" class="btn btn-danger" name="remove" id="${l}" onClick="removeEditInputs(this,${l})">X</button>
                </div> 
              </div> <p class="error" style="display:none">Please fill the value..!</p> </form>`

              $(".hyperLinkEdit").append(addContent)

             changeToRichtext([`captionInputEdit${l}`])

          }

          removeEditInputs=(e,index)=>{
            hyperLinkArray[`${parentId}`]['hyperLinkCards'].splice(index,1)
            var button_id = e.id     
           $('#hyperLinkEdit_form'+button_id).remove();
          }

          imgEditOnchangeFn=(event)=>{
            let linkid=event.target.id
            let linkDivId=linkid.split("_")[0]
            let imgDiv=document.getElementById(linkDivId)
            let count=linkDivId.split("").pop()

            if(hyperLinkArray[`${parentId}`]['hyperLinkCards'][`${count}`] !==undefined){
              hyperLinkArray[`${parentId}`]['hyperLinkCards'][`${count}`].image=[event.target.files[0]]
            }

            let images = `<img src=${URL.createObjectURL(event.target.files[0])} alt="img" />`
            imgDiv.innerHTML = images
          }

        }
        else if(element === "editUpdates"){

          let updatesDivID=parentId.split("").pop()

          $('#editModal').modal('show');
          var modalTitle = document.getElementById("EditPageTitle")
          modalTitle.innerText = "Edit Updates"

          var modalBody = document.getElementById('editPageContent')

          const {heading,bgColor,show}=updatesArray[`${parentId}`]

          let updatesElem= `
            <input type="text" class="form-control" placeholder="Enter title" id="updatesHeadingEdit" value="${heading}" />
            <div class="bgDiv">
              <input type="color" id="bgColorEdit" class="updatesBgColor form-control form-control-color" value="${bgColor}" />
              <label for="bgColor" class="form-check-label">Background Color</label>
            </div>
            
            <div class="mb-3 form-check">
              <label for="show" class="form-check-label">Show</label>
              <input type="checkbox" class="form-check-input" id="showEdit" name="show" value="show" />
            </div>
          `
          let mainContainer = document.createElement("div")
          mainContainer.className ='updatesDiv'
          mainContainer.id=`updatesDivContainer${updatesDivID}_modal`
          mainContainer.innerHTML=updatesElem

          modalBody.append(mainContainer)

          changeToRichtext([`updatesHeadingEdit`])
          CKEDITOR.instances[`updatesHeadingEdit`].setData(heading);

          document.getElementById("showEdit").checked = show;

        }
        const errors = document.querySelectorAll('.error');

        errors.forEach(error => {
          error.remove();
        });
      }

      // Update Function
      function updateElement() {
        var modalBody = document.getElementById('editPageContent')
        let updatesClassName=document.getElementById("EditPageTitle").className.split("_")[0]
        let updatesClass=updatesClassName.slice(0, -1);
        let updatesId=updatesClassName.split("").pop()

        if (modalBody.children[0].className === "formClassEdit") {
          var formDivClass = document.getElementsByClassName("formClassEdit")[0]
          var quizArraykey = modalBody.children[0].id

          let updateId = document.querySelector(".quizEditDiv").id

          var updatedElement = document.getElementById(updateId)
          var formElem = document.getElementById("formId");
          const data = Object.fromEntries(new FormData(formDivClass).entries());

          let quizObject;
          let quiz=data
          if(updatesClass==="updatesItems"){
            quizContainerArray[`${quizArraykey}`] = {quiz,updates:`updates${updatesId}`}
            quizObject=quizContainerArray[`${quizArraykey}`]['quiz']
            tempArray[`${quizArraykey}`] = { type: "7", quiz: quizObject,updates:`updates${updatesId}` }

          }else{
            quizContainerArray[`${quizArraykey}`] = data

            quizObject = quizContainerArray[`${quizArraykey}`]

            tempArray[`${quizArraykey}`] = { type: "7", quiz: quizObject }
          }

          const { question, answer, ...rest } = quizObject

          var options = ""

          let value = [];
          for (var property in rest) {
            if (rest[property] !== "") {
              options += `<label class="options">${rest[property]}
                <input type="radio" name="radio" value=${rest[property]}/>
                <span class="checkmark"></span>
            </label>`

              value.push(rest[property])
            }
          }

          var answerDiv = `<div class="col-12 gy-3">
            <input class="form-control"  id="answer" placeholder="Enter answer" required name="answer" value=${quizObject['answer']} />
          </div>`


          const quizHtml = `<div class="container my-1">
                <div class="question ml-sm-5 pl-sm-5 pt-2 text-start">
                    <div class="py-2 h5"><b>Q. ${question}</b></div>
                    <div class="ml-md-3 ml-sm-3 pl-md-5 pt-sm-0 pt-3" id="options">
                       ${options}
                    </div>
                </div>
            </div>`

          //

          if (answer !== "" && value.length >= 2 && question !== "") {
            $('#editModal').modal('hide');
            updatedElement.innerHTML = quizHtml
          } else {
            let qstnElem = document.querySelector(`.formClassEdit #question${quizId}`)
            let optionOneElem = document.querySelector(`.formClassEdit #option0`)
            let optionTwoElem = document.querySelector(`.formClassEdit #option3`)
            let answerElem = document.querySelector(`.formClassEdit #answer`)

            let errorQstn = document.querySelector(".qstnerror")
            let errorOptn = document.querySelector(".optnerror")
            let errorAns = document.querySelector(".anserror")

            if (qstnElem.value === "") {
              if (!errorQstn) {
                qstnElem.insertAdjacentHTML('afterend', '<p class="error qstnerror">Please enter the question...!</p>');
              }

            } else {
              if (errorQstn) {
                errorQstn.remove()
              }
            }
            if (value.length < 2) {
              if (!errorOptn) {
                optionTwoElem.parentElement.insertAdjacentHTML('afterend', '<p class="error optnerror">Please enter atleast two options...!</p>');
              }

            } else {
              if (errorOptn) {
                errorOptn.remove()
              }
            }
            if (answerElem.value === "") {
              if (!errorAns) {
                answerElem.insertAdjacentHTML('afterend', '<p class="error anserror">Please enter the answer...!</p>');
              }
            } else {
              if (errorAns) {
                errorAns.remove()
              }
            }
          }

        }
        else if (modalBody.children[0].className === "videoCard") {

          
          //
          var updatedElement = modalBody.children[0].id
          var editedElement = document.querySelector(".videoModalContainerEdit")

          var videoSrc

          if(updatesClass ==="updatesItems"){
            videoSrc = videoContainerArrary[updatedElement]['files']
          }else{
            videoSrc = videoContainerArrary[updatedElement]
          }
          document.getElementById(editedElement.id).innerHTML = `<video src=${URL.createObjectURL(videoSrc)} alt="" controls>`
            $('#editModal').modal('hide');
        }
        else if (modalBody.children[0].className === "animationCard") {

          let parentDivId = modalBody.children[0].id
          var updatedAnimation = document.querySelector(".animationEditContainer").id
          var animationSrc = animationContainerArray[updatedAnimation.id]

          let animationsImg;
          if(updatesClass ==="updatesItems"){
            animationsImg = animationContainerArray[`${parentDivId}`]['files']
          }else{
            animationsImg = animationContainerArray[`${parentDivId}`]
          }

          let animations = ''

          for (let animation of animationsImg) {
            animations += `<img src=${URL.createObjectURL(animation)} alt="img">`
          }

          if (animationsImg.length > 0) {
            $('#editModal').modal('hide');
            document.getElementById(updatedAnimation).innerHTML = animations
          } else {
            let animationElem = document.querySelector(".animationEditContainer")
            let errorElem = document.querySelector(".error")
            if (animationsImg.length === 0) {
              animationElem.insertAdjacentHTML('afterend', '<p class="error">Please insert animation...!</p>');
            }
          }

        }
        else if (modalBody.children[0].id === "pageTitleId") {
          let parentContentCard = document.querySelector("#contentCard")
          var ckTextValue = CKEDITOR.instances['pageTitleFieldEdit']?.getData()
          let updatedElement = document.getElementById("pageHeadingId")
          let inputValue = document.querySelector(".inputField").value

          if (ckTextValue !== "") {
            //
            $('#editModal').modal('hide');
            pageBgColor=cardbgColor
            parentContentCard.style.backgroundColor = `${cardbgColor}`
            updatedElement.innerHTML = ckTextValue
            titleArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }
            tempArray["title"] = { "type": "1", title: ckTextValue, bgColor: cardbgColor }

          } else {
            let inputElem = document.getElementById("cke_pageTitleFieldEdit")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

        }
        else if (modalBody.children[0].className === "linkBtnDiv") {

          let elemId = modalBody.children[0].id
          let btnName = document.getElementById("btnNameEdit").value
          let btnLink = document.getElementById("btnLinkEdit").value
          let btnColor = document.getElementById("btnEditColor")

          let updatedElement = document.getElementById(elemId).children[1]

          //
          let btnTag = `<a href="${btnLink}" target="_blank" class="linkBtn">${btnName}</a>`

          var color = $("#btnEditColor").val();

          if (btnName !== "" && btnLink !== "") {
            //
            $('#editModal').modal('hide');
            updatedElement.innerHTML = btnTag
            updatedElement.children[0].style.backgroundColor = color
            if(updatesClass==="updatesItems"){
              btnContainerArray[`${elemId}`] = { name: btnName, link: btnLink, bgColor: btnColor.value,updates:`updates${updatesId}` }
              tempArray[`${elemId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor.value,updates:`updates${updatesId}` }
            }else{
              btnContainerArray[`${elemId}`] = { name: btnName, link: btnLink, bgColor: btnColor.value }
              tempArray[`${elemId}`] = { type: "8", name: btnName, link: btnLink, bgColor: btnColor.value }
            }
          } else {

            let inputName = document.querySelector("#btnNameEdit")
            let inputLink = document.querySelector("#btnLinkEdit")
            let errorName = document.querySelector(".btnError")
            let errorLink = document.querySelector(".linkError")

            if (inputName.value === "") {
              if (!errorName) {
                inputName.insertAdjacentHTML('afterend', '<p class="error btnError">Please enter the button name...!</p>');
              }

            } else {
              if (errorName) {
                errorName.remove()
              }
            }
            if (inputLink.value === "") {
              if (!errorLink) {
                inputLink.insertAdjacentHTML('afterend', '<p class="error linkError">Please enter the link...!</p>');
              }

            } else {
              if (errorLink) {
                errorLink.remove()
              }
            }
          }


        }
        else if (modalBody.children[0].className === "editHeading") {

          let id = modalBody.children[0].id
          let updatedElement = document.getElementById(id).children[1]
          let editValue = CKEDITOR.instances['editInput']?.getData()

          let colorInput = document.getElementById("headingColorPickerId").value
          if (CKEDITOR.instances['editInput']?.getData() !== "") {

            //
            $('#editModal').modal('hide');
            document.getElementById("emptyPage")?.remove()
            updatedElement.innerHTML = editValue

            if(updatesClass==="updatesItems"){
              headingArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput,updates:`updates${updatesId}` }
              tempArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput,updates:`updates${updatesId}` }
            }else{
              headingArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput }
              tempArray[`${id}`] = { "type": "2", heading: editValue, bgColor: colorInput }
            }

          } else {
            let inputElem = document.getElementById(`cke_editInput`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }

          updatedElement.parentElement.style.backgroundColor = colorInput



        }
        else if (modalBody.children[0].className === "DescClass") {
          var ckTextValue = CKEDITOR.instances['descEditId']?.getData()
          let bgColor = document.getElementById("descEditColorPicker").value
          let elemId = modalBody.children[0].id
          let parentElem = document.getElementById(elemId)
          let updatedElement = parentElem.children[1]


          if (ckTextValue !== "") {
            //
            $('#editModal').modal('hide');
            updatedElement.innerHTML = ckTextValue
            parentElem.style.backgroundColor = bgColor
            if(updatesClass ==="updatesItems"){
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: bgColor,updates:`updates${updatesId}` }
            tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: bgColor,updates:`updates${updatesId}` }
            }else{
              descriptionArray[`${elemId}`] = { text: ckTextValue, bgColor: bgColor }
            tempArray[`${elemId}`] = { type: "3", text: ckTextValue, bgColor: bgColor }
            }
            
          } else {
            let inputElem = document.getElementById(`cke_descEditId`)
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }
        }
        else if (modalBody.children[0].className === "linkImgModalDiv") {
          let imgId = modalBody.children[0].id
          let updatedElement = document.getElementById(imgId).children[1]
          const { link, image } = imgLinkContainerArray[imgId]

    

          let imgLinkDiv = `<a href="${link}" target="_blank"><img src="${URL.createObjectURL(image)}" alt=""/></a>`
          let linkInputElemEdit = document.getElementById("imgLinkEditField")

          if (linkInputElemEdit.value !== "") {
            //
            $('#editModal').modal('hide');
            updatedElement.innerHTML = imgLinkDiv
            if(updatesClass ==="updatesItems"){
              imgLinkContainerArray[`${imgId}`] = { link: linkInputElemEdit.value, image: image,updates:`updates${updatesId}` }
              tempArray[`${imageId}`] = { type: "9", link: linkInputElemEdit.value, image: image,updates:`updates${updatesId}`  }
            }else{
              imgLinkContainerArray[`${imgId}`] = { link: linkInputElemEdit.value, image: image }
              tempArray[`${imageId}`] = { type: "9", link: linkInputElemEdit.value, image: image }
            }
            
          } else {
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              linkInputElemEdit.insertAdjacentHTML('afterend', '<p class="error">Please enter the field...!</p>');
            }
          }


        }
        else if (modalBody.children[0].className === "imgEditCard") {

          //

          let parentDivId = modalBody.children[0].id

          let updatesClass=document.getElementById("EditPageTitle").className.split("_")[0]


          let keyId = document.getElementsByClassName("imgContainerEdit")[0].id

          let images

          

          if(updatesClass ==="updatesItems"){
            images = imagesContainerArrar[`${parentDivId}`]['images']
          }else{
            images = imagesContainerArrar[`${parentDivId}`]
          }

          let updatedElement = document.getElementById(keyId)


          let editedImages = '';

          let url="";
          images.forEach((e, i) => {
            
            if(typeof e === "string"){
              url=e
            }else{
              url=URL.createObjectURL(e)
            }
            editedImages += `<img src=${url} alt="img">`
          })


          //
          if (images.length > 0) {
            $('#editModal').modal('hide');
            updatedElement.innerHTML = editedImages
          } else {
            let inputElem = document.querySelector(".imgContainerEdit")
            let errorElem = document.querySelector(".error")
            if (!errorElem) {
              inputElem.insertAdjacentHTML('afterend', '<p class="error">Please insert image...!</p>');
            }
          }
        }
        else if(modalBody.children[0].className === "hyperLinkEdit"){
          let hyperLinksUpdate =[]; 
          
          let parentId=modalBody.children[0].id.split("_")[0]
          
          let {hyperLinkCards}=hyperLinkArray[`${parentId}`]

          let editForms=document.getElementsByClassName("editForm")

          for (let h=0;h<editForms.length;h++){
            let form = editForms[h];
            let data = new FormData(form);
            data = data.entries();              
            var obj = data.next();
            var retrieved = {}; 

            
            while(undefined !== obj.value) {  
              retrieved[obj.value[0]] = obj.value[1];

              if(obj.value[0]=="file"){
                if(hyperLinkCards[h]){
                  retrieved["image"]=[hyperLinkCards[h].image[0]]
                  retrieved["file"]=[hyperLinkCards[h].image[0]]
                }else{
                  retrieved["image"]=[obj.value[1]]
                  retrieved["file"]=[obj.value[1]]
                }
              }
              obj = data.next();   
              retrieved["caption"]=CKEDITOR.instances[`captionInputEdit${h}`]?.getData();
            }

            let inputFields = $(`#hyperLinkEdit_form${h} input`);

            let isEmpty=false;

            for(let i = 0; i < inputFields.length; i++){
              let inputType = inputFields[i].type
              let inputName = inputFields[i].name
              if(inputName === "link" && inputFields[i].value===""){
                isEmpty=true
              }
              else if(CKEDITOR.instances[`captionInputEdit${h}`]?.getData()===""){
                isEmpty=true
              }
            }

            if(isEmpty===true){
              if($(`.formError${h}`).length==0){
                $(`#hyperLinkEdit_form${h}`).after(`<span class="formError${h} error">Please enter the field..!</span>`)
              }   
            }else{
              $(`.formError${h}`).remove()
              hyperLinksUpdate.push(retrieved)
            }
          }

          let parentElem = document.getElementById(parentId)
          let updatedElement = parentElem.children[1]


          let hyperLinkTag="";
          hyperLinksUpdate.forEach((e,i)=>{
            let hyperUrl=""
            if(typeof e.file[0] ==="object"){
              hyperUrl=URL.createObjectURL(e.file[0])
            }else{
              hyperUrl=e.file[0]
            }
            hyperLinkTag+=
            `<div class="hyperLink">
              <div class="linkDiv">
                  <a href="${e.link}" target="_blank">
                      <img src="${hyperUrl}" alt="">
                  </a>
              </div>
              <div class="captionDiv">
                  ${e.caption}
              </div>
          </div>`
          })
          

          if(hyperLinksUpdate.length>0){
            if(updatesClass ==="updatesItems"){
              hyperLinkArray[`${parentId}`] = {hyperLinkCards:hyperLinksUpdate,updates:`updates${updatesId}` };
              tempArray[`${parentId}`] = { type: "11", hyperLinkCards:hyperLinksUpdate,updates:`updates${updatesId}` };
            }else{
              hyperLinkArray[`${parentId}`] = {hyperLinkCards:hyperLinksUpdate };
              tempArray[`${parentId}`] = { type: "11", hyperLinkCards:hyperLinksUpdate };
            }
            $('#editModal').modal('hide');
            updatedElement.innerHTML=hyperLinkTag;
          }

        }
        else if(modalBody.children[0].className ==="updatesDiv"){
          let elemId = modalBody.children[0].id.split("_")[0]
          let elemCount=elemId.split("").pop()
          let updatedElemId=`updatesHeadingDiv${elemCount}`

          let updatedElem=document.getElementById(`${updatedElemId}`)

          let heading = CKEDITOR.instances['updatesHeadingEdit']?.getData()
          let bgColor = document.getElementById("bgColorEdit").value
          let accordionInput = $('#showEdit:checked').val();

          let showAccordion= accordionInput===undefined?false:true

          if (heading !== "") {
            $('#editModal').modal('hide');
            updatedElem.innerHTML=heading
            updatedElem.style.backgroundColor=bgColor
            updatesArray[`${elemId}`] = {heading:heading,show:showAccordion,bgColor:bgColor }
            tempArray[`${elemId}`] = { type: "12", heading:heading,show:showAccordion,bgColor:bgColor }
          }

        }
      }

      function submitModal(){


        let updatesElemClass=document.querySelectorAll('.updatesDivContainer')
        let gotoBtnDiv = document.getElementById("updateColorDiv")
        let update_name_elem = document.getElementById("updateNameDiv")
        let goto_select_div = document.getElementById("goToSelectDiv")

        let selectOption = document.getElementById('goToSelect')
        let gotoColor = document.getElementById("updateBgColor")

        if(updatesElemClass.length>0){
          gotoBtnDiv.style.display="flex"
          update_name_elem.style.display="flex"
          goto_select_div.style.display="flex"
        }else{
          gotoBtnDiv.style.display="none"
          update_name_elem.style.display="none"
          goto_select_div.style.display="none"
        }
 
        const {gotoselect,gotoselectbg,gotoselectname}=gotoData;
       
        if(updatesElemClass.length===0){
          goto_select_div.style.display="none"
        }else{
          goto_select_div.style.display="flex"
        } 

        selectOption.innerHTML="";

        var nullOpt = document.createElement('option');
        nullOpt.value = null;
        nullOpt.innerHTML = "Choose Update...";
        selectOption.appendChild(nullOpt);
        for (let i=0;i<updatesElemClass.length; i++){
          let updatesElementsId=updatesElemClass[i].id
          let updatesElement=tempArray[`${updatesElementsId}`]['heading']

          var opt = document.createElement('option');
          opt.value = i;
          opt.innerHTML = updatesElement;
          selectOption.appendChild(opt);
        }

        CKEDITOR.instances[`updateName`].setData(gotoselectname);
        selectOption.value=gotoselect;
        gotoColor.value=gotoselectbg


        $('#submitModal').modal('show');
      }

      function goToFn(){
       let selectedValue=document.getElementById("goToSelect").value
       let update_name_elem = document.getElementById("updateNameDiv")
       let update_color_elem = document.getElementById("updateColorDiv")

       if(selectedValue === "null"){
        update_name_elem.style.display="none"
        update_color_elem.style.display="none"
       }else{
        update_name_elem.style.display="flex"
        update_color_elem.style.display="flex"
       }
      }



     $(function () {
         $("#sidebar").load("../../component/sidebar.html");
         $("#topbar-div").load("../../component/topbar.html");
       });


       // Menu Toggle

      let navigations = document.querySelector('.navigation');
      let toggles = document.querySelector('.toggle');
      let main = document.querySelector('.main');

      toggles.onclick = function () {
        navigations.classList.toggle('active');
        main.classList.toggle('active');
      }
      // add hovered classn selected list item

      let list = document.querySelectorAll('.navigation li');

      function activeLink() {
        list.forEach((item) =>
          item.classList.remove('hovered'));
        this.classList.add('hovered');
      }
      function activeMenu() {
        list.forEach((item) =>
          item.classList.remove('active'));
        this.classList.add('active');
      }
      list.forEach((item) =>
        item.addEventListener('mouseover', activeLink))

      list.forEach((item) =>
        item.addEventListener('click', activeMenu))



      let urlInputValue=$("#urlInput").val()


      function submitFn() {

         data = [];

        let mainDiv = document.getElementById("contentCard")

        let childElem = mainDiv.childNodes

        let keysArray = []

        for (let i = 0; i < childElem.length; i++) {
          keysArray.push(childElem[i].id)
        }

        let updatesValue=[]

        let updatesKey=[]

        const updatesElemClass=document.querySelectorAll('.updatesDivContainer')

        for(let i=0;i<updatesElemClass.length;i++){
          let ParentId=updatesElemClass[i].id
          let idCount= ParentId.split("").pop()
          let childElem=document.getElementById(`updatesItems${idCount}`).childNodes
          childElem.forEach((e,i)=>{
            updatesKey.push(e.id)
         })
        }


         updatesKey.forEach((e)=>{
          updatesValue.push(tempArray[e])
         })

        let updatesElemObj = Object.groupBy(updatesValue, ({ updates }) => updates);

        keysArray.forEach((e) => {
          if(e.includes('updates')){
            let objId=`updates${e.split("").pop()}`
            let updates=updatesElemObj[`${objId}`]
           let element=tempArray[e]
           element={...element,updates}
            data.push(element)
          }else{
            data.push(tempArray[e])
          }
        })

        var action = $('#acionId input:radio:checked').val();
        let urlInput = $("#urlInput").val()
        var selectCatText=  $('#inputState option').filter(':selected').text();
        var selectCatValue=  $('#inputState').val()
        var goToSelect =  $('#goToSelect').val()
        var updateName = CKEDITOR.instances['updateName'].getData()
        var updateBtnColor=$('#updateBgColor').val()

        let updatesElemCheck=null;

        if(updatesElemClass.length !==0){
          if(goToSelect !=="null" && updateName !==""){
            updatesElemCheck=true
          }else{
            updatesElemCheck=false
          }
        }else{
          updatesElemCheck=null;
        }


        if (urlInput !== "" && selectCatValue !== "null") {
          $('#submitModal').modal('hide');
          return false;
        }

      }






    </script>

    </body>

  </html>